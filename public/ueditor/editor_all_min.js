UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};var baidu=window.baidu||{};window.baidu=baidu;window.UE=baidu.editor={};UE.plugins={};UE.commands={};UE.instants={};UE.I18N={};UE.version="1.2.5.0";var dom=UE.dom={};var browser=UE.browser=function(){var d=navigator.userAgent.toLowerCase(),b=window.opera,c={ie:!!window.ActiveXObject,opera:(!!b&&b.version),webkit:(d.indexOf(" applewebkit/")>-1),mac:(d.indexOf("macintosh")>-1),quirks:(document.compatMode=="BackCompat")};c.gecko=(navigator.product=="Gecko"&&!c.webkit&&!c.opera);var a=0;if(c.ie){a=parseFloat(d.match(/msie (\d+)/)[1]);c.ie9Compat=document.documentMode==9;c.ie8=!!document.documentMode;c.ie8Compat=document.documentMode==8;c.ie7Compat=((a==7&&!document.documentMode)||document.documentMode==7);c.ie6Compat=(a<7||c.quirks)}if(c.gecko){var e=d.match(/rv:([\d\.]+)/);if(e){e=e[1].split(".");a=e[0]*10000+(e[1]||0)*100+(e[2]||0)*1}}if(/chrome\/(\d+\.\d)/i.test(d)){c.chrome=+RegExp["\x241"]}if(/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(d)&&!/chrome/i.test(d)){c.safari=+(RegExp["\x241"]||RegExp["\x242"])}if(c.opera){a=parseFloat(b.version())}if(c.webkit){a=parseFloat(d.match(/ applewebkit\/(\d+)/)[1])}c.version=a;c.isCompatible=!c.mobile&&((c.ie&&a>=6)||(c.gecko&&a>=10801)||(c.opera&&a>=9.5)||(c.air&&a>=1)||(c.webkit&&a>=522)||false);return c}();var ie=browser.ie,webkit=browser.webkit,gecko=browser.gecko,opera=browser.opera;var utils=UE.utils={each:function(f,e,d){if(f==null){return}if(f.length===+f.length){for(var c=0,a=f.length;c<a;c++){if(e.call(d,f[c],c,f)===false){return false}}}else{for(var b in f){if(f.hasOwnProperty(b)){if(e.call(d,f[b],b,f)===false){return false}}}}},makeInstance:function(b){var a=new Function();a.prototype=b;b=new a;a.prototype=null;return b},extend:function(d,e,a){if(e){for(var c in e){if(!a||!d.hasOwnProperty(c)){d[c]=e[c]}}}return d},inherits:function(d,b){var a=d.prototype,c=utils.makeInstance(b.prototype);utils.extend(c,a,true);d.prototype=c;return(c.constructor=d)},bind:function(b,a){return function(){return b.apply(a,arguments)}},defer:function(b,a,c){var d;return function(){if(c){clearTimeout(d)}d=setTimeout(b,a)}},indexOf:function(d,b,c){var a=-1;c=this.isNumber(c)?c:0;this.each(d,function(e,f){if(f>=c&&e===b){a=f;return false}});return a},removeItem:function(d,c){for(var b=0,a=d.length;b<a;b++){if(d[b]===c){d.splice(b,1);b--}}},trim:function(a){return a.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(c){if(!c){return{}}c=utils.isArray(c)?c:c.split(",");for(var b=0,a,d={};a=c[b++];){d[a.toUpperCase()]=d[a]=1}return d},unhtml:function(b,a){return b?b.replace(a||/[&<">]/g,function(c){return{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;"}[c]}):""},html:function(a){return a?a.replace(/&((g|l|quo)t|amp);/g,function(b){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">"}[b]}):""},cssStyleToDomStyle:function(){var b=document.createElement("div").style,a={"float":b.cssFloat!=undefined?"cssFloat":b.styleFloat!=undefined?"styleFloat":"float"};return function(c){return a[c]||(a[c]=c.toLowerCase().replace(/-./g,function(d){return d.charAt(1).toUpperCase()}))}}(),loadFile:function(){var a=[];function b(h,g){try{for(var d=0,c;c=a[d++];){if(c.doc===h&&c.url==(g.src||g.href)){return c}}}catch(f){return null}}return function(i,h,e){var f=b(i,h);if(f){if(f.ready){e&&e()}else{f.funs.push(e)}return}a.push({doc:i,url:h.src||h.href,funs:[e]});if(!i.body){var d=[];for(var g in h){if(g=="tag"){continue}d.push(g+'="'+h[g]+'"')}i.write("<"+h.tag+" "+d.join(" ")+" ></"+h.tag+">");return}if(h.id&&i.getElementById(h.id)){return}var c=i.createElement(h.tag);delete h.tag;for(var g in h){c.setAttribute(g,h[g])}c.onload=c.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){f=b(i,h);if(f.funs.length>0){f.ready=1;for(var j;j=f.funs.pop();){j()}}c.onload=c.onreadystatechange=null}};c.onerror=function(){throw Error("The load "+(h.href||h.src)+" fails,check the url settings of file editor_config.js ")};i.getElementsByTagName("head")[0].appendChild(c)}}(),isEmptyObject:function(b){if(b==null){return true}if(this.isArray(b)||this.isString(b)){return b.length===0}for(var a in b){if(b.hasOwnProperty(a)){return false}}return true},fixColor:function(b,d){if(/color/i.test(b)&&/rgba?/.test(d)){var e=d.split(",");if(e.length>3){return""}d="#";for(var c=0,a;a=e[c++];){a=parseInt(a.replace(/[^\d]/gi,""),10).toString(16);d+=a.length==1?"0"+a:a}d=d.toUpperCase()}return d},optCss:function(e){var d,c,a;e=e.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(i,g,f,h){if(h.split(" ").length==1){switch(g){case"padding":!d&&(d={});d[f]=h;return"";case"margin":!c&&(c={});c[f]=h;return"";case"border":return h=="initial"?"":i}}return i});function b(m,h){if(!m){return""}var i=m.top,f=m.bottom,g=m.left,j=m.right,n="";if(!i||!g||!f||!j){for(var k in m){n+=";"+h+"-"+k+":"+m[k]+";"}}else{n+=";"+h+":"+(i==f&&f==g&&g==j?i:i==f&&g==j?(i+" "+g):g==j?(i+" "+g+" "+f):(i+" "+j+" "+f+" "+g))+";"}return n}e+=b(d,"padding")+b(c,"margin");return e.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(g,f){return f?f+";;":";"})},clone:function(c,d){var b;d=d||{};for(var a in c){if(c.hasOwnProperty(a)){b=c[a];if(typeof b=="object"){d[a]=utils.isArray(b)?[]:{};utils.clone(c[a],d[a])}else{d[a]=b}}}return d},transUnitToPx:function(b){if(!/(pt|cm)/.test(b)){return b}var a;b.replace(/([\d.]+)(\w+)/,function(e,c,d){b=c;a=d});switch(a){case"cm":b=parseFloat(b)*25;break;case"pt":b=Math.round(parseFloat(b)*96/72)}return b+(b?"px":"")},domReady:function(){var a=[];function b(d){d.isReady=true;for(var c;c=a.pop();c()){}}return function(c,e){e=e||window;var d=e.document;c&&a.push(c);if(d.readyState==="complete"){b(d)}else{d.isReady&&b(d);if(browser.ie){(function(){if(d.isReady){return}try{d.documentElement.doScroll("left")}catch(f){setTimeout(arguments.callee,0);return}b(d)})();e.attachEvent("onload",function(){b(d)})}else{d.addEventListener("DOMContentLoaded",function(){d.removeEventListener("DOMContentLoaded",arguments.callee,false);b(d)},false);e.addEventListener("load",function(){b(d)},false)}}}}(),cssRule:browser.ie?function(d,e,f){var a,c;f=f||document;if(f.indexList){a=f.indexList}else{a=f.indexList={}}var b;if(!a[d]){if(e===undefined){return""}b=f.createStyleSheet("",c=f.styleSheets.length);a[d]=c}else{b=f.styleSheets[a[d]]}if(e===undefined){return b.cssText}b.cssText=e||""}:function(b,c,e){e=e||document;var a=e.getElementsByTagName("head")[0],d;if(!(d=e.getElementById(b))){if(c===undefined){return""}d=e.createElement("style");d.id=b;a.appendChild(d)}if(c===undefined){return d.innerHTML}if(c!==""){d.innerHTML=c}else{a.removeChild(d)}}};utils.each(["String","Function","Array","Number","RegExp"],function(a){UE.utils["is"+a]=function(b){return Object.prototype.toString.apply(b)=="[object "+a+"]"}});var EventBase=UE.EventBase=function(){};EventBase.prototype={addListener:function(b,d){b=utils.trim(b).split(" ");for(var a=0,c;c=b[a++];){getListener(this,c,true).push(d)}},removeListener:function(b,d){b=utils.trim(b).split(" ");for(var a=0,c;c=b[a++];){utils.removeItem(getListener(this,c)||[],d)}},fireEvent:function(d){d=utils.trim(d).split(" ");for(var c=0,f;f=d[c++];){var e=getListener(this,f),g,b,a;if(e){a=e.length;while(a--){if(!e[a]){continue}b=e[a].apply(this,arguments);if(b===true){return b}if(b!==undefined){g=b}}}if(b=this["on"+f.toLowerCase()]){g=b.apply(this,arguments)}}return g}};function getListener(d,b,c){var a;b=b.toLowerCase();return((a=(d.__allListeners||c&&(d.__allListeners={})))&&(a[b]||c&&(a[b]=[])))}UE.ajax=function(){var a="XMLHttpRequest()";try{new ActiveXObject("Msxml2.XMLHTTP");a="ActiveXObject('Msxml2.XMLHTTP')"}catch(d){try{new ActiveXObject("Microsoft.XMLHTTP");a="ActiveXObject('Microsoft.XMLHTTP')"}catch(d){}}var c=new Function("return new "+a);function b(f){var g=[];for(var e in f){if(e=="method"||e=="timeout"||e=="async"){continue}if(!((typeof f[e]).toLowerCase()=="function"||(typeof f[e]).toLowerCase()=="object")){g.push(encodeURIComponent(e)+"="+encodeURIComponent(f[e]))}}return g.join("&")}return{request:function(f,h){var l=c(),i=false,g={method:"POST",timeout:5000,async:true,data:{},onsuccess:function(){},onerror:function(){}};if(typeof f==="object"){h=f;f=h.url}if(!l||!f){return}var k=h?utils.extend(g,h):g;var n=b(k);if(!utils.isEmptyObject(k.data)){n+=(n?"&":"")+b(k.data)}var m=setTimeout(function(){if(l.readyState!=4){i=true;l.abort();clearTimeout(m)}},k.timeout);var e=k.method.toUpperCase();var j=f+(f.indexOf("?")==-1?"?":"&")+(e=="POST"?"":n+"&noCache="+ +new Date);l.open(e,j,k.async);l.onreadystatechange=function(){if(l.readyState==4){if(!i&&l.status==200){k.onsuccess(l)}else{k.onerror(l)}}};if(e=="POST"){l.setRequestHeader("Content-Type","application/x-www-form-urlencoded");l.send(n)}else{l.send(null)}}}}();var filterWord=UE.filterWord=function(){function c(d){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<v:)/ig.test(d)}function a(d){d=d.replace(/[\d.]+\w+/g,function(e){return utils.transUnitToPx(e)});return d}function b(d){return d.replace(/[\t\r\n]+/g,"").replace(/<!--[\s\S]*?-->/ig,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(j){if(browser.opera){return""}try{var g=j.match(/width:([ \d.]*p[tx])/i)[1],f=j.match(/height:([ \d.]*p[tx])/i)[1],i=j.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+a(g)+'" height="'+a(f)+'" src="'+i+'" />'}catch(h){return""}}).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)[\w-]+\2/ig,"").replace(/<(font|span)[^>]*>\s*<\/\1>/gi,"").replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(l,q,j,f){var g=[],p=f.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").split(/;\s*/g);for(var k=0,o;o=p[k];k++){var e,m,h=o.split(":");if(h.length==2){e=h[0].toLowerCase();m=h[1].toLowerCase();if(/^(background)\w*/.test(e)&&m.replace(/(initial|\s)/g,"").length==0||/^(margin)\w*/.test(e)&&/^0\w+$/.test(m)){continue}switch(e){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":if(!/<table/.test(q)){g[k]=e.replace(/^mso-|-alt$/g,"")+":"+a(m)}continue;case"horiz-align":g[k]="text-align:"+m;continue;case"vert-align":g[k]="vertical-align:"+m;continue;case"font-color":case"mso-foreground":g[k]="color:"+m;continue;case"mso-background":case"mso-highlight":g[k]="background:"+m;continue;case"mso-default-height":g[k]="min-height:"+a(m);continue;case"mso-default-width":g[k]="min-width:"+a(m);continue;case"mso-padding-between-alt":g[k]="border-collapse:separate;border-spacing:"+a(m);continue;case"text-line-through":if((m=="single")||(m=="double")){g[k]="text-decoration:line-through"}continue;case"mso-zero-height":if(m=="yes"){g[k]="display:none"}continue;case"background":if(m=="initial"){}break;case"margin":if(!/[1-9]/.test(m)){continue}}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(e)||/text\-indent|padding|margin/.test(e)&&/\-[\d.]+/.test(m)){continue}g[k]=e+":"+h[1]}}return q+(g.length?' style="'+g.join(";").replace(/;{2,}/g,";")+'"':"")}).replace(/[\d.]+(cm|pt)/g,function(e){return utils.transUnitToPx(e)})}return function(d){return(c(d)?b(d):d).replace(/>[ \t\r\n]*</g,"><")}}();var dtd=dom.dtd=(function(){function z(B){for(var A in B){B[A.toUpperCase()]=B[A]}return B}function a(E){var B=arguments;for(var D=1;D<B.length;D++){var A=B[D];for(var C in A){if(!E.hasOwnProperty(C)){E[C]=A[C]}}}return E}var y=z({isindex:1,fieldset:1}),x=z({input:1,button:1,select:1,textarea:1,label:1}),w=a(z({a:1}),x),v=a({iframe:1},w),u=z({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),t=z({ins:1,del:1,script:1,style:1}),s=a(z({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),t),r=a(z({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),s),q=a(z({p:1}),r),p=a(z({iframe:1}),r,x),n=z({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),m=a(z({a:0}),p),k=z({tr:1}),j=z({"#":1}),i=a(z({param:1}),n),h=a(z({form:1}),y,v,u,q),g=z({li:1}),f=z({style:1,script:1}),e=z({base:1,link:1,meta:1,title:1}),d=a(e,f),c=z({head:1,body:1}),b=z({html:1});var l=z({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),o=z({area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1,embed:1});return z({$nonBodyContent:a(b,c,e),$block:l,$inline:m,$body:a(z({script:1,style:1}),l),$cdata:z({script:1,style:1}),$empty:o,$nonChild:z({iframe:1,textarea:1}),$listItem:z({dd:1,dt:1,li:1}),$list:z({ul:1,ol:1,dl:1}),$isNotEmpty:z({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:z({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:z({p:1,div:1}),$tableContent:z({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:z({pre:1,script:1,style:1,textarea:1}),html:c,head:d,style:j,script:j,body:h,base:{},link:{},meta:{},title:j,col:{},tr:z({td:1,th:1}),img:{},embed:{},colgroup:z({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:h,td:h,br:{},th:h,center:h,kbd:m,button:a(q,u),basefont:{},h5:m,h4:m,samp:m,h6:m,ol:g,h1:m,h3:m,option:j,h2:m,form:a(y,v,u,q),select:z({optgroup:1,option:1}),font:m,ins:m,menu:g,abbr:m,label:m,table:z({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:m,tfoot:k,cite:m,li:h,input:{},iframe:h,strong:m,textarea:j,noframes:h,big:m,small:m,span:z({"#":1,br:1}),hr:m,dt:m,sub:m,optgroup:z({option:1}),param:{},bdo:m,"var":m,div:h,object:i,sup:m,dd:h,strike:m,area:{},dir:g,map:a(z({area:1,form:1,p:1}),y,t,u),applet:i,dl:z({dt:1,dd:1}),del:m,isindex:{},fieldset:a(z({legend:1}),n),thead:k,ul:g,acronym:m,b:m,a:a(z({a:1}),p),blockquote:a(z({td:1,tr:1,tbody:1,li:1}),h),caption:m,i:m,u:m,tbody:k,s:m,address:a(v,q),tt:m,legend:m,q:m,pre:a(s,w),p:a(z({a:1}),m),em:m,dfn:m})})();function getDomNode(g,h,b,a,e,f){var d=a&&g[h],c;!d&&(d=g[b]);while(!d&&(c=(c||g).parentNode)){if(c.tagName=="BODY"||f&&!f(c)){return null}d=c[b]}if(d&&e&&!e(d)){return getDomNode(d,h,b,false,e)}return d}var attrFix=ie&&browser.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},styleBlock=utils.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]);var domUtils=dom.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:ie&&browser.version=="6"?"\ufeff":"\u200B",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(f,d){if(f===d){return 0}var b,e=[f],c=[d];b=f;while(b=b.parentNode){if(b===d){return 10}e.push(b)}b=d;while(b=b.parentNode){if(b===f){return 20}c.push(b)}e.reverse();c.reverse();if(e[0]!==c[0]){return 1}var a=-1;while(a++,e[a]===c[a]){}f=e[a];d=c[a];while(f=f.nextSibling){if(f===d){return 4}}return 2},getNodeIndex:function(c,b){var d=c,a=0;while(d=d.previousSibling){if(b&&d.nodeType==3){if(d.nodeType!=d.nextSibling.nodeType){a++}continue}a++}return a},inDoc:function(a,b){return domUtils.getPosition(a,b)==10},findParent:function(b,c,a){if(b&&!domUtils.isBody(b)){b=a?b:b.parentNode;while(b){if(!c||c(b)||domUtils.isBody(b)){return c&&!c(b)&&domUtils.isBody(b)?null:b}b=b.parentNode}}return null},findParentByTagName:function(c,a,b,d){a=utils.listToMap(utils.isArray(a)?a:[a]);return domUtils.findParent(c,function(e){return a[e.tagName]&&!(d&&d(e))},b)},findParents:function(d,c,e,b){var a=c&&(e&&e(d)||!e)?[d]:[];while(d=domUtils.findParent(d,e)){a.push(d)}return b?a:a.reverse()},insertAfter:function(b,a){return b.parentNode.insertBefore(a,b.nextSibling)},remove:function(b,c){var a=b.parentNode,d;if(a){if(c&&b.hasChildNodes()){while(d=b.firstChild){a.insertBefore(d,b)}}a.removeChild(b)}return b},getNextDomNode:function(c,a,d,b){return getDomNode(c,"firstChild","nextSibling",a,d,b)},isBookmarkNode:function(a){return a.nodeType==1&&a.id&&/^_baidu_bookmark_/i.test(a.id)},getWindow:function(a){var b=a.ownerDocument||a;return b.defaultView||b.parentWindow},getCommonAncestor:function(f,d){if(f===d){return f}var e=[f],c=[d],b=f,a=-1;while(b=b.parentNode){if(b===d){return b}e.push(b)}b=d;while(b=b.parentNode){if(b===f){return b}c.push(b)}e.reverse();c.reverse();while(a++,e[a]===c[a]){}return a==0?null:e[a-1]},clearEmptySibling:function(d,b,c){function a(g,e){var f;while(g&&!domUtils.isBookmarkNode(g)&&(domUtils.isEmptyInlineElement(g)||!new RegExp("[^\t\n\r"+domUtils.fillChar+"]").test(g.nodeValue))){f=g[e];domUtils.remove(g);g=f}}!b&&a(d.nextSibling,"nextSibling");!c&&a(d.previousSibling,"previousSibling")},split:function(d,f){var e=d.ownerDocument;if(browser.ie&&f==d.nodeValue.length){var c=e.createTextNode("");return domUtils.insertAfter(d,c)}var a=d.splitText(f);if(browser.ie8){var b=e.createTextNode("");domUtils.insertAfter(a,b);domUtils.remove(b)}return a},isWhitespace:function(a){return !new RegExp("[^ \t\n\r"+domUtils.fillChar+"]").test(a.nodeValue)},getXY:function(b){var a=0,c=0;while(b.offsetParent){c+=b.offsetTop;a+=b.offsetLeft;b=b.offsetParent}return{x:a,y:c}},on:function(e,g,f){var d=utils.isArray(g)?g:[g],a=d.length;if(a){while(a--){g=d[a];if(e.addEventListener){e.addEventListener(g,f,false)}else{if(!f._d){f._d={els:[]}}var c=g+f.toString(),b=utils.indexOf(f._d.els,e);if(!f._d[c]||b==-1){if(b==-1){f._d.els.push(e)}if(!f._d[c]){f._d[c]=function(h){return f.call(h.srcElement,h||window.event)}}e.attachEvent("on"+g,f._d[c])}}}}e=null},un:function(f,h,g){var d=utils.isArray(h)?h:[h],a=d.length;if(a){while(a--){h=d[a];if(f.removeEventListener){f.removeEventListener(h,g,false)}else{var c=h+g.toString();try{f.detachEvent("on"+h,g._d?g._d[c]:g)}catch(i){}if(g._d&&g._d[c]){var b=utils.indexOf(g._d.els,f);if(b!=-1){g._d.els.splice(b,1)}g._d.els.length==0&&delete g._d[c]}}}}},isSameElement:function(d,c){if(d.tagName!=c.tagName){return false}var e=d.attributes,g=c.attributes;if(!ie&&e.length!=g.length){return false}var a,j,h=0,b=0;for(var f=0;a=e[f++];){if(a.nodeName=="style"){if(a.specified){h++}if(domUtils.isSameStyle(d,c)){continue}else{return false}}if(ie){if(a.specified){h++;j=g.getNamedItem(a.nodeName)}else{continue}}else{j=c.attributes[a.nodeName]}if(!j.specified||a.nodeValue!=j.nodeValue){return false}}if(ie){for(f=0;j=g[f++];){if(j.specified){b++}}if(h!=b){return false}}return true},isSameStyle:function(g,e){var b=g.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),a=e.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":");if(browser.opera){b=g.style;a=e.style;if(b.length!=a.length){return false}for(var f in b){if(/^(\d+|csstext)$/i.test(f)){continue}if(b[f]!=a[f]){return false}}return true}if(!b||!a){return b==a}b=b.split(";");a=a.split(";");if(b.length!=a.length){return false}for(var d=0,c;c=b[d++];){if(utils.indexOf(a,c)==-1){return false}}return true},isBlockElm:function(a){return a.nodeType==1&&(dtd.$block[a.tagName]||styleBlock[domUtils.getComputedStyle(a,"display")])&&!dtd.$nonChild[a.tagName]},isBody:function(a){return a&&a.nodeType==1&&a.tagName.toLowerCase()=="body"},breakParent:function(e,c){var b,g=e,f=e,a,d;do{g=g.parentNode;if(a){b=g.cloneNode(false);b.appendChild(a);a=b;b=g.cloneNode(false);b.appendChild(d);d=b}else{a=g.cloneNode(false);d=a.cloneNode(false)}while(b=f.previousSibling){a.insertBefore(b,a.firstChild)}while(b=f.nextSibling){d.appendChild(b)}f=g}while(c!==g);b=c.parentNode;b.insertBefore(a,c);b.insertBefore(d,c);b.insertBefore(e,d);domUtils.remove(c);return e},isEmptyInlineElement:function(a){if(a.nodeType!=1||!dtd.$removeEmpty[a.tagName]){return 0}a=a.firstChild;while(a){if(domUtils.isBookmarkNode(a)){return 0}if(a.nodeType==1&&!domUtils.isEmptyInlineElement(a)||a.nodeType==3&&!domUtils.isWhitespace(a)){return 0}a=a.nextSibling}return 1},trimWhiteTextNode:function(b){function a(c){var d;while((d=b[c])&&d.nodeType==3&&domUtils.isWhitespace(d)){b.removeChild(d)}}a("firstChild");a("lastChild")},mergeChild:function(c,b,g){var f=domUtils.getElementsByTagName(c,c.tagName.toLowerCase());for(var e=0,k;k=f[e++];){if(!k.parentNode||domUtils.isBookmarkNode(k)){continue}if(k.tagName.toLowerCase()=="span"){if(c===k.parentNode){domUtils.trimWhiteTextNode(c);if(c.childNodes.length==1){c.style.cssText=k.style.cssText+";"+c.style.cssText;domUtils.remove(k,true);continue}}k.style.cssText=c.style.cssText+";"+k.style.cssText;if(g){var a=g.style;if(a){a=a.split(";");for(var d=0,h;h=a[d++];){k.style[utils.cssStyleToDomStyle(h.split(":")[0])]=h.split(":")[1]}}}if(domUtils.isSameStyle(k,c)){domUtils.remove(k,true)}continue}if(domUtils.isSameElement(c,k)){domUtils.remove(k,true)}}},getElementsByTagName:function(e,a,b){if(b&&utils.isString(b)){var j=b;b=function(i){return domUtils.hasClass(i,j)}}a=utils.trim(a).replace(/[ ]{2,}/g," ").split(" ");var g=[];for(var d=0,c;c=a[d++];){var h=e.getElementsByTagName(c);for(var f=0,k;k=h[f++];){if(!b||b(k)){g.push(k)}}}return g},mergeToParent:function(b){var a=b.parentNode;while(a&&dtd.$removeEmpty[a.tagName]){if(a.tagName==b.tagName||a.tagName=="A"){domUtils.trimWhiteTextNode(a);if(a.tagName=="SPAN"&&!domUtils.isSameStyle(a,b)||(a.tagName=="A"&&b.tagName=="SPAN")){if(a.childNodes.length>1||a!==b.parentNode){b.style.cssText=a.style.cssText+";"+b.style.cssText;a=a.parentNode;continue}else{a.style.cssText+=";"+b.style.cssText;if(a.tagName=="A"){a.style.textDecoration="underline"}}}if(a.tagName!="A"){a===b.parentNode&&domUtils.remove(b,true);break}}a=a.parentNode}},mergeSibling:function(c,b,a){function d(g,h,f){var e;if((e=f[g])&&!domUtils.isBookmarkNode(e)&&e.nodeType==1&&domUtils.isSameElement(f,e)){while(e.firstChild){if(h=="firstChild"){f.insertBefore(e.lastChild,f.firstChild)}else{f.appendChild(e.firstChild)}}domUtils.remove(e)}}!b&&d("previousSibling","firstChild",c);!a&&d("nextSibling","lastChild",c)},unSelectable:ie||browser.opera?function(c){c.onselectstart=function(){return false};c.onclick=c.onkeyup=c.onkeydown=function(){return false};c.unselectable="on";c.setAttribute("unselectable","on");for(var b=0,a;a=c.all[b++];){switch(a.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:a.unselectable="on";c.setAttribute("unselectable","on")}}}:function(a){a.style.MozUserSelect=a.style.webkitUserSelect=a.style.KhtmlUserSelect="none"},removeAttributes:function(c,d){d=utils.isArray(d)?d:utils.trim(d).replace(/[ ]{2,}/g," ").split(" ");for(var b=0,a;a=d[b++];){a=attrFix[a]||a;switch(a){case"className":c[a]="";break;case"style":c.style.cssText="";!browser.ie&&c.removeAttributeNode(c.getAttributeNode("style"))}c.removeAttribute(a)}},createElement:function(c,a,b){return domUtils.setAttributes(c.createElement(a),b)},setAttributes:function(c,b){for(var a in b){if(b.hasOwnProperty(a)){var d=b[a];switch(a){case"class":c.className=d;break;case"style":c.style.cssText=c.style.cssText+";"+d;break;case"innerHTML":c[a]=d;break;case"value":c.value=d;break;default:c.setAttribute(attrFix[a]||a,d)}}}return c},getComputedStyle:function(c,b){var g="width height top left";if(g.indexOf(b)>-1){return c["offset"+b.replace(/^\w/,function(e){return e.toUpperCase()})]+"px"}if(c.nodeType==3){c=c.parentNode}if(browser.ie&&browser.version<9&&b=="font-size"&&!c.style.fontSize&&!dtd.$empty[c.tagName]&&!dtd.$nonChild[c.tagName]){var d=c.ownerDocument.createElement("span");d.style.cssText="padding:0;border:0;font-family:simsun;";d.innerHTML=".";c.appendChild(d);var a=d.offsetHeight;c.removeChild(d);d=null;return a+"px"}try{var f=domUtils.getStyle(c,b)||(window.getComputedStyle?domUtils.getWindow(c).getComputedStyle(c,"").getPropertyValue(b):(c.currentStyle||c.style)[utils.cssStyleToDomStyle(b)])}catch(h){return""}return utils.transUnitToPx(utils.fixColor(b,f))},removeClasses:function(e,d){d=utils.isArray(d)?d:utils.trim(d).replace(/[ ]{2,}/g," ").split(" ");for(var c=0,b,a=e.className;b=d[c++];){a=a.replace(new RegExp("\\b"+b+"\\b"),"")}a=utils.trim(a).replace(/[ ]{2,}/g," ");if(a){e.className=a}else{domUtils.removeAttributes(e,["class"])}},addClass:function(e,d){if(!e){return}d=utils.trim(d).replace(/[ ]{2,}/g," ").split(" ");for(var c=0,b,a=e.className;b=d[c++];){if(!new RegExp("\\b"+b+"\\b").test(a)){e.className+=" "+b}}},hasClass:function(d,e){if(utils.isRegExp(e)){return e.test(d.className)}e=utils.trim(e).replace(/[ ]{2,}/g," ").split(" ");for(var c=0,b,a=d.className;b=e[c++];){if(!new RegExp("\\b"+b+"\\b","i").test(a)){return false}}return c-1==e.length},preventDefault:function(a){a.preventDefault?a.preventDefault():(a.returnValue=false)},removeStyle:function(b,a){if(browser.ie&&browser.version>8){b.style.cssText=b.style.cssText.replace(new RegExp(a+"s*:s*[^;]+;?"),"")}else{if(b.style.removeProperty){b.style.removeProperty(a)}else{b.style.removeAttribute(utils.cssStyleToDomStyle(a))}}if(!b.style.cssText){domUtils.removeAttributes(b,["style"])}},getStyle:function(b,a){var c=b.style[utils.cssStyleToDomStyle(a)];return utils.fixColor(a,c)},setStyle:function(b,a,c){b.style[utils.cssStyleToDomStyle(a)]=c},setStyles:function(b,c){for(var a in c){if(c.hasOwnProperty(a)){domUtils.setStyle(b,a,c[a])}}},removeDirtyAttr:function(d){for(var c=0,b,a=d.getElementsByTagName("*");b=a[c++];){b.removeAttribute("_moz_dirty")}d.removeAttribute("_moz_dirty")},getChildCount:function(c,a){var b=0,d=c.firstChild;a=a||function(){return 1};while(d){if(a(d)){b++}d=d.nextSibling}return b},isEmptyNode:function(a){return !a.firstChild||domUtils.getChildCount(a,function(b){return !domUtils.isBr(b)&&!domUtils.isBookmarkNode(b)&&!domUtils.isWhitespace(b)})==0},clearSelectedArr:function(a){var b;while(b=a.pop()){domUtils.removeAttributes(b,["class"])}},scrollToView:function(c,i,a){var b=function(){var j=i.document,k=j.compatMode=="CSS1Compat";return{width:(k?j.documentElement.clientWidth:j.body.clientWidth)||0,height:(k?j.documentElement.clientHeight:j.body.clientHeight)||0}},h=function(k){if("pageXOffset" in k){return{x:k.pageXOffset||0,y:k.pageYOffset||0}}else{var j=k.document;return{x:j.documentElement.scrollLeft||j.body.scrollLeft||0,y:j.documentElement.scrollTop||j.body.scrollTop||0}}};var f=b().height,g=f*-1+a;g+=(c.offsetHeight||0);var d=domUtils.getXY(c);g+=d.y;var e=h(i).y;if(g>e||g<e-f){i.scrollTo(0,g+(g<0?-20:20))}},isBr:function(a){return a.nodeType==1&&a.tagName=="BR"},isFillChar:function(a,b){return a.nodeType==3&&!a.nodeValue.replace(new RegExp((b?"^":"")+domUtils.fillChar),"").length},isStartInblock:function(b){var f=b.cloneRange(),a=0,g=f.startContainer,c;if(g.nodeType==1&&g.childNodes[f.startOffset]){g=g.childNodes[f.startOffset];var e=g.previousSibling;while(e&&domUtils.isFillChar(e)){g=e;e=e.previousSibling}}if(this.isFillChar(g,true)&&f.startOffset==1){f.setStartBefore(g);g=f.startContainer}while(g&&domUtils.isFillChar(g)){c=g;g=g.previousSibling}if(c){f.setStartBefore(c);g=f.startContainer}if(g.nodeType==1&&domUtils.isEmptyNode(g)&&f.startOffset==1){f.setStart(g,0).collapse(true)}while(!f.startOffset){g=f.startContainer;if(domUtils.isBlockElm(g)||domUtils.isBody(g)){a=1;break}var e=f.startContainer.previousSibling,d;if(!e){f.setStartBefore(f.startContainer)}else{while(e&&domUtils.isFillChar(e)){d=e;e=e.previousSibling}if(d){f.setStartBefore(d)}else{f.setStartBefore(f.startContainer)}}}return a&&!domUtils.isBody(f.startContainer)?1:0},isEmptyBlock:function(b){var a=new RegExp("[ \t\r\n"+domUtils.fillChar+"]","g");if(b[browser.ie?"innerText":"textContent"].replace(a,"").length>0){return 0}for(var c in dtd.$isNotEmpty){if(b.getElementsByTagName(c).length){return 0}}return 1},setViewportOffset:function(a,g){var f=parseInt(a.style.left)|0;var e=parseInt(a.style.top)|0;var c=a.getBoundingClientRect();var d=g.left-c.left;var b=g.top-c.top;if(d){a.style.left=f+d+"px"}if(b){a.style.top=e+b+"px"}},fillNode:function(c,b){var a=browser.ie?c.createTextNode(domUtils.fillChar):c.createElement("br");b.innerHTML="";b.appendChild(a)},moveChild:function(c,a,b){while(c.firstChild){if(b&&a.firstChild){a.insertBefore(c.lastChild,a.firstChild)}else{a.appendChild(c.firstChild)}}},hasNoAttributes:function(a){return browser.ie?/^<\w+\s*?>/.test(a.outerHTML):a.attributes.length==0},isCustomeNode:function(a){return a.nodeType==1&&a.getAttribute("_ue_custom_node_")},isTagNode:function(b,a){return b.nodeType==1&&new RegExp(b.tagName,"i").test(a)},filterNodeList:function(d,c,b){var a=[];if(!utils.isFunction(c)){var e=c;c=function(f){return utils.indexOf(utils.isArray(e)?e:e.split(" "),f.tagName.toLowerCase())!=-1}}utils.each(d,function(f){c(f)&&a.push(f)});return a.length==0?null:a.length==1||!b?a[0]:a},isInNodeEndBoundary:function(a,b){var c=a.startContainer;if(c.nodeType==3&&a.startOffset!=c.nodeValue.length){return 0}if(c.nodeType==1&&a.startOffset!=c.childNodes.length){return 0}while(c!==b){if(c.nextSibling){return 0}c=c.parentNode}return 1},isBoundaryNode:function(c,a){var b;while(!domUtils.isBody(c)){b=c;c=c.parentNode;if(b!==c[a]){return false}}return true}};var fillCharReg=new RegExp(domUtils.fillChar,"g");(function(){var f=0,g=domUtils.fillChar,c;function b(k){k.collapsed=k.startContainer&&k.endContainer&&k.startContainer===k.endContainer&&k.startOffset==k.endOffset}function j(k){return !k.collapsed&&k.startContainer.nodeType==1&&k.startContainer===k.endContainer&&k.endOffset-k.startOffset==1}function a(l,m,n,k){if(m.nodeType==1&&(dtd.$empty[m.tagName]||dtd.$nonChild[m.tagName])){n=domUtils.getNodeIndex(m)+(l?0:1);m=m.parentNode}if(l){k.startContainer=m;k.startOffset=n;if(!k.endContainer){k.collapse(true)}}else{k.endContainer=m;k.endOffset=n;if(!k.startContainer){k.collapse(false)}}b(k);return k}function i(q,u){var o=q.startContainer,n=q.endContainer,w=q.startOffset,p=q.endOffset,C=q.document,k=C.createDocumentFragment(),r,t;if(o.nodeType==1){o=o.childNodes[w]||(r=o.appendChild(C.createTextNode("")))}if(n.nodeType==1){n=n.childNodes[p]||(t=n.appendChild(C.createTextNode("")))}if(o===n&&o.nodeType==3){k.appendChild(C.createTextNode(o.substringData(w,p-w)));if(u){o.deleteData(w,p-w);q.collapse(true)}return k}var s,y,A=k,z=domUtils.findParents(o,true),l=domUtils.findParents(n,true);for(var x=0;z[x]==l[x];){x++}for(var v=x,B;B=z[v];v++){s=B.nextSibling;if(B==o){if(!r){if(q.startContainer.nodeType==3){A.appendChild(C.createTextNode(o.nodeValue.slice(w)));if(u){o.deleteData(w,o.nodeValue.length-w)}}else{A.appendChild(!u?o.cloneNode(true):o)}}}else{y=B.cloneNode(false);A.appendChild(y)}while(s){if(s===n||s===l[v]){break}B=s.nextSibling;A.appendChild(!u?s.cloneNode(true):s);s=B}A=y}A=k;if(!z[x]){A.appendChild(z[x-1].cloneNode(false));A=A.firstChild}for(var v=x,m;m=l[v];v++){s=m.previousSibling;if(m==n){if(!t&&q.endContainer.nodeType==3){A.appendChild(C.createTextNode(n.substringData(0,p)));if(u){n.deleteData(0,p)}}}else{y=m.cloneNode(false);A.appendChild(y)}if(v!=x||!z[x]){while(s){if(s===o){break}m=s.previousSibling;A.insertBefore(!u?s.cloneNode(true):s,A.firstChild);s=m}}A=y}if(u){q.setStartBefore(!l[x]?l[x-1]:!z[x]?z[x-1]:l[x]).collapse(true)}r&&domUtils.remove(r);t&&domUtils.remove(t);return k}var d=dom.Range=function(k){var l=this;l.startContainer=l.startOffset=l.endContainer=l.endOffset=null;l.document=k;l.collapsed=true};function e(n,k){try{if(c&&domUtils.inDoc(c,n)){if(!c.nodeValue.replace(fillCharReg,"").length){var l=c.parentNode;domUtils.remove(c);while(l&&domUtils.isEmptyInlineElement(l)&&(browser.safari?!(domUtils.getPosition(l,k)&domUtils.POSITION_CONTAINS):!l.contains(k))){c=l.parentNode;domUtils.remove(l);l=c}}else{c.nodeValue=c.nodeValue.replace(fillCharReg,"")}}}catch(m){}}function h(m,k){var l;m=m[k];while(m&&domUtils.isFillChar(m)){l=m[k];domUtils.remove(m);m=l}}d.prototype={cloneContents:function(){return this.collapsed?null:i(this,0)},deleteContents:function(){var k;if(!this.collapsed){i(this,1)}if(browser.webkit){k=this.startContainer;if(k.nodeType==3&&!k.nodeValue.length){this.setStartBefore(k).collapse(true);domUtils.remove(k)}}return this},extractContents:function(){return this.collapsed?null:i(this,2)},setStart:function(k,l){return a(true,k,l,this)},setEnd:function(k,l){return a(false,k,l,this)},setStartAfter:function(k){return this.setStart(k.parentNode,domUtils.getNodeIndex(k)+1)},setStartBefore:function(k){return this.setStart(k.parentNode,domUtils.getNodeIndex(k))},setEndAfter:function(k){return this.setEnd(k.parentNode,domUtils.getNodeIndex(k)+1)},setEndBefore:function(k){return this.setEnd(k.parentNode,domUtils.getNodeIndex(k))},setStartAtFirst:function(k){return this.setStart(k,0)},setStartAtLast:function(k){return this.setStart(k,k.nodeType==3?k.nodeValue.length:k.childNodes.length)},setEndAtFirst:function(k){return this.setEnd(k,0)},setEndAtLast:function(k){return this.setEnd(k,k.nodeType==3?k.nodeValue.length:k.childNodes.length)},selectNode:function(k){return this.setStartBefore(k).setEndAfter(k)},selectNodeContents:function(k){return this.setStart(k,0).setEndAtLast(k)},cloneRange:function(){var k=this;return new d(k.document).setStart(k.startContainer,k.startOffset).setEnd(k.endContainer,k.endOffset)},collapse:function(k){var l=this;if(k){l.endContainer=l.startContainer;l.endOffset=l.startOffset}else{l.startContainer=l.endContainer;l.startOffset=l.endOffset}l.collapsed=true;return l},shrinkBoundary:function(m){var l=this,o,n=l.collapsed;function k(p){return p.nodeType==1&&!domUtils.isBookmarkNode(p)&&!dtd.$empty[p.tagName]&&!dtd.$nonChild[p.tagName]}while(l.startContainer.nodeType==1&&(o=l.startContainer.childNodes[l.startOffset])&&k(o)){l.setStart(o,0)}if(n){return l.collapse(true)}if(!m){while(l.endContainer.nodeType==1&&l.endOffset>0&&(o=l.endContainer.childNodes[l.endOffset-1])&&k(o)){l.setEnd(o,o.childNodes.length)}}return l},getCommonAncestor:function(l,m){var n=this,o=n.startContainer,k=n.endContainer;if(o===k){if(l&&j(this)){o=o.childNodes[n.startOffset];if(o.nodeType==1){return o}}return m&&o.nodeType==3?o.parentNode:o}return domUtils.getCommonAncestor(o,k)},trimBoundary:function(l){this.txtToElmBoundary();var p=this.startContainer,o=this.startOffset,n=this.collapsed,k=this.endContainer;if(p.nodeType==3){if(o==0){this.setStartBefore(p)}else{if(o>=p.nodeValue.length){this.setStartAfter(p)}else{var m=domUtils.split(p,o);if(p===k){this.setEnd(m,this.endOffset-o)}else{if(p.parentNode===k){this.endOffset+=1}}this.setStartBefore(m)}}if(n){return this.collapse(true)}}if(!l){o=this.endOffset;k=this.endContainer;if(k.nodeType==3){if(o==0){this.setEndBefore(k)}else{o<k.nodeValue.length&&domUtils.split(k,o);this.setEndAfter(k)}}}return this},txtToElmBoundary:function(){function k(m,o){var l=m[o+"Container"],n=m[o+"Offset"];if(l.nodeType==3){if(!n){m["set"+o.replace(/(\w)/,function(p){return p.toUpperCase()})+"Before"](l)}else{if(n>=l.nodeValue.length){m["set"+o.replace(/(\w)/,function(p){return p.toUpperCase()})+"After"](l)}}}}if(!this.collapsed){k(this,"start");k(this,"end")}return this},insertNode:function(m){var o=m,l=1;if(m.nodeType==11){o=m.firstChild;l=m.childNodes.length}this.trimBoundary(true);var p=this.startContainer,n=this.startOffset;var k=p.childNodes[n];if(k){p.insertBefore(m,k)}else{p.appendChild(m)}if(o.parentNode===this.endContainer){this.endOffset=this.endOffset+l}return this.setStartBefore(o)},setCursor:function(l,k){return this.collapse(!l).select(k)},createBookmark:function(m,n){var k,l=this.document.createElement("span");l.style.cssText="display:none;line-height:0px;";l.appendChild(this.document.createTextNode("\u200D"));l.id="_baidu_bookmark_start_"+(n?"":f++);if(!this.collapsed){k=l.cloneNode(true);k.id="_baidu_bookmark_end_"+(n?"":f++)}this.insertNode(l);if(k){this.collapse().insertNode(k).setEndBefore(k)}this.setStartAfter(l);return{start:m?l.id:l,end:k?m?k.id:k:null,id:m}},moveToBookmark:function(l){var m=l.id?this.document.getElementById(l.start):l.start,k=l.end&&l.id?this.document.getElementById(l.end):l.end;this.setStartBefore(m);domUtils.remove(m);if(k){this.setEndBefore(k);domUtils.remove(k)}else{this.collapse(true)}return this},enlarge:function(l,o){var k=domUtils.isBody,p,n,m=this.document.createTextNode("");if(l){n=this.startContainer;if(n.nodeType==1){if(n.childNodes[this.startOffset]){p=n=n.childNodes[this.startOffset]}else{n.appendChild(m);p=n=m}}else{p=n}while(1){if(domUtils.isBlockElm(n)){n=p;while((p=n.previousSibling)&&!domUtils.isBlockElm(p)){n=p}this.setStartBefore(n);break}p=n;n=n.parentNode}n=this.endContainer;if(n.nodeType==1){if(p=n.childNodes[this.endOffset]){n.insertBefore(m,p)}else{n.appendChild(m)}p=n=m}else{p=n}while(1){if(domUtils.isBlockElm(n)){n=p;while((p=n.nextSibling)&&!domUtils.isBlockElm(p)){n=p}this.setEndAfter(n);break}p=n;n=n.parentNode}if(m.parentNode===this.endContainer){this.endOffset--}domUtils.remove(m)}if(!this.collapsed){while(this.startOffset==0){if(o&&o(this.startContainer)){break}if(k(this.startContainer)){break}this.setStartBefore(this.startContainer)}while(this.endOffset==(this.endContainer.nodeType==1?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)){if(o&&o(this.endContainer)){break}if(k(this.endContainer)){break}this.setEndAfter(this.endContainer)}}return this},adjustmentBoundary:function(){if(!this.collapsed){while(!domUtils.isBody(this.startContainer)&&this.startOffset==this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length){this.setStartAfter(this.startContainer)}while(!domUtils.isBody(this.endContainer)&&!this.endOffset){this.setEndBefore(this.endContainer)}}return this},applyInlineStyle:function(m,x,t){if(this.collapsed){return this}this.trimBoundary().enlarge(false,function(B){return B.nodeType==1&&domUtils.isBlockElm(B)}).adjustmentBoundary();var u=this.createBookmark(),p=u.end,z=function(B){return B.nodeType==1?B.tagName.toLowerCase()!="br":!domUtils.isWhitespace(B)},s=domUtils.getNextDomNode(u.start,false,z),n,o,r=this.cloneRange();while(s&&(domUtils.getPosition(s,p)&domUtils.POSITION_PRECEDING)){if(s.nodeType==3||dtd[m][s.tagName]){r.setStartBefore(s);n=s;while(n&&(n.nodeType==3||dtd[m][n.tagName])&&n!==p){o=n;n=domUtils.getNextDomNode(n,n.nodeType==1,null,function(B){return dtd[m][B.tagName]})}var y=r.setEndAfter(o).extractContents(),v;if(t&&t.length>0){var k,w;w=k=t[0].cloneNode(false);for(var q=1,A;A=t[q++];){k.appendChild(A.cloneNode(false));k=k.firstChild}v=k}else{v=r.document.createElement(m)}if(x){domUtils.setAttributes(v,x)}v.appendChild(y);r.insertNode(t?w:v);var l;if(m=="span"&&x.style&&/text\-decoration/.test(x.style)&&(l=domUtils.findParentByTagName(v,"a",true))){domUtils.setAttributes(l,x);domUtils.remove(v,true);v=l}else{domUtils.mergeSibling(v);domUtils.clearEmptySibling(v)}domUtils.mergeChild(v,x);s=domUtils.getNextDomNode(v,false,z);domUtils.mergeToParent(v);if(n===p){break}}else{s=domUtils.getNextDomNode(s,true,z)}}return this.moveToBookmark(u)},removeInlineStyle:function(k){if(this.collapsed){return this}k=utils.isArray(k)?k:[k];this.shrinkBoundary().adjustmentBoundary();var r=this.startContainer,l=this.endContainer;while(1){if(r.nodeType==1){if(utils.indexOf(k,r.tagName.toLowerCase())>-1){break}if(r.tagName.toLowerCase()=="body"){r=null;break}}r=r.parentNode}while(1){if(l.nodeType==1){if(utils.indexOf(k,l.tagName.toLowerCase())>-1){break}if(l.tagName.toLowerCase()=="body"){l=null;break}}l=l.parentNode}var n=this.createBookmark(),q,p;if(r){p=this.cloneRange().setEndBefore(n.start).setStartBefore(r);q=p.extractContents();p.insertNode(q);domUtils.clearEmptySibling(r,true);r.parentNode.insertBefore(n.start,r)}if(l){p=this.cloneRange().setStartAfter(n.end).setEndAfter(l);q=p.extractContents();p.insertNode(q);domUtils.clearEmptySibling(l,false,true);l.parentNode.insertBefore(n.end,l.nextSibling)}var o=domUtils.getNextDomNode(n.start,false,function(s){return s.nodeType==1}),m;while(o&&o!==n.end){m=domUtils.getNextDomNode(o,true,function(s){return s.nodeType==1});if(utils.indexOf(k,o.tagName.toLowerCase())>-1){domUtils.remove(o,true)}o=m}return this.moveToBookmark(n)},getClosedNode:function(){var l;if(!this.collapsed){var k=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(j(k)){var m=k.startContainer.childNodes[k.startOffset];if(m&&m.nodeType==1&&(dtd.$empty[m.tagName]||dtd.$nonChild[m.tagName])){l=m}}}return l},select:browser.ie?function(l,u){var q;if(!this.collapsed){this.shrinkBoundary()}var m=this.getClosedNode();if(m&&!u){try{q=this.document.body.createControlRange();q.addElement(m);q.select()}catch(r){}return this}var s=this.createBookmark(),k=s.start,n;q=this.document.body.createTextRange();q.moveToElementText(k);q.moveStart("character",1);if(!this.collapsed){var p=this.document.body.createTextRange();n=s.end;p.moveToElementText(n);q.setEndPoint("EndToEnd",p)}else{if(!l&&this.startContainer.nodeType!=3){var t=this.document.createTextNode(g),o=this.document.createElement("span");o.appendChild(this.document.createTextNode(g));k.parentNode.insertBefore(o,k);k.parentNode.insertBefore(t,k);e(this.document,t);c=t;h(o,"previousSibling");h(k,"nextSibling");q.moveStart("character",-1);q.collapse(true)}}this.moveToBookmark(s);o&&domUtils.remove(o);try{q.select()}catch(r){}return this}:function(k){function l(t){function s(v,w,u){if(v.nodeType==3&&v.nodeValue.length<w){t[u+"Offset"]=v.nodeValue.length}}s(t.startContainer,t.startOffset,"start");s(t.endContainer,t.endOffset,"end")}var p=domUtils.getWindow(this.document),o=p.getSelection(),n;browser.gecko?this.document.body.focus():p.focus();if(o){o.removeAllRanges();if(this.collapsed&&!k){var r=this.startContainer,q=r;if(r.nodeType==1){q=r.childNodes[this.startOffset]}if(!(r.nodeType==3&&this.startOffset)&&(q?(!q.previousSibling||q.previousSibling.nodeType!=3):(!r.lastChild||r.lastChild.nodeType!=3))){n=this.document.createTextNode(g);this.insertNode(n);e(this.document,n);h(n,"previousSibling");h(n,"nextSibling");c=n;this.setStart(n,browser.webkit?1:0).collapse(true)}}var m=this.document.createRange();if(this.collapsed&&browser.opera&&this.startContainer.nodeType==1){var q=this.startContainer.childNodes[this.startOffset];if(!q){q=this.startContainer.lastChild;if(q&&domUtils.isBr(q)){this.setStartBefore(q).collapse(true)}}else{while(q&&domUtils.isBlockElm(q)){if(q.nodeType==1&&q.childNodes[0]){q=q.childNodes[0]}else{break}}q&&this.setStartBefore(q).collapse(true)}}l(this);m.setStart(this.startContainer,this.startOffset);m.setEnd(this.endContainer,this.endOffset);o.addRange(m)}return this},scrollToView:function(m,n){m=m?window:domUtils.getWindow(this.document);var l=this,k=l.document.createElement("span");k.innerHTML="&nbsp;";l.cloneRange().insertNode(k);domUtils.scrollToView(k,m,n);domUtils.remove(k);return l},inFillChar:function(){var k=this.startContainer;if(this.collapsed&&k.nodeType==3&&k.nodeValue.replace(new RegExp("^"+domUtils.fillChar),"").length+1==k.nodeValue.length){return true}return false},createAddress:function(n,m){var o={},l=this;function k(p){var r=p?l.startContainer:l.endContainer;var w=domUtils.findParents(r,true,function(y){return !domUtils.isBody(y)}),v=[];for(var t=0,x;x=w[t++];){v.push(domUtils.getNodeIndex(x,m))}var q=0;if(m){if(r.nodeType==3){var s=r;while(s=s.previousSibling){if(s.nodeType==3){q+=s.nodeValue.replace(fillCharReg,"").length}else{break}}q+=(p?l.startOffset:l.endOffset)-(fillCharReg.test(r.nodeValue)?1:0)}else{r=r.childNodes[p?l.startOffset:l.endOffset];if(r){q=domUtils.getNodeIndex(r,m)}else{r=p?l.startContainer:l.endContainer;var u=r.firstChild;while(u){if(domUtils.isFillChar(u)){u=u.nextSibling;continue}q++;if(u.nodeType==3){while(u&&u.nodeType==3){u=u.nextSibling}}else{u=u.nextSibling}}}}}else{q=p?l.startOffset:l.endOffset}if(q<0){q=0}v.push(q);return v}o.startAddress=k(true);if(!n){o.endAddress=l.collapsed?[].concat(o.startAddress):k()}return o},moveToAddress:function(n,l){var k=this;function m(r,q){var u=k.document.body,o,v;for(var t=0,s,p=r.length;t<p;t++){s=r[t];o=u;u=u.childNodes[s];if(!u){v=s;break}}if(q){if(u){k.setStartBefore(u)}else{k.setStart(o,v)}}else{if(u){k.setEndBefore(u)}else{k.setEnd(o,v)}}}m(n.startAddress,true);!l&&n.endAddress&&m(n.endAddress);return k},equals:function(k){for(var l in this){if(this.hasOwnProperty(l)){if(this[l]!==k[l]){return false}}}return true}}})();(function(){function d(p,g){var h=domUtils.getNodeIndex;p=p.duplicate();p.collapse(g);var t=p.parentElement();if(!t.hasChildNodes()){return{container:t,offset:0}}var s=t.children,j,l=p.duplicate(),u=0,o=s.length-1,q=-1,f;while(u<=o){q=Math.floor((u+o)/2);j=s[q];l.moveToElementText(j);var n=l.compareEndPoints("StartToStart",p);if(n>0){o=q-1}else{if(n<0){u=q+1}else{return{container:t,offset:h(j)}}}}if(q==-1){l.moveToElementText(t);l.setEndPoint("StartToStart",p);f=l.text.replace(/(\r\n|\r)/g,"\n").length;s=t.childNodes;if(!f){j=s[s.length-1];return{container:j,offset:j.nodeValue.length}}var m=s.length;while(f>0){f-=s[--m].nodeValue.length}return{container:s[m],offset:-f}}l.collapse(n>0);l.setEndPoint(n>0?"StartToStart":"EndToStart",p);f=l.text.replace(/(\r\n|\r)/g,"\n").length;if(!f){return dtd.$empty[j.tagName]||dtd.$nonChild[j.tagName]?{container:t,offset:h(j)+(n>0?0:1)}:{container:j,offset:n>0?0:j.childNodes.length}}while(f>0){try{var k=j;j=j[n>0?"previousSibling":"nextSibling"];f-=j.nodeValue.length}catch(r){return{container:t,offset:h(k)}}}return{container:j,offset:n>0?-f:j.nodeValue.length+f}}function c(g,f){if(g.item){f.selectNode(g.item(0))}else{var e=d(g,true);f.setStart(e.container,e.offset);if(g.compareEndPoints("StartToEnd",g)!=0){e=d(g,false);f.setEnd(e.container,e.offset)}}return f}function b(h){var g;try{g=h.getNative().createRange()}catch(i){return null}var f=g.item?g.item(0):g.parentElement();if((f.ownerDocument||f)===h.document){return g}return null}var a=dom.Selection=function(g){var f=this,e;f.document=g;if(ie){e=domUtils.getWindow(g).frameElement;domUtils.on(e,"beforedeactivate",function(){f._bakIERange=f.getIERange()});domUtils.on(e,"activate",function(){try{if(!b(f)&&f._bakIERange){f._bakIERange.select()}}catch(h){}f._bakIERange=null})}e=g=null};a.prototype={getNative:function(){var g=this.document;try{return !g?null:ie?g.selection:domUtils.getWindow(g).getSelection()}catch(f){return null}},getIERange:function(){var e=b(this);if(!e){if(this._bakIERange){return this._bakIERange}}return e},cache:function(){this.clear();this._cachedRange=this.getRange();this._cachedStartElement=this.getStart();this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath){return this._cachedStartElementPath}var e=this.getStart();if(e){return domUtils.findParents(e,true,null,true)}return[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){try{return browser.ie&&b(this)||!browser.ie&&this.getNative().rangeCount?true:false}catch(f){return false}},getRange:function(){var i=this;function h(e){var o=i.document.body.firstChild,n=e.collapsed;while(o&&o.firstChild){e.setStart(o,0);o=o.firstChild}if(!e.startContainer){e.setStart(i.document.body,0)}if(n){e.collapse(true)}}if(i._cachedRange!=null){return this._cachedRange}var g=new baidu.editor.dom.Range(i.document);if(ie){var k=i.getIERange();if(k){try{c(k,g)}catch(l){h(g)}}else{h(g)}}else{var j=i.getNative();if(j&&j.rangeCount){var f=j.getRangeAt(0);var m=j.getRangeAt(j.rangeCount-1);g.setStart(f.startContainer,f.startOffset).setEnd(m.endContainer,m.endOffset);if(g.collapsed&&domUtils.isBody(g.startContainer)&&!g.startOffset){h(g)}}else{if(this._bakRange&&domUtils.inDoc(this._bakRange.startContainer,this.document)){return this._bakRange}h(g)}}return this._bakRange=g},getStart:function(){if(this._cachedStartElement){return this._cachedStartElement}var e=ie?this.getIERange():this.getRange(),h,i,f,g;if(ie){if(!e){return this.document.body.firstChild}if(e.item){return e.item(0)}h=e.duplicate();h.text.length>0&&h.moveStart("character",1);h.collapse(1);i=h.parentElement();g=f=e.parentElement();while(f=f.parentNode){if(f==i){i=g;break}}}else{e.shrinkBoundary();i=e.startContainer;if(i.nodeType==1&&i.hasChildNodes()){i=i.childNodes[Math.min(i.childNodes.length-1,e.startOffset)]}if(i.nodeType==3){return i.parentNode}}return i},getText:function(){var e,f;if(this.isFocus()&&(e=this.getNative())){f=browser.ie?e.createRange():e.getRangeAt(0);return browser.ie?f.text:f.toString()}return""},clearRange:function(){this.getNative()[browser.ie?"empty":"removeAllRanges"]()}}})();(function(){var d=0,b;function c(m){var l=m.getElementsByTagName("img"),k;for(var j=0,h;h=l[j++];){if(k=h.getAttribute("orgSrc")){h.src=k;h.removeAttribute("orgSrc")}}var g=m.getElementsByTagName("a");for(var j=0,f;f=g[j++];j++){if(f.getAttribute("data_ue_src")){f.setAttribute("href",f.getAttribute("data_ue_src"))}}}function e(l,k){var f;if(k.textarea){if(utils.isString(k.textarea)){for(var h=0,j,g=domUtils.getElementsByTagName(l,"textarea");j=g[h++];){if(j.id=="ueditor_textarea_"+k.options.textarea){f=j;break}}}else{f=k.textarea}}if(!f){l.appendChild(f=domUtils.createElement(document,"textarea",{name:k.options.textarea,id:"ueditor_textarea_"+k.options.textarea,style:"display:none"}));k.textarea=f}f.value=k.hasContents()?(k.options.allHtmlEnabled?k.getAllHtml():k.getContent(null,null,true)):""}var a=UE.Editor=function(f){var g=this;g.uid=d++;EventBase.call(g);g.commands={};g.options=utils.extend(utils.clone(f||{}),UEDITOR_CONFIG,true);g.shortcutkeys={};g.setOpt({isShow:true,initialContent:"\u6b22\u8fce\u4f7f\u7528ueditor!",autoClearinitialContent:false,iframeCssUrl:g.options.UEDITOR_HOME_URL+"themes/iframe.css",textarea:"editorValue",focus:false,initialFrameWidth:1000,initialFrameHeight:g.options.minFrameHeight||320,minFrameWidth:800,minFrameHeight:220,autoClearEmptyNode:true,fullscreen:false,readonly:false,zIndex:999,imagePopup:true,enterTag:"p",pageBreakTag:"_baidu_page_break_tag_",customDomain:false,lang:"zh-cn",langPath:g.options.UEDITOR_HOME_URL+"lang/",theme:"default",themePath:g.options.UEDITOR_HOME_URL+"themes/",allHtmlEnabled:false,scaleEnabled:false,tableNativeEditInFF:false});utils.loadFile(document,{src:g.options.langPath+g.options.lang+"/"+g.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},function(){for(var h in UE.plugins){UE.plugins[h].call(g)}g.langIsReady=true;g.fireEvent("langReady")});UE.instants["ueditorInstant"+g.uid]=g};a.prototype={ready:function(f){var g=this;if(f){g.isReady?f.apply(g):g.addListener("ready",f)}},setOpt:function(f,h){var g={};if(utils.isString(f)){g[f]=h}else{g=f}utils.extend(this.options,g,true)},destroy:function(){var i=this;i.fireEvent("destroy");var g=i.container.parentNode;var f=i.textarea;if(!f){f=document.createElement("textarea");g.parentNode.insertBefore(f,g)}else{f.style.display=""}f.style.width=g.offsetWidth+"px";f.style.height=g.offsetHeight+"px";f.value=i.getContent();f.id=i.key;g.innerHTML="";domUtils.remove(g);var h=i.key;for(var j in i){if(i.hasOwnProperty(j)){delete this[j]}}UE.delEditor(h)},render:function(g){var j=this,h=j.options;if(utils.isString(g)){g=document.getElementById(g)}if(g){var f=ie&&browser.version<9,i=(ie&&browser.version<9?"":"<!DOCTYPE html>")+"<html xmlns='http://www.w3.org/1999/xhtml'"+(!f?" class='view'":"")+"><head>"+(h.iframeCssUrl?"<link rel='stylesheet' type='text/css' href='"+utils.unhtml(h.iframeCssUrl)+"'/>":"")+"<style type='text/css'>.view{padding:0;word-wrap:break-word;cursor:text;height:100%;}\nbody{margin:8px;font-family:sans-serif;font-size:16px;}p{margin:5px 0;}"+(h.initialStyle||"")+"</style></head><body"+(f?" class='view'":"")+"></body>";if(h.customDomain&&document.domain!=location.hostname){i+="<script>window.parent.UE.instants['ueditorInstant"+j.uid+"']._setup(document);<\/script></html>";g.appendChild(domUtils.createElement(document,"iframe",{id:"baidu_editor_"+j.uid,width:"100%",height:"100%",frameborder:"0",src:'javascript:void(function(){document.open();document.domain="'+document.domain+'";document.write("'+i+'");document.close();}())'}))}else{g.innerHTML='<iframe id="baidu_editor_'+this.uid+'"width="100%" height="100%" scroll="no" frameborder="0" ></iframe>';var k=g.firstChild.contentWindow.document;k.open();k.write(i+"</html>");k.close();j._setup(k)}g.style.overflow="hidden"}},_setup:function(k){var i=this,f=i.options;if(ie){k.body.disabled=true;k.body.contentEditable=true;k.body.disabled=false}else{k.body.contentEditable=true;k.body.spellcheck=false}i.document=k;i.window=k.defaultView||k.parentWindow;i.iframe=i.window.frameElement;i.body=k.body;i.setHeight(Math.max(f.minFrameHeight,f.initialFrameHeight));i.selection=new dom.Selection(k);var l;if(browser.gecko&&(l=this.selection.getNative())){l.removeAllRanges()}this._initEvents();if(f.initialContent){if(f.autoClearinitialContent){var g=i.execCommand;i.execCommand=function(){i.fireEvent("firstBeforeExecCommand");return g.apply(i,arguments)};this._setDefaultContent(f.initialContent)}else{this.setContent(f.initialContent,false,true)}}for(var h=this.iframe.parentNode;!domUtils.isBody(h);h=h.parentNode){if(h.tagName=="FORM"){domUtils.on(h,"submit",function(){e(this,i)});break}}if(domUtils.isEmptyNode(i.body)){i.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>"}if(f.focus){setTimeout(function(){i.focus();!i.options.autoClearinitialContent&&i._selectionChange()},0)}if(!i.container){i.container=this.iframe.parentNode}if(f.fullscreen&&i.ui){i.ui.setFullScreen(true)}try{i.document.execCommand("2D-position",false,false)}catch(j){}try{i.document.execCommand("enableInlineTableEditing",false,false)}catch(j){}try{i.document.execCommand("enableObjectResizing",false,false)}catch(j){}i._bindshortcutKeys();i.isReady=1;i.fireEvent("ready");f.onready&&f.onready.call(i);if(!browser.ie){domUtils.on(i.window,["blur","focus"],function(m){if(m.type=="blur"){i._bakRange=i.selection.getRange();try{i.selection.getNative().removeAllRanges()}catch(m){}}else{try{i._bakRange&&i._bakRange.select()}catch(m){}}})}if(browser.gecko&&browser.version<=10902){i.body.contentEditable=false;setTimeout(function(){i.body.contentEditable=true},100);setInterval(function(){i.body.style.height=i.iframe.offsetHeight-20+"px"},100)}!f.isShow&&i.setHide();f.readonly&&i.setDisabled()},sync:function(h){var g=this,f=h?document.getElementById(h):domUtils.findParent(g.iframe.parentNode,function(i){return i.tagName=="FORM"},true);f&&e(f,g)},setHeight:function(f){if(f!==parseInt(this.iframe.parentNode.style.height)){this.iframe.parentNode.style.height=f+"px"}this.document.body.style.height=f-20+"px"},addshortcutkey:function(g,f){var h={};if(f){h[g]=f}else{h=g}utils.extend(this.shortcutkeys,h)},_bindshortcutKeys:function(){var g=this,f=this.shortcutkeys;g.addListener("keydown",function(n,m){var p=m.keyCode||m.which;for(var k in f){var l=f[k].split(",");for(var q=0,h;h=l[q++];){h=h.split(":");var o=h[0],j=h[1];if(/^(ctrl)(\+shift)?\+(\d+)$/.test(o.toLowerCase())||/^(\d+)$/.test(o)){if(((RegExp.$1=="ctrl"?(m.ctrlKey||m.metaKey):0)&&(RegExp.$2!=""?m[RegExp.$2.slice(1)+"Key"]:1)&&p==RegExp.$3)||p==RegExp.$1){g.execCommand(k,j);domUtils.preventDefault(m)}}}}})},getContent:function(i,n,f,o){var m=this;if(i&&utils.isFunction(i)){n=i;i=""}if(n?!n():!this.hasContents()){return""}var k=m.selection.getRange(),p=k.createAddress();m.fireEvent("beforegetcontent",i);var g=new RegExp(domUtils.fillChar,"g"),j=m.body.innerHTML.replace(g,"").replace(/>[\t\r\n]*?</g,"><");m.fireEvent("aftergetcontent",i);try{!o&&k.moveToAddress(p).select(true)}catch(l){}if(m.serialize){var h=m.serialize.parseHTML(j);h=m.serialize.transformOutput(h);j=m.serialize.toHTML(h)}if(ie&&f){j=j.replace(/<p>\s*?<\/p>/g,"<p>&nbsp;</p>")}else{j=j.replace(/(&nbsp;)+/g,function(t){for(var r=0,u=[],q=t.split(";").length-1;r<q;r++){u.push(r%2==0?" ":"&nbsp;")}return u.join("")})}return j},getAllHtml:function(){var h=this,g=[],f="";h.fireEvent("getAllHtml",g);if(browser.ie&&browser.version>8){var i="";utils.each(h.document.styleSheets,function(j){i+=(j.href?'<link rel="stylesheet" type="text/css" href="'+j.href+'" />':"<style>"+j.cssText+"</style>")});utils.each(h.document.getElementsByTagName("script"),function(j){i+=j.outerHTML})}return"<html><head>"+(h.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+h.options.charset+'"/>':"")+(i||h.document.getElementsByTagName("head")[0].innerHTML)+g.join("\n")+"</head><body "+(ie&&browser.version<9?'class="view"':"")+">"+h.getContent(null,null,true)+"</body></html>"},getPlainTxt:function(){var g=new RegExp(domUtils.fillChar,"g"),f=this.body.innerHTML.replace(/[\n\r]/g,"");f=f.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(i,h,j){return dtd.$block[j]?"\n":h?h:""});return f.replace(g,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){var f=new RegExp(domUtils.fillChar,"g");return this.body[browser.ie?"innerText":"textContent"].replace(f,"").replace(/\u00a0/g," ")},setContent:function(l,o,j){var q=this,n=utils.extend({a:1,A:1},dtd.$inline,true),k;l=l.replace(/^[ \t\r\n]*?</,"<").replace(/>[ \t\r\n]*?$/,">").replace(/>(?:(\s|&nbsp;)*?)</g,"><").replace(/[\s\/]?(\w+)?>[ \t\r\n]*?<\/?(\w+)/gi,function(s,p,t){if(p){k=t}else{p=k}return !n[p]&&!n[t]?s.replace(/>[ \t\r\n]*?</,"><"):s});l={html:l};q.fireEvent("beforesetcontent",l);l=l.html;var r=this.serialize;if(r){var i=r.parseHTML(l);i=r.transformInput(i);i=r.filter(i);l=r.toHTML(i)}this.body.innerHTML=(o?this.getContent():"")+l.replace(new RegExp("[\r"+domUtils.fillChar+"]*","g"),"");if(browser.ie&&browser.version<7){c(this.document.body)}if(q.options.enterTag=="p"){var g=this.body.firstChild,h;if(!g||g.nodeType==1&&(dtd.$cdata[g.tagName]||domUtils.isCustomeNode(g))&&g===this.body.lastChild){this.body.innerHTML="<p>"+(browser.ie?"&nbsp;":"<br/>")+"</p>"+this.body.innerHTML}else{var f=q.document.createElement("p");while(g){while(g&&(g.nodeType==3||g.nodeType==1&&dtd.p[g.tagName]&&!dtd.$cdata[g.tagName])){h=g.nextSibling;f.appendChild(g);g=h}if(f.firstChild){if(!g){q.body.appendChild(f);break}else{g.parentNode.insertBefore(f,g);f=q.document.createElement("p")}}g=g.nextSibling}}}q.fireEvent("aftersetcontent");q.fireEvent("contentchange");!j&&q._selectionChange();q._bakRange=q._bakIERange=null;var m;if(browser.gecko&&(m=this.selection.getNative())){m.removeAllRanges()}},focus:function(i){try{var g=this,f=g.selection.getRange();if(i){f.setStartAtLast(g.body.lastChild).setCursor(false,true)}else{f.select(true)}}catch(h){}},_initEvents:function(){var g=this,k=g.document,j=g.window;g._proxyDomEvent=utils.bind(g._proxyDomEvent,g);domUtils.on(k,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],g._proxyDomEvent);domUtils.on(j,["focus","blur"],g._proxyDomEvent);domUtils.on(k,["mouseup","keydown"],function(l){if(l.type=="keydown"&&(l.ctrlKey||l.metaKey||l.shiftKey||l.altKey)){return}if(l.button==2){return}g._selectionChange(250,l)});var f=0,h=browser.ie?g.body:g.document,i;domUtils.on(h,"dragstart",function(){f=1});domUtils.on(h,browser.webkit?"dragover":"drop",function(){return browser.webkit?function(){clearTimeout(i);i=setTimeout(function(){if(!f){var p=g.selection,l=p.getRange();if(l){var m=l.getCommonAncestor();if(m&&g.serialize){var o=g.serialize,n=o.filter(o.transformInput(o.parseHTML(o.word(m.innerHTML))));m.innerHTML=o.toHTML(n)}}}f=0},200)}:function(l){if(!f){l.preventDefault?l.preventDefault():(l.returnValue=false)}f=0}}())},_proxyDomEvent:function(f){return this.fireEvent(f.type.replace(/^on/,""),f)},_selectionChange:function(i,f){var l=this;var k=false;var j,h;if(browser.ie&&browser.version<9&&f&&f.type=="mouseup"){var g=this.selection.getRange();if(!g.collapsed){k=true;j=f.clientX;h=f.clientY}}clearTimeout(b);b=setTimeout(function(){if(!l.selection.getNative()){return}var n;if(k&&l.selection.getNative().type=="None"){n=l.document.body.createTextRange();try{n.moveToPoint(j,h)}catch(m){n=null}}var o;if(n){o=l.selection.getIERange;l.selection.getIERange=function(){return n}}l.selection.cache();if(o){l.selection.getIERange=o}if(l.selection._cachedRange&&l.selection._cachedStartElement){l.fireEvent("beforeselectionchange");l.fireEvent("selectionchange",!!f);l.fireEvent("afterselectionchange");l.selection.clear()}},i||50)},_callCmdFn:function(j,g){var f=g[0].toLowerCase(),i,h;i=this.commands[f]||UE.commands[f];h=i&&i[j];if((!i||!h)&&j=="queryCommandState"){return 0}else{if(h){return h.apply(this,g)}}},execCommand:function(g){g=g.toLowerCase();var h=this,f,i=h.commands[g]||UE.commands[g];if(!i||!i.execCommand){return null}if(!i.notNeedUndo&&!h.__hasEnterExecCommand){h.__hasEnterExecCommand=true;if(h.queryCommandState(g)!=-1){h.fireEvent("beforeexeccommand",g);f=this._callCmdFn("execCommand",arguments);!h._ignoreContentChange&&h.fireEvent("contentchange");h.fireEvent("afterexeccommand",g)}h.__hasEnterExecCommand=false}else{f=this._callCmdFn("execCommand",arguments);!h._ignoreContentChange&&h.fireEvent("contentchange")}!h._ignoreContentChange&&h._selectionChange();return f},queryCommandState:function(f){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(f){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(g){if(g){for(var j=0,h;h=g[j++];){if(this.document.getElementsByTagName(h).length>0){return true}}}if(!domUtils.isEmptyBlock(this.body)){return true}g=["div"];for(j=0;h=g[j++];){var f=domUtils.getElementsByTagName(this.document,h);for(var l=0,k;k=f[l++];){if(domUtils.isCustomeNode(k)){return true}}}return false},reset:function(){this.fireEvent("reset")},setEnabled:function(){var g=this,f;if(g.body.contentEditable=="false"){g.body.contentEditable=true;f=g.selection.getRange();try{f.moveToBookmark(g.lastBk);delete g.lastBk}catch(h){f.setStartAtFirst(g.body).collapse(true)}f.select(true);if(g.bkqueryCommandState){g.queryCommandState=g.bkqueryCommandState;delete g.bkqueryCommandState}g.fireEvent("selectionchange")}},enable:function(){return this.setEnabled()},setDisabled:function(f){var g=this;f=f?utils.isArray(f)?f:[f]:[];if(g.body.contentEditable=="true"){if(!g.lastBk){g.lastBk=g.selection.getRange().createBookmark(true)}g.body.contentEditable=false;g.bkqueryCommandState=g.queryCommandState;g.queryCommandState=function(h){if(utils.indexOf(f,h)!=-1){return g.bkqueryCommandState.apply(g,arguments)}return -1};g.fireEvent("selectionchange")}},disable:function(f){return this.setDisabled(f)},_setDefaultContent:function(){function f(){var g=this;if(g.document.getElementById("initContent")){g.body.innerHTML="<p>"+(ie?"":"<br/>")+"</p>";g.removeListener("firstBeforeExecCommand focus",f);setTimeout(function(){g.focus();g._selectionChange()},0)}}return function(g){var h=this;h.body.innerHTML='<p id="initContent">'+g+"</p>";if(browser.ie&&browser.version<7){c(h.body)}h.addListener("firstBeforeExecCommand focus",f)}}(),setShow:function(){var g=this,f=g.selection.getRange();if(g.container.style.display=="none"){try{f.moveToBookmark(g.lastBk);delete g.lastBk}catch(h){f.setStartAtFirst(g.body).collapse(true)}setTimeout(function(){f.select(true)},100);g.container.style.display=""}},show:function(){return this.setShow()},setHide:function(){var f=this;if(!f.lastBk){f.lastBk=f.selection.getRange().createBookmark(true)}f.container.style.display="none"},hide:function(){return this.setHide()},getLang:function(h){var j=UE.I18N[this.options.lang];if(!j){throw Error("not import language file")}h=(h||"").split(".");for(var g=0,f;f=h[g++];){j=j[f];if(!j){break}}return j},getContentLength:function(g,f){var k=this.getContent(false,false,false,true).length;if(g){f=(f||[]).concat(["hr","img","iframe"]);k=this.getContentTxt().replace(/[\t\r\n]+/g,"").length;for(var j=0,h;h=f[j++];){k+=this.document.getElementsByTagName(h).length}}return k}};utils.inherits(a,EventBase)})();UE.plugins.keystrokes=function(){var a=this;a.addListener("keydown",function(b,m){var g=m.keyCode||m.which,e=a.selection.getRange();if(!e.collapsed&&!(m.ctrlKey||m.metaKey||m.shiftKey||m.altKey||g==9)){var t=e.startContainer;if(domUtils.isFillChar(t)){e.setStartBefore(t)}t=e.endContainer;if(domUtils.isFillChar(t)){e.setEndAfter(t)}e.txtToElmBoundary();if(e.endContainer&&e.endContainer.nodeType==1){t=e.endContainer.childNodes[e.endOffset];if(t&&domUtils.isBr(t)){e.setEndAfter(t)}}if(e.startOffset==0){t=e.startContainer;if(domUtils.isBoundaryNode(t,"firstChild")){t=e.endContainer;if(e.endOffset==(t.nodeType==3?t.nodeValue.length:t.childNodes.length)&&domUtils.isBoundaryNode(t,"lastChild")){a.fireEvent("saveScene");a.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>";e.setStart(a.body.firstChild,0).setCursor(false,true);browser.ie&&a._selectionChange();domUtils.preventDefault(m);return}}}}if(g==8){var d,c;if(e.inFillChar()){d=e.startContainer;e.setStartBefore(d).shrinkBoundary(true).collapse(true);if(domUtils.isFillChar(d)){domUtils.remove(d)}else{d.nodeValue=d.nodeValue.replace(new RegExp("^"+domUtils.fillChar),"")}}if(d=e.getClosedNode()){a.fireEvent("saveScene");e.setStartBefore(d);domUtils.remove(d);e.setCursor();a.fireEvent("saveScene");domUtils.preventDefault(m);return}if(!browser.ie){d=domUtils.findParentByTagName(e.startContainer,"table",true);c=domUtils.findParentByTagName(e.endContainer,"table",true);if(d&&!c||!d&&c||d!==c){m.preventDefault();return}}}if(g==9){var h={ol:1,ul:1,table:1};if(a.fireEvent("tabkeydown")){domUtils.preventDefault(m);return}range=a.selection.getRange();a.fireEvent("saveScene");for(var s=0,k="",n=a.options.tabSize||4,q=a.options.tabNode||"&nbsp;";s<n;s++){k+=q}var r=a.document.createElement("span");r.innerHTML=k+domUtils.fillChar;if(range.collapsed){range.insertNode(r.cloneNode(true).firstChild).setCursor(true)}else{d=domUtils.findParent(range.startContainer,l);c=domUtils.findParent(range.endContainer,l);if(d&&c&&d===c){range.deleteContents();range.insertNode(r.cloneNode(true).firstChild).setCursor(true)}else{var f=range.createBookmark(),l=function(i){return domUtils.isBlockElm(i)&&!h[i.tagName.toLowerCase()]};range.enlarge(true);var o=range.createBookmark(),p=domUtils.getNextDomNode(o.start,false,l);while(p&&!(domUtils.getPosition(p,o.end)&domUtils.POSITION_FOLLOWING)){p.insertBefore(r.cloneNode(true).firstChild,p.firstChild);p=domUtils.getNextDomNode(p,false,l)}range.moveToBookmark(o).moveToBookmark(f).select()}}domUtils.preventDefault(m)}if(browser.gecko&&g==46){range=a.selection.getRange();if(range.collapsed){d=range.startContainer;if(domUtils.isEmptyBlock(d)){var j=d.parentNode;while(domUtils.getChildCount(j)==1&&!domUtils.isBody(j)){d=j;j=j.parentNode}if(d===j.lastChild){m.preventDefault()}return}}}});a.addListener("keyup",function(e,c){var f=c.keyCode||c.which,b;if(f==8){b=a.selection.getRange();if(b.collapsed&&domUtils.isBody(b.startContainer)){var d=domUtils.createElement(a.document,"p",{innerHTML:browser.ie?domUtils.fillChar:"<br/>"});b.insertNode(d).setStart(d,0).setCursor(false,true)}if(browser.chrome&&b.collapsed&&b.startContainer.nodeType==1&&domUtils.isEmptyBlock(b.startContainer)){b.select(true)}}})};UE.plugins.fiximgclick=function(){var a=this;if(browser.webkit){a.addListener("click",function(c,d){if(d.target.tagName=="IMG"){var b=new dom.Range(a.document);b.selectNode(d.target).select()}})}};UE.plugins.enterkey=function(){var b,c=this,a=c.options.enterTag;c.addListener("keyup",function(l,m){var n=m.keyCode||m.which;if(n==13){var k=c.selection.getRange(),g=k.startContainer,d;if(!browser.ie){if(/h\d/i.test(b)){if(browser.gecko){var j=domUtils.findParentByTagName(g,["h1","h2","h3","h4","h5","h6","blockquote","caption","table"],true);if(!j){c.document.execCommand("formatBlock",false,"<p>");d=1}}else{if(g.nodeType==1){var i=c.document.createTextNode(""),e;k.insertNode(i);e=domUtils.findParentByTagName(i,"div",true);if(e){var f=c.document.createElement("p");while(e.firstChild){f.appendChild(e.firstChild)}e.parentNode.insertBefore(f,e);domUtils.remove(e);k.setStartBefore(i).setCursor();d=1}domUtils.remove(i)}}if(c.undoManger&&d){c.undoManger.save()}}browser.opera&&k.select()}setTimeout(function(){c.selection.getRange().scrollToView(c.autoHeightEnabled,c.autoHeightEnabled?domUtils.getXY(c.iframe).y:0)},50)}});c.addListener("keydown",function(i,k){var m=k.keyCode||k.which;if(m==13){if(c.undoManger){c.undoManger.save()}b="";var f=c.selection.getRange();if(!f.collapsed){var d=f.startContainer,e=f.endContainer,g=domUtils.findParentByTagName(d,"td",true),h=domUtils.findParentByTagName(e,"td",true);if(g&&h&&g!==h||!g&&h||g&&!h){k.preventDefault?k.preventDefault():(k.returnValue=false);return}}if(a=="p"){if(!browser.ie){d=domUtils.findParentByTagName(f.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote","caption"],true);if(!d&&!browser.opera){c.document.execCommand("formatBlock",false,"<p>");if(browser.gecko){f=c.selection.getRange();d=domUtils.findParentByTagName(f.startContainer,"p",true);d&&domUtils.removeDirtyAttr(d)}}else{b=d.tagName;d.tagName.toLowerCase()=="p"&&browser.gecko&&domUtils.removeDirtyAttr(d)}}}else{k.preventDefault?k.preventDefault():(k.returnValue=false);if(!f.collapsed){f.deleteContents();d=f.startContainer;if(d.nodeType==1&&(d=d.childNodes[f.startOffset])){while(d.nodeType==1){if(dtd.$empty[d.tagName]){f.setStartBefore(d).setCursor();if(c.undoManger){c.undoManger.save()}return false}if(!d.firstChild){var l=f.document.createElement("br");d.appendChild(l);f.setStart(d,0).setCursor();if(c.undoManger){c.undoManger.save()}return false}d=d.firstChild}if(d===f.startContainer.childNodes[f.startOffset]){l=f.document.createElement("br");f.insertNode(l).setCursor()}else{f.setStart(d,0).setCursor()}}else{l=f.document.createElement("br");f.insertNode(l).setStartAfter(l).setCursor()}}else{l=f.document.createElement("br");f.insertNode(l);var j=l.parentNode;if(j.lastChild===l){l.parentNode.insertBefore(l.cloneNode(true),l);f.setStartBefore(l)}else{f.setStartAfter(l)}f.setCursor()}}}})};UE.plugins.contextmenu=function(){var c=this,e=c.getLang("contextMenu"),d,a=c.options.contextMenu||[{label:e.selectall,cmdName:"selectall"},{label:e.deletecode,cmdName:"highlightcode",icon:"deletehighlightcode"},{label:e.cleardoc,cmdName:"cleardoc",exec:function(){if(confirm(e.confirmclear)){this.execCommand("cleardoc")}}},"-",{label:e.unlink,cmdName:"unlink"},"-",{group:e.paragraph,icon:"justifyjustify",subMenu:[{label:e.justifyleft,cmdName:"justify",value:"left"},{label:e.justifyright,cmdName:"justify",value:"right"},{label:e.justifycenter,cmdName:"justify",value:"center"},{label:e.justifyjustify,cmdName:"justify",value:"justify"}]},"-",{group:e.table,icon:"table",subMenu:[{label:e.inserttable,cmdName:"inserttable"},{label:e.deletetable,cmdName:"deletetable"},"-",{label:e.deleterow,cmdName:"deleterow"},{label:e.deletecol,cmdName:"deletecol"},{label:e.insertcol,cmdName:"insertcol"},{label:e.insertcolnext,cmdName:"insertcolnext"},{label:e.insertrow,cmdName:"insertrow"},{label:e.insertrownext,cmdName:"insertrownext"},"-",{label:e.insertcaption,cmdName:"insertcaption"},{label:e.deletecaption,cmdName:"deletecaption"},{label:e.inserttitle,cmdName:"inserttitle"},{label:e.deletetitle,cmdName:"deletetitle"},"-",{label:e.mergecells,cmdName:"mergecells"},{label:e.mergeright,cmdName:"mergeright"},{label:e.mergedown,cmdName:"mergedown"},"-",{label:e.splittorows,cmdName:"splittorows"},{label:e.splittocols,cmdName:"splittocols"},{label:e.splittocells,cmdName:"splittocells"},"-",{label:e.averageDiseRow,cmdName:"averagedistributerow"},{label:e.averageDisCol,cmdName:"averagedistributecol"},"-",{label:e.edittd,cmdName:"edittd",exec:function(){if(UE.ui.edittd){new UE.ui.edittd(this)}this.getDialog("edittd").open()}},{label:e.edittable,cmdName:"edittable",exec:function(){if(UE.ui.edittable){new UE.ui.edittable(this)}this.getDialog("edittable").open()}}]},{group:e.aligntd,icon:"aligntd",subMenu:[{cmdName:"cellalignment",value:{align:"left",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"bottom"}}]},{group:e.aligntable,icon:"aligntable",subMenu:[{cmdName:"tablealignment",label:e.tableleft,value:["float","left"]},{cmdName:"tablealignment",label:e.tablecenter,value:["margin","0 auto"]},{cmdName:"tablealignment",label:e.tableright,value:["float","right"]}]},"-",{label:e.insertparagraphbefore,cmdName:"insertparagraph",value:true},{label:e.insertparagraphafter,cmdName:"insertparagraph"},{label:e.copy,cmdName:"copy",exec:function(){alert(e.copymsg)},query:function(){return 0}},{label:e.paste,cmdName:"paste",exec:function(){alert(e.pastemsg)},query:function(){return 0}},{label:e.highlightcode,cmdName:"highlightcode",exec:function(){if(UE.ui.highlightcode){new UE.ui.highlightcode(this)}this.ui._dialogs.highlightcodeDialog.open()}}];if(!a.length){return}var b=UE.ui.uiUtils;c.addListener("contextmenu",function(m,o){var h=b.getViewportOffsetByEvent(o);c.fireEvent("beforeselectionchange");if(d){d.destroy()}for(var j=0,f,p=[];f=a[j];j++){var n;(function(s){if(s=="-"){if((n=p[p.length-1])&&n!=="-"){p.push("-")}}else{if(s.hasOwnProperty("group")){for(var r=0,q,i=[];q=s.subMenu[r];r++){(function(u){if(u=="-"){if((n=i[i.length-1])&&n!=="-"){i.push("-")}else{i.splice(i.length-1)}}else{if((c.commands[u.cmdName]||UE.commands[u.cmdName]||u.query)&&(u.query?u.query():c.queryCommandState(u.cmdName))>-1){i.push({label:u.label||c.getLang("contextMenu."+u.cmdName+(u.value||""))||"",className:"edui-for-"+u.cmdName,onclick:u.exec?function(){u.exec.call(c)}:function(){c.execCommand(u.cmdName,u.value)}})}}})(q)}if(i.length){function t(){switch(s.icon){case"table":return c.getLang("contextMenu.table");case"justifyjustify":return c.getLang("contextMenu.paragraph");case"aligntd":return c.getLang("contextMenu.aligntd");case"aligntable":return c.getLang("contextMenu.aligntable");default:return""}}p.push({label:t(),className:"edui-for-"+s.icon,subMenu:{items:i,editor:c}})}}else{if((c.commands[s.cmdName]||UE.commands[s.cmdName]||s.query)&&(s.query?s.query.call(c):c.queryCommandState(s.cmdName))>-1){if(s.cmdName=="highlightcode"){if(c.queryCommandState(s.cmdName)==1&&s.icon!="deletehighlightcode"){return}if(c.queryCommandState(s.cmdName)!=1&&s.icon=="deletehighlightcode"){return}}p.push({label:s.label||c.getLang("contextMenu."+s.cmdName),className:"edui-for-"+(s.icon?s.icon:s.cmdName+(s.value||"")),onclick:s.exec?function(){s.exec.call(c)}:function(){c.execCommand(s.cmdName,s.value)}})}}}})(f)}if(p[p.length-1]=="-"){p.pop()}d=new UE.ui.Menu({items:p,editor:c});d.render();d.showAt(h);domUtils.preventDefault(o);if(browser.ie){var g;try{g=c.selection.getNative().createRange()}catch(l){return}if(g.item){var k=new dom.Range(c.document);k.selectNode(g.item(0)).select(true,true)}}})};(function(){function a(f){var d=this.document;if(d.getElementById("baidu_pastebin")){return}var c=this.selection.getRange(),b=c.createBookmark(),e=d.createElement("div");e.id="baidu_pastebin";browser.webkit&&e.appendChild(d.createTextNode(domUtils.fillChar+domUtils.fillChar));d.body.appendChild(e);b.start.style.display="";e.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+domUtils.getXY(b.start).y+"px";c.selectNodeContents(e).select(true);setTimeout(function(){if(browser.webkit){for(var g=0,h=d.querySelectorAll("#baidu_pastebin"),k;k=h[g++];){if(domUtils.isEmptyNode(k)){domUtils.remove(k)}else{e=k;break}}}try{e.parentNode.removeChild(e)}catch(j){}c.moveToBookmark(b).select(true);f(e)},0)}UE.plugins.paste=function(){var h=this;var g={flag:""};var f=h.options.pasteplain===true;var b={flag:""};h.commands.pasteplain={queryCommandState:function(){return f},execCommand:function(){f=!f|0},notNeedUndo:1};var e,i,c;function d(s){var r;if(s.firstChild){var v=domUtils.getElementsByTagName(s,"span");for(var y=0,m;m=v[y++];){if(m.id=="_baidu_cut_start"||m.id=="_baidu_cut_end"){domUtils.remove(m)}}if(browser.webkit){var t=s.querySelectorAll("div br");for(var y=0,k;k=t[y++];){var q=k.parentNode;if(q.tagName=="DIV"&&q.childNodes.length==1){q.innerHTML="<p><br/></p>";domUtils.remove(q)}}var x=s.querySelectorAll("#baidu_pastebin");for(var y=0,z;z=x[y++];){var C=h.document.createElement("p");z.parentNode.insertBefore(C,z);while(z.firstChild){C.appendChild(z.firstChild)}domUtils.remove(z)}var j=s.querySelectorAll("meta");for(var y=0,p;p=j[y++];){domUtils.remove(p)}var t=s.querySelectorAll("br");for(y=0;p=t[y++];){if(/^apple-/.test(p)){domUtils.remove(p)}}utils.each(domUtils.getElementsByTagName(s,"span",function(D){if(D.style.cssText){D.style.cssText=D.style.cssText.replace(/white-space[^;]+;/g,"");if(!D.style.cssText){domUtils.removeAttributes(D,"style");if(domUtils.hasNoAttributes(D)){return 1}}}return 0}),function(D){domUtils.remove(D,true)})}if(browser.gecko){var u=s.querySelectorAll("[_moz_dirty]");for(y=0;p=u[y++];){p.removeAttribute("_moz_dirty")}}if(!browser.ie){var o=s.querySelectorAll("span.Apple-style-span");for(var y=0,p;p=o[y++];){domUtils.remove(p,true)}}r=s.innerHTML.replace(/>(?:(\s|&nbsp;)*?)</g,"><");var A=h.serialize;if(A){try{r=UE.filterWord(r);var w=A.transformInput(A.parseHTML(r),g);w=A.filter(w,f?{whiteList:{p:{br:1,BR:1,$:{}},br:{"$":{}},div:{br:1,BR:1,"$":{}},li:{"$":{}},tr:{td:1,"$":{}},td:{"$":{}}},blackList:{style:1,script:1,object:1}}:null,!f?b:null);if(browser.webkit){var l=w.children.length,n;while((n=w.children[l-1])&&n.tag=="br"){w.children.splice(l-1,1);l=w.children.length}}r=A.toHTML(w,f);e=A.filter(w,{whiteList:{p:{br:1,BR:1,$:{}},br:{"$":{}},div:{br:1,BR:1,"$":{},table:1,ul:1,ol:1},li:{"$":{}},ul:{li:1,"$":{}},ol:{li:1,"$":{}},tr:{td:1,"$":{}},td:{"$":{}},table:{tr:1,tbody:1,td:1,"$":{}},tbody:{tr:1,td:1,"$":{}},h1:{"$":{}},h2:{"$":{}},h3:{"$":{}},h4:{"$":{}},h5:{"$":{}},h6:{"$":{}}},blackList:{style:1,script:1,object:1}});e=A.toHTML(e,true)}catch(B){}}r={html:r,txtContent:e};h.fireEvent("beforepaste",r);if(r.html){i=r.html;c=h.selection.getRange().createAddress(true);h.execCommand("insertHtml",i,true);h.fireEvent("afterpaste")}}}h.addListener("pasteTransfer",function(m,j){if(c&&e&&i&&e!=i){var k=h.selection.getRange();k.moveToAddress(c,true).deleteContents();k.select(true);h.__hasEnterExecCommand=true;var l=i;if(j===2){l=l.replace(/<(\/?)([\w\-]+)([^>]*)>/gi,function(p,o,r,q){r=r.toLowerCase();if({img:1}[r]){return p}q=q.replace(/([\w\-]*?)\s*=\s*(("([^"]*)")|('([^']*)')|([^\s>]+))/gi,function(u,s,t){if({src:1,href:1,name:1}[s.toLowerCase()]){return s+"="+t+" "}return""});if({span:1,div:1}[r]){return""}else{return"<"+o+r+" "+utils.trim(q)+">"}})}else{if(j){l=e}}h.execCommand("inserthtml",l,true);h.__hasEnterExecCommand=false;var n=h.selection.getRange().createAddress(true);c.endAddress=n.startAddress}});h.addListener("ready",function(){domUtils.on(h.body,"cut",function(){var j=h.selection.getRange();if(!j.collapsed&&h.undoManger){h.undoManger.save()}});domUtils.on(h.body,browser.ie||browser.opera?"keydown":"paste",function(j){if((browser.ie||browser.opera)&&((!j.ctrlKey&&!j.metaKey)||j.keyCode!="86")){return}a.call(h,function(k){d(k)})})})}})();var baidu=baidu||{};baidu.editor=baidu.editor||{};baidu.editor.ui={};(function(){var d=baidu.editor.browser,c=baidu.editor.dom.domUtils;var g="$EDITORUI";var f=window[g]={};var a="ID"+g;var i=0;var b=baidu.editor.ui.uiUtils={uid:function(j){return(j?j[a]||(j[a]=++i):++i)},hook:function(j,l){var k;if(j&&j._callbacks){k=j}else{k=function(){var p;if(j){p=j.apply(this,arguments)}var o=k._callbacks;var m=o.length;while(m--){var n=o[m].apply(this,arguments);if(p===undefined){p=n}}return p};k._callbacks=[]}k._callbacks.push(l);return k},createElementByHtml:function(j){var k=document.createElement("div");k.innerHTML=j;k=k.firstChild;k.parentNode.removeChild(k);return k},getViewportElement:function(){return(d.ie&&d.quirks)?document.body:document.documentElement},getClientRect:function(j){var n;try{n=j.getBoundingClientRect()}catch(m){n={left:0,top:0,height:0,width:0}}var k={left:Math.round(n.left),top:Math.round(n.top),height:Math.round(n.bottom-n.top),width:Math.round(n.right-n.left)};var l;while((l=j.ownerDocument)!==document&&(j=c.getWindow(l).frameElement)){n=j.getBoundingClientRect();k.left+=n.left;k.top+=n.top}k.bottom=k.top+k.height;k.right=k.left+k.width;return k},getViewportRect:function(){var k=b.getViewportElement();var l=(window.innerWidth||k.clientWidth)|0;var j=(window.innerHeight||k.clientHeight)|0;return{left:0,top:0,height:j,width:l,bottom:j,right:l}},setViewportOffset:function(j,m){var k;var l=b.getFixedLayer();if(j.parentNode===l){j.style.left=m.left+"px";j.style.top=m.top+"px"}else{c.setViewportOffset(j,m)}},getEventOffset:function(j){var k=j.target||j.srcElement;var l=b.getClientRect(k);var m=b.getViewportOffsetByEvent(j);return{left:m.left-l.left,top:m.top-l.top}},getViewportOffsetByEvent:function(k){var l=k.target||k.srcElement;var j=c.getWindow(l).frameElement;var n={left:k.clientX,top:k.clientY};if(j&&l.ownerDocument!==document){var m=b.getClientRect(j);n.left+=m.left;n.top+=m.top}return n},setGlobal:function(k,j){f[k]=j;return g+'["'+k+'"]'},unsetGlobal:function(j){delete f[j]},copyAttributes:function(o,n){var l=n.attributes;var j=l.length;while(j--){var m=l[j];if(m.nodeName!="style"&&m.nodeName!="class"&&(!d.ie||m.specified)){o.setAttribute(m.nodeName,m.nodeValue)}}if(n.className){c.addClass(o,n.className)}if(n.style.cssText){o.style.cssText+=";"+n.style.cssText}},removeStyle:function(k,j){if(k.style.removeProperty){k.style.removeProperty(j)}else{if(k.style.removeAttribute){k.style.removeAttribute(j)}else{throw""}}},contains:function(k,j){return k&&j&&(k===j?false:(k.contains?k.contains(j):k.compareDocumentPosition(j)&16))},startDrag:function(r,n,p){var p=p||document;var m=r.clientX;var l=r.clientY;function k(t){var s=t.clientX-m;var u=t.clientY-l;n.ondragmove(s,u);if(t.stopPropagation){t.stopPropagation()}else{t.cancelBubble=true}}if(p.addEventListener){function q(s){p.removeEventListener("mousemove",k,true);p.removeEventListener("mouseup",k,true);window.removeEventListener("mouseup",q,true);n.ondragstop()}p.addEventListener("mousemove",k,true);p.addEventListener("mouseup",q,true);window.addEventListener("mouseup",q,true);r.preventDefault()}else{var o=r.srcElement;o.setCapture();function j(){o.releaseCapture();o.detachEvent("onmousemove",k);o.detachEvent("onmouseup",j);o.detachEvent("onlosecaptrue",j);n.ondragstop()}o.attachEvent("onmousemove",k);o.attachEvent("onmouseup",j);o.attachEvent("onlosecaptrue",j);r.returnValue=false}n.ondragstart()},getFixedLayer:function(){var j=document.getElementById("edui_fixedlayer");if(j==null){j=document.createElement("div");j.id="edui_fixedlayer";document.body.appendChild(j);if(d.ie&&d.version<=8){j.style.position="absolute";h();setTimeout(e)}else{j.style.position="fixed"}j.style.left="0";j.style.top="0";j.style.width="0";j.style.height="0"}return j},makeUnselectable:function(k){if(d.opera||(d.ie&&d.version<9)){k.unselectable="on";if(k.hasChildNodes()){for(var j=0;j<k.childNodes.length;j++){if(k.childNodes[j].nodeType==1){b.makeUnselectable(k.childNodes[j])}}}}else{if(k.style.MozUserSelect!==undefined){k.style.MozUserSelect="none"}else{if(k.style.WebkitUserSelect!==undefined){k.style.WebkitUserSelect="none"}else{if(k.style.KhtmlUserSelect!==undefined){k.style.KhtmlUserSelect="none"}}}}}};function e(){var j=document.getElementById("edui_fixedlayer");b.setViewportOffset(j,{left:0,top:0})}function h(j){c.on(window,"scroll",e);c.on(window,"resize",baidu.editor.utils.defer(e,0,true))}})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,c=baidu.editor.EventBase,d=baidu.editor.ui.UIBase=function(){};d.prototype={className:"",uiName:"",initOptions:function(f){var g=this;for(var e in f){g[e]=f[e]}this.id=this.id||"edui"+b.uid()},initUIBase:function(){this._globalKey=a.unhtml(b.setGlobal(this.id,this))},render:function(n){var j=this.renderHtml();var e=b.createElementByHtml(j);var l=domUtils.getElementsByTagName(e,"*");var g="edui-"+(this.theme||this.editor.options.theme);var k=document.getElementById("edui_fixedlayer");for(var h=0,f;f=l[h++];){domUtils.addClass(f,g)}domUtils.addClass(e,g);if(k){k.className="";domUtils.addClass(k,g)}var m=this.getDom();if(m!=null){m.parentNode.replaceChild(e,m);b.copyAttributes(e,m)}else{if(typeof n=="string"){n=document.getElementById(n)}n=n||b.getFixedLayer();domUtils.addClass(n,g);n.appendChild(e)}this.postRender()},getDom:function(e){if(!e){return document.getElementById(this.id)}else{return document.getElementById(this.id+"_"+e)}},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(e){var f="edui-"+this.uiName;return(e.replace(/##/g,this.id).replace(/%%-/g,this.uiName?f+"-":"").replace(/%%/g,(this.uiName?f:"")+" "+this.className).replace(/\$\$/g,this._globalKey))},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var e=this.getDom();if(e){baidu.editor.dom.domUtils.remove(e)}b.unsetGlobal(this.id)}};a.inherits(d,c)})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.UIBase,c=baidu.editor.ui.Separator=function(d){this.initOptions(d);this.initSeparator()};c.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}};a.inherits(c,b)})();(function(){var b=baidu.editor.utils,a=baidu.editor.dom.domUtils,d=baidu.editor.ui.UIBase,c=baidu.editor.ui.uiUtils;var e=baidu.editor.ui.Mask=function(f){this.initOptions(f);this.initUIBase()};e.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var f=this;a.on(window,"resize",function(){setTimeout(function(){if(!f.isHidden()){f._fill()}})})},show:function(f){this._fill();this.getDom().style.display="";this.getDom().style.zIndex=f},hide:function(){this.getDom().style.display="none";this.getDom().style.zIndex=""},isHidden:function(){return this.getDom().style.display=="none"},_onMouseDown:function(){return false},_fill:function(){var f=this.getDom();var g=c.getViewportRect();f.style.width=g.width+"px";f.style.height=g.height+"px"}};b.inherits(e,d)})();(function(){var c=baidu.editor.utils,e=baidu.editor.ui.uiUtils,a=baidu.editor.dom.domUtils,h=baidu.editor.ui.UIBase,g=baidu.editor.ui.Popup=function(i){this.initOptions(i);this.initPopup()};var b=[];function f(j,m){var n=[];for(var l=0;l<b.length;l++){var k=b[l];if(!k.isHidden()){if(k.queryAutoHide(m)!==false){if(j&&/scroll/ig.test(j.type)&&k.className=="edui-wordpastepop"){return}k.hide()}}}}g.postHide=f;var d=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];g.prototype={SHADOW_RADIUS:5,content:null,_hidden:false,autoRender:true,canSideLeft:true,canSideUp:true,initPopup:function(){this.initUIBase();b.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="javascript:"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div> </div></div>"},getContentHtmlTpl:function(){if(this.content){if(typeof this.content=="string"){return this.content}return this.content.renderHtml()}else{return""}},_UIBase_postRender:h.prototype.postRender,postRender:function(){if(this.content instanceof h){this.content.postRender()}this.fireEvent("postRenderAfter");this.hide(true);this._UIBase_postRender()},_doAutoRender:function(){if(!this.getDom()&&this.autoRender){this.render()}},mesureSize:function(){var i=this.getDom("content");return e.getClientRect(i)},fitSize:function(){var i=this.getDom("body");i.style.width="";i.style.height="";var j=this.mesureSize();i.style.width=j.width+"px";i.style.height=j.height+"px";return j},showAnchor:function(j,i){this.showAnchorRect(e.getClientRect(j),i)},showAnchorRect:function(p,m,n){this._doAutoRender();var k=e.getViewportRect();this._show();var j=this.fitSize();var q,l,i,o;if(m){q=this.canSideLeft&&(p.right+j.width>k.right&&p.left>j.width);l=this.canSideUp&&(p.top+j.height>k.bottom&&p.bottom>j.height);i=(q?p.left-j.width:p.right);o=(l?p.bottom-j.height:p.top)}else{q=this.canSideLeft&&(p.right+j.width>k.right&&p.left>j.width);l=this.canSideUp&&(p.top+j.height>k.bottom&&p.bottom>j.height);i=(q?p.right-j.width:p.left);o=(l?p.top-j.height:p.bottom)}var r=this.getDom();e.setViewportOffset(r,{left:i,top:o});a.removeClasses(r,d);r.className+=" "+d[(l?1:0)*2+(q?1:0)];if(this.editor){r.style.zIndex=this.editor.container.style.zIndex*1+10;baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=r.style.zIndex-1}},showAt:function(l){var k=l.left;var j=l.top;var i={left:k,top:j,right:k,bottom:j,height:0,width:0};this.showAnchorRect(i,false,true)},_show:function(){if(this._hidden){var i=this.getDom();i.style.display="";this._hidden=false;this.fireEvent("show")}},isHidden:function(){return this._hidden},show:function(){this._doAutoRender();this._show()},hide:function(i){if(!this._hidden&&this.getDom()){this.getDom().style.display="none";this._hidden=true;if(!i){this.fireEvent("hide")}}},queryAutoHide:function(i){return !i||!e.contains(this.getDom(),i)}};c.inherits(g,h);a.on(document,"mousedown",function(i){var j=i.target||i.srcElement;f(i,j)});a.on(window,"scroll",function(i,j){f(i,j)})})();(function(){var a=baidu.editor.utils,c=baidu.editor.ui.UIBase,b=baidu.editor.ui.ColorPicker=function(f){this.initOptions(f);this.noColorText=this.noColorText||this.editor.getLang("clearColor");this.initUIBase()};b.prototype={getHtmlTpl:function(){return e(this.noColorText,this.editor)},_onTableClick:function(f){var h=f.target||f.srcElement;var g=h.getAttribute("data-color");if(g){this.fireEvent("pickcolor",g)}},_onTableOver:function(f){var h=f.target||f.srcElement;var g=h.getAttribute("data-color");if(g){this.getDom("preview").style.backgroundColor=g}},_onTableOut:function(){this.getDom("preview").style.backgroundColor=""},_onPickNoColor:function(){this.fireEvent("picknocolor")}};a.inherits(b,c);var d=("ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,d8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,").split(",");function e(f,j){var h='<div id="##" class="edui-colorpicker %%"><div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div><div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">'+f+'</div></div><table  class="edui-box" style="border-collapse: collapse;" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0"><tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;padding-top: 2px"><td colspan="10">'+j.getLang("themeColor")+'</td> </tr><tr class="edui-colorpicker-tablefirstrow" >';for(var g=0;g<d.length;g++){if(g&&g%10===0){h+="</tr>"+(g==60?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;"><td colspan="10">'+j.getLang("standardColor")+"</td></tr>":"")+"<tr"+(g==60?' class="edui-colorpicker-tablefirstrow"':"")+">"}h+=g<70?'<td style="padding: 0 2px;"><a hidefocus title="'+d[g]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell" data-color="#'+d[g]+'" style="background-color:#'+d[g]+";border:solid #ccc;"+(g<10||g>=60?"border-width:1px;":g>=10&&g<20?"border-width:1px 1px 0 1px;":"border-width:0 1px 0 1px;")+'"></a></td>':""}h+="</tr></table></div>";return h}})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,c=baidu.editor.ui.UIBase;var d=baidu.editor.ui.TablePicker=function(e){this.initOptions(e);this.initTablePicker()};d.prototype={defaultNumRows:10,defaultNumCols:10,maxNumRows:20,maxNumCols:20,numRows:10,numCols:10,lengthOfCellSide:22,initTablePicker:function(){this.initUIBase()},getHtmlTpl:function(){var e=this;return'<div id="##" class="edui-tablepicker %%"><div class="edui-tablepicker-body"><div class="edui-infoarea"><span id="##_label" class="edui-label"></span></div><div class="edui-pickarea" onmousemove="$$._onMouseMove(event, this);" onmouseover="$$._onMouseOver(event, this);" onmouseout="$$._onMouseOut(event, this);" onclick="$$._onClick(event, this);"><div id="##_overlay" class="edui-overlay"></div></div></div></div>'},_UIBase_render:c.prototype.render,render:function(e){this._UIBase_render(e);this.getDom("label").innerHTML="0"+this.editor.getLang("t_row")+" x 0"+this.editor.getLang("t_col")},_track:function(i,h){var f=this.getDom("overlay").style;var g=this.lengthOfCellSide;f.width=i*g+"px";f.height=h*g+"px";var e=this.getDom("label");e.innerHTML=i+this.editor.getLang("t_col")+" x "+h+this.editor.getLang("t_row");this.numCols=i;this.numRows=h},_onMouseOver:function(f,g){var e=f.relatedTarget||f.fromElement;if(!b.contains(g,e)&&g!==e){this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row");this.getDom("overlay").style.visibility=""}},_onMouseOut:function(f,g){var e=f.relatedTarget||f.toElement;if(!b.contains(g,e)&&g!==e){this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row");this.getDom("overlay").style.visibility="hidden"}},_onMouseMove:function(e,g){var f=this.getDom("overlay").style;var k=b.getEventOffset(e);var i=this.lengthOfCellSide;var j=Math.ceil(k.left/i);var h=Math.ceil(k.top/i);this._track(j,h)},_onClick:function(){this.fireEvent("picktable",this.numCols,this.numRows)}};a.inherits(d,c)})();(function(){var c=baidu.editor.browser,a=baidu.editor.dom.domUtils,b=baidu.editor.ui.uiUtils;var d='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(c.ie?(' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"'):(' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"'));baidu.editor.ui.Stateful={alwalysHoverable:false,target:null,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl;this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){var e=this._Stateful_dGetHtmlTpl();return e.replace(/stateful/g,function(){return d})},Stateful_onMouseEnter:function(e,f){this.target=f;if(!this.isDisabled()||this.alwalysHoverable){this.addState("hover");this.fireEvent("over")}},Stateful_onMouseLeave:function(e,f){if(!this.isDisabled()||this.alwalysHoverable){this.removeState("hover");this.removeState("active");this.fireEvent("out")}},Stateful_onMouseOver:function(f,g){var e=f.relatedTarget;if(!b.contains(g,e)&&g!==e){this.Stateful_onMouseEnter(f,g)}},Stateful_onMouseOut:function(f,g){var e=f.relatedTarget;if(!b.contains(g,e)&&g!==e){this.Stateful_onMouseLeave(f,g)}},Stateful_onMouseDown:function(e,f){if(!this.isDisabled()){this.addState("active")}},Stateful_onMouseUp:function(e,f){if(!this.isDisabled()){this.removeState("active")}},Stateful_postRender:function(){if(this.disabled&&!this.hasState("disabled")){this.addState("disabled")}},hasState:function(e){return a.hasClass(this.getStateDom(),"edui-state-"+e)},addState:function(e){if(!this.hasState(e)){this.getStateDom().className+=" edui-state-"+e}},removeState:function(e){if(this.hasState(e)){a.removeClasses(this.getStateDom(),["edui-state-"+e])}},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(e){if(!this.isDisabled()&&e){this.addState("checked")}else{this.removeState("checked")}},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(e){if(e){this.removeState("hover");this.removeState("checked");this.removeState("active");this.addState("disabled")}else{this.removeState("disabled")}}}})();(function(){var b=baidu.editor.utils,d=baidu.editor.ui.UIBase,c=baidu.editor.ui.Stateful,a=baidu.editor.ui.Button=function(e){this.initOptions(e);this.initButton()};a.prototype={uiName:"button",label:"",title:"",showIcon:true,showText:true,initButton:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return false;" onclick="return $$._onClick();">'+(this.showIcon?'<div class="edui-box edui-icon"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div></div></div></div>"},postRender:function(){this.Stateful_postRender();this.setDisabled(this.disabled)},_onClick:function(){if(!this.isDisabled()){this.fireEvent("click")}}};b.inherits(a,d);b.extend(a.prototype,c)})();(function(){var c=baidu.editor.utils,e=baidu.editor.ui.uiUtils,a=baidu.editor.dom.domUtils,f=baidu.editor.ui.UIBase,d=baidu.editor.ui.Stateful,b=baidu.editor.ui.SplitButton=function(g){this.initOptions(g);this.initSplitButton()};b.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){this.initUIBase();this.Stateful_init();var h=this;if(this.popup!=null){var g=this.popup;this.popup=null;this.setPopup(g)}},_UIBase_postRender:f.prototype.postRender,postRender:function(){this.Stateful_postRender();this._UIBase_postRender()},setPopup:function(g){if(this.popup===g){return}if(this.popup!=null){this.popup.dispose()}g.addListener("show",c.bind(this._onPopupShow,this));g.addListener("hide",c.bind(this._onPopupHide,this));g.addListener("postrender",c.bind(function(){g.getDom("body").appendChild(e.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(e.getClientRect(this.getDom()).width-2)+'px"></div>'));g.getDom().className+=" "+this.className},this));this.popup=g},_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body"><div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);"><div class="edui-box edui-icon"></div></div><div class="edui-box edui-splitborder"></div><div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div></div></div></div>'},showPopup:function(){var g=e.getClientRect(this.getDom());g.top-=this.popup.SHADOW_RADIUS;g.height+=this.popup.SHADOW_RADIUS;this.popup.showAnchorRect(g)},_onArrowClick:function(h,g){if(!this.isDisabled()){this.showPopup()}},_onButtonClick:function(){if(!this.isDisabled()){this.fireEvent("buttonclick")}}};c.inherits(b,f);c.extend(b.prototype,d,true)})();(function(){var b=baidu.editor.utils,c=baidu.editor.ui.uiUtils,d=baidu.editor.ui.ColorPicker,f=baidu.editor.ui.Popup,a=baidu.editor.ui.SplitButton,e=baidu.editor.ui.ColorButton=function(g){this.initOptions(g);this.initColorButton()};e.prototype={initColorButton:function(){var g=this;this.popup=new f({content:new d({noColorText:g.editor.getLang("clearColor"),editor:g.editor,onpickcolor:function(i,h){g._onPickColor(h)},onpicknocolor:function(i,h){g._onPickNoColor(h)}}),editor:g.editor});this.initSplitButton()},_SplitButton_postRender:a.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.getDom("button_body").appendChild(c.createElementByHtml('<div id="'+this.id+'_colorlump" class="edui-colorlump"></div>'));this.getDom().className+=" edui-colorbutton"},setColor:function(g){this.getDom("colorlump").style.backgroundColor=g;this.color=g},_onPickColor:function(g){if(this.fireEvent("pickcolor",g)!==false){this.setColor(g);this.popup.hide()}},_onPickNoColor:function(g){if(this.fireEvent("picknocolor")!==false){this.popup.hide()}}};b.inherits(e,a)})();(function(){var b=baidu.editor.utils,c=baidu.editor.ui.Popup,d=baidu.editor.ui.TablePicker,a=baidu.editor.ui.SplitButton,e=baidu.editor.ui.TableButton=function(f){this.initOptions(f);this.initTableButton()};e.prototype={initTableButton:function(){var f=this;this.popup=new c({content:new d({editor:f.editor,onpicktable:function(g,i,h){f._onPickTable(i,h)}}),editor:f.editor});this.initSplitButton()},_onPickTable:function(g,f){if(this.fireEvent("picktable",g,f)!==false){this.popup.hide()}}};b.inherits(e,a)})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.UIBase;var c=baidu.editor.ui.AutoTypeSetPicker=function(d){this.initOptions(d);this.initAutoTypeSetPicker()};c.prototype={initAutoTypeSetPicker:function(){this.initUIBase()},getHtmlTpl:function(){var e=this.editor,d=e.options.autotypeset,f=e.getLang("autoTypeSet");return'<div id="##" class="edui-autotypesetpicker %%"><div class="edui-autotypesetpicker-body"><table ><tr><td nowrap colspan="2"><input type="checkbox" name="mergeEmptyline" '+(d.mergeEmptyline?"checked":"")+">"+f.mergeLine+'</td><td colspan="2"><input type="checkbox" name="removeEmptyline" '+(d.removeEmptyline?"checked":"")+">"+f.delLine+'</td></tr><tr><td nowrap colspan="2"><input type="checkbox" name="removeClass" '+(d.removeClass?"checked":"")+">"+f.removeFormat+'</td><td colspan="2"><input type="checkbox" name="indent" '+(d.indent?"checked":"")+">"+f.indent+'</td></tr><tr><td nowrap colspan="2"><input type="checkbox" name="textAlign" '+(d.textAlign?"checked":"")+">"+f.alignment+'</td><td colspan="2" id="textAlignValue"><input type="radio" name="textAlignValue" value="left" '+((d.textAlign&&d.textAlign=="left")?"checked":"")+">"+e.getLang("justifyleft")+'<input type="radio" name="textAlignValue" value="center" '+((d.textAlign&&d.textAlign=="center")?"checked":"")+">"+e.getLang("justifycenter")+'<input type="radio" name="textAlignValue" value="right" '+((d.textAlign&&d.textAlign=="right")?"checked":"")+">"+e.getLang("justifyright")+' </tr><tr><td nowrap colspan="2"><input type="checkbox" name="imageBlockLine" '+(d.imageBlockLine?"checked":"")+">"+f.imageFloat+'</td><td nowrap colspan="2" id="imageBlockLineValue"><input type="radio" name="imageBlockLineValue" value="none" '+((d.imageBlockLine&&d.imageBlockLine=="none")?"checked":"")+">"+e.getLang("default")+'<input type="radio" name="imageBlockLineValue" value="left" '+((d.imageBlockLine&&d.imageBlockLine=="left")?"checked":"")+">"+e.getLang("justifyleft")+'<input type="radio" name="imageBlockLineValue" value="center" '+((d.imageBlockLine&&d.imageBlockLine=="center")?"checked":"")+">"+e.getLang("justifycenter")+'<input type="radio" name="imageBlockLineValue" value="right" '+((d.imageBlockLine&&d.imageBlockLine=="right")?"checked":"")+">"+e.getLang("justifyright")+'</tr><tr><td nowrap colspan="2"><input type="checkbox" name="clearFontSize" '+(d.clearFontSize?"checked":"")+">"+f.removeFontsize+'</td><td colspan="2"><input type="checkbox" name="clearFontFamily" '+(d.clearFontFamily?"checked":"")+">"+f.removeFontFamily+'</td></tr><tr><td nowrap colspan="4"><input type="checkbox" name="removeEmptyNode" '+(d.removeEmptyNode?"checked":"")+">"+f.removeHtml+'</td></tr><tr><td nowrap colspan="4"><input type="checkbox" name="pasteFilter" '+(d.pasteFilter?"checked":"")+">"+f.pasteFilter+'</td></tr><tr><td nowrap colspan="4" align="right"><button >'+f.run+"</button></td></tr></table></div></div>"},_UIBase_render:b.prototype.render};a.inherits(c,b)})();(function(){var b=baidu.editor.utils,d=baidu.editor.ui.Popup,e=baidu.editor.ui.AutoTypeSetPicker,a=baidu.editor.ui.SplitButton,f=baidu.editor.ui.AutoTypeSetButton=function(g){this.initOptions(g);this.initAutoTypeSetButton()};function c(r){var h=r.editor.options.autotypeset,v=r.getDom(),p=domUtils.getElementsByTagName(v,"input");for(var m=p.length-1,u;u=p[m--];){if(u.getAttribute("type")=="checkbox"){var s=u.getAttribute("name");h[s]&&delete h[s];if(u.checked){var n=document.getElementById(s+"Value");if(n){if(/input/ig.test(n.tagName)){h[s]=n.value}else{var g=n.getElementsByTagName("input");for(var k=g.length-1,t;t=g[k--];){if(t.checked){h[s]=t.value;break}}}}else{h[s]=true}}}}var q=domUtils.getElementsByTagName(v,"select");for(var m=0,l;l=q[m++];){var o=l.getAttribute("name");h[o]=h[o]?l.value:""}r.editor.options.autotypeset=h}f.prototype={initAutoTypeSetButton:function(){var h=this;this.popup=new d({content:new e({editor:h.editor}),editor:h.editor,hide:function(){if(!this._hidden&&this.getDom()){c(this);this.getDom().style.display="none";this._hidden=true;this.fireEvent("hide")}}});var g=0;this.popup.addListener("postRenderAfter",function(){var j=this;if(g){return}var i=this.getDom(),k=i.getElementsByTagName("button")[0];k.onclick=function(){c(j);h.editor.execCommand("autotypeset");j.hide()};g=1});this.initSplitButton()}};b.inherits(f,a)})();(function(){var a=baidu.editor.utils,e=baidu.editor.ui.Popup,c=baidu.editor.ui.Stateful,d=baidu.editor.ui.UIBase;var b=baidu.editor.ui.CellAlignPicker=function(f){this.initOptions(f);this.initCellAlignPicker()};b.prototype={initCellAlignPicker:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){return'<div id="##" class="edui-cellalignpicker %%"><div class="edui-cellalignpicker-body"><table onclick="$$._onClick(event);"><tr><td index="0" stateful><div class="edui-icon edui-left"></div></td><td index="1" stateful><div class="edui-icon edui-center"></div></td><td index="2" stateful><div class="edui-icon edui-right"></div></td></tr><tr><td index="3" stateful><div class="edui-icon edui-left"></div></td><td index="4" stateful><div class="edui-icon edui-center"></div></td><td index="5" stateful><div class="edui-icon edui-right"></div></td></tr><tr><td index="6" stateful><div class="edui-icon edui-left"></div></td><td index="7" stateful><div class="edui-icon edui-center"></div></td><td index="8" stateful><div class="edui-icon edui-right"></div></td></tr></table></div></div>'},getStateDom:function(){return this.target},_onClick:function(f){var g=f.target||f.srcElement;if(/icon/.test(g.className)){this.items[g.parentNode.getAttribute("index")].onclick();e.postHide(f)}},_UIBase_render:d.prototype.render};a.inherits(b,d);a.extend(b.prototype,c,true)})();(function(){var a=baidu.editor.utils,c=baidu.editor.ui.Stateful,b=baidu.editor.ui.uiUtils,e=baidu.editor.ui.UIBase;var d=baidu.editor.ui.PastePicker=function(f){this.initOptions(f);this.initPastePicker()};d.prototype={initPastePicker:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){return'<div class="edui-pasteicon" onclick="$$._onClick(this)"></div><div class="edui-pastecontainer"><div class="edui-title">'+this.editor.getLang("pasteOpt")+'</div><div class="edui-button"><div title="'+this.editor.getLang("pasteSourceFormat")+'" onclick="$$.format(false)" stateful><div class="edui-richtxticon"></div></div><div title="'+this.editor.getLang("tagFormat")+'" onclick="$$.format(2)" stateful><div class="edui-tagicon"></div></div><div title="'+this.editor.getLang("pasteTextFormat")+'" onclick="$$.format(true)" stateful><div class="edui-plaintxticon"></div></div></div></div></div>'},getStateDom:function(){return this.target},format:function(f){this.editor.ui._isTransfer=true;this.editor.fireEvent("pasteTransfer",f)},_onClick:function(i){var g=domUtils.getNextDomNode(i),f=b.getViewportRect().height,h=b.getClientRect(g);if((h.top+h.height)>f){g.style.top=(-h.height-i.offsetHeight)+"px"}else{g.style.top=""}if(/hidden/ig.test(domUtils.getComputedStyle(g,"visibility"))){g.style.visibility="visible";domUtils.addClass(i,"edui-state-opened")}else{g.style.visibility="hidden";domUtils.removeClasses(i,"edui-state-opened")}},_UIBase_render:e.prototype.render};a.inherits(d,e);a.extend(d.prototype,c,true)})();(function(){var a=baidu.editor.utils,b=baidu.editor.ui.uiUtils,d=baidu.editor.ui.UIBase,c=baidu.editor.ui.Toolbar=function(e){this.initOptions(e);this.initToolbar()};c.prototype={items:null,initToolbar:function(){this.items=this.items||[];this.initUIBase()},add:function(e){this.items.push(e)},getHtmlTpl:function(){var f=[];for(var e=0;e<this.items.length;e++){f[e]=this.items[e].renderHtml()}return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+f.join("")+"</div>"},postRender:function(){var f=this.getDom();for(var e=0;e<this.items.length;e++){this.items[e].postRender()}b.makeUnselectable(f)},_onMouseDown:function(){return false}};a.inherits(c,d)})();(function(){var h=baidu.editor.utils,d=baidu.editor.dom.domUtils,b=baidu.editor.ui.uiUtils,c=baidu.editor.ui.UIBase,i=baidu.editor.ui.Popup,a=baidu.editor.ui.Stateful,j=baidu.editor.ui.CellAlignPicker,e=baidu.editor.ui.Menu=function(k){this.initOptions(k);this.initMenu()};var f={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'},postRender:function(){},queryAutoHide:function(){return true}};e.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[];this.initPopup();this.initItems()},initItems:function(){for(var k=0;k<this.items.length;k++){var l=this.items[k];if(l=="-"){this.items[k]=this.getSeparator()}else{if(!(l instanceof g)){l.editor=this.editor;l.theme=this.editor.options.theme;this.items[k]=this.createItem(l)}}}},getSeparator:function(){return f},createItem:function(k){return new g(k)},_Popup_getContentHtmlTpl:i.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){if(this.items.length==0){return this._Popup_getContentHtmlTpl()}var m=[];for(var k=0;k<this.items.length;k++){var l=this.items[k];m[k]=l.renderHtml()}return('<div class="%%-body">'+m.join("")+"</div>")},_Popup_postRender:i.prototype.postRender,postRender:function(){var m=this;for(var k=0;k<this.items.length;k++){var l=this.items[k];l.ownerMenu=this;l.postRender()}d.on(this.getDom(),"mouseover",function(o){o=o||event;var n=o.relatedTarget||o.fromElement;var p=m.getDom();if(!b.contains(p,n)&&p!==n){m.fireEvent("over")}});this._Popup_postRender()},queryAutoHide:function(l){if(l){if(b.contains(this.getDom(),l)){return false}for(var k=0;k<this.items.length;k++){var m=this.items[k];if(m.queryAutoHide(l)===false){return false}}}},clearItems:function(){for(var k=0;k<this.items.length;k++){var l=this.items[k];clearTimeout(l._showingTimer);clearTimeout(l._closingTimer);if(l.subMenu){l.subMenu.destroy()}}this.items=[]},destroy:function(){if(this.getDom()){d.remove(this.getDom())}this.clearItems()},dispose:function(){this.destroy()}};h.inherits(e,i);var g=baidu.editor.ui.MenuItem=function(k){this.initOptions(k);this.initUIBase();this.Stateful_init();if(this.subMenu&&!(this.subMenu instanceof e)){if(k.className&&k.className.indexOf("aligntd")!=-1){var l=this;this.subMenu=new i({content:new j(this.subMenu),parentMenu:l,editor:l.editor,destroy:function(){if(this.getDom()){d.remove(this.getDom())}}});this.subMenu.addListener("postRenderAfter",function(){d.on(this.getDom(),"mouseover",function(){l.addState("opened")})})}else{this.subMenu=new e(this.subMenu)}}};g.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:true,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div></div>"},postRender:function(){var k=this;this.addListener("over",function(){k.ownerMenu.fireEvent("submenuover",k);if(k.subMenu){k.delayShowSubMenu()}});if(this.subMenu){this.getDom().className+=" edui-hassubmenu";this.subMenu.render();this.addListener("out",function(){k.delayHideSubMenu()});this.subMenu.addListener("over",function(){clearTimeout(k._closingTimer);k._closingTimer=null;k.addState("opened")});this.ownerMenu.addListener("hide",function(){k.hideSubMenu()});this.ownerMenu.addListener("submenuover",function(m,l){if(l!==k){k.delayHideSubMenu()}});this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide;this.subMenu.queryAutoHide=function(l){if(l&&b.contains(k.getDom(),l)){return false}return this._bakQueryAutoHide(l)}}this.getDom().style.tabIndex="-1";b.makeUnselectable(this.getDom());this.Stateful_postRender()},delayShowSubMenu:function(){var k=this;if(!k.isDisabled()){k.addState("opened");clearTimeout(k._showingTimer);clearTimeout(k._closingTimer);k._closingTimer=null;k._showingTimer=setTimeout(function(){k.showSubMenu()},250)}},delayHideSubMenu:function(){var k=this;if(!k.isDisabled()){k.removeState("opened");clearTimeout(k._showingTimer);if(!k._closingTimer){k._closingTimer=setTimeout(function(){if(!k.hasState("opened")){k.hideSubMenu()}k._closingTimer=null},400)}}},renderLabelHtml:function(){return'<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(k){if(this.subMenu&&this.hasState("opened")){return this.subMenu.queryAutoHide(k)}},_onClick:function(k,l){if(this.hasState("disabled")){return}if(this.fireEvent("click",k,l)!==false){if(this.subMenu){this.showSubMenu()}else{i.postHide(k)}}},showSubMenu:function(){var k=b.getClientRect(this.getDom());k.right-=5;k.left+=2;k.width-=7;k.top-=4;k.bottom+=4;k.height+=8;this.subMenu.showAnchorRect(k,true,true)},hideSubMenu:function(){this.subMenu.hide()}};h.inherits(g,c);h.extend(g.prototype,a,true)})();(function(){var b=baidu.editor.utils,d=baidu.editor.ui.uiUtils,e=baidu.editor.ui.Menu,a=baidu.editor.ui.SplitButton,c=baidu.editor.ui.Combox=function(f){this.initOptions(f);this.initCombox()};c.prototype={uiName:"combox",initCombox:function(){var h=this;this.items=this.items||[];for(var f=0;f<this.items.length;f++){var g=this.items[f];g.uiName="listitem";g.index=f;g.onclick=function(){h.selectByIndex(this.index)}}this.popup=new e({items:this.items,uiName:"list",editor:this.editor});this.initSplitButton()},_SplitButton_postRender:a.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.setLabel(this.label||"");this.setValue(this.initValue||"")},showPopup:function(){var f=d.getClientRect(this.getDom());f.top+=1;f.bottom-=1;f.height-=2;this.popup.showAnchorRect(f)},getValue:function(){return this.value},setValue:function(g){var f=this.indexByValue(g);if(f!=-1){this.selectedIndex=f;this.setLabel(this.items[f].label);this.value=this.items[f].value}else{this.selectedIndex=-1;this.setLabel(this.getLabelForUnknowValue(g));this.value=g}},setLabel:function(f){this.getDom("button_body").innerHTML=f;this.label=f},getLabelForUnknowValue:function(f){return f},indexByValue:function(g){for(var f=0;f<this.items.length;f++){if(g==this.items[f].value){return f}}return -1},getItem:function(f){return this.items[f]},selectByIndex:function(f){if(f<this.items.length&&this.fireEvent("select",f)!==false){this.selectedIndex=f;this.value=this.items[f].value;this.setLabel(this.items[f].label)}}};b.inherits(c,a)})();(function(){var h=baidu.editor.utils,d=baidu.editor.dom.domUtils,a=baidu.editor.ui.uiUtils,e=baidu.editor.ui.Mask,b=baidu.editor.ui.UIBase,f=baidu.editor.ui.Button,g=baidu.editor.ui.Dialog=function(j){this.initOptions(h.extend({autoReset:true,draggable:true,onok:function(){},oncancel:function(){},onclose:function(l,k){return k?this.onok():this.oncancel()}},j));this.initDialog()};var c;var i;g.prototype={draggable:false,uiName:"dialog",initDialog:function(){var k=this,l=this.editor.options.theme;this.initUIBase();this.modalMask=(c||(c=new e({className:"edui-dialog-modalmask",theme:l})));this.dragMask=(i||(i=new e({className:"edui-dialog-dragmask",theme:l})));this.closeButton=new f({className:"edui-dialog-closebutton",title:k.closeDialog,theme:l,onclick:function(){k.close(false)}});if(this.buttons){for(var j=0;j<this.buttons.length;j++){if(!(this.buttons[j] instanceof f)){this.buttons[j]=new f(this.buttons[j])}}}},fitSize:function(){var j=this.getDom("body");var k=this.mesureSize();j.style.width=k.width+"px";j.style.height=k.height+"px";return k},safeSetOffset:function(p){var l=this;var j=l.getDom();var o=a.getViewportRect();var k=a.getClientRect(j);var n=p.left;if(n+k.width>o.right){n=o.right-k.width}var m=p.top;if(m+k.height>o.bottom){m=o.bottom-k.height}j.style.left=Math.max(n,0)+"px";j.style.top=Math.max(m,0)+"px"},showAtCenter:function(){this.getDom().style.display="";var o=a.getViewportRect();var j=this.fitSize();var n=this.getDom("titlebar").offsetHeight|0;var m=o.width/2-j.width/2;var l=o.height/2-(j.height-n)/2-n;var k=this.getDom();this.safeSetOffset({left:Math.max(m|0,0),top:Math.max(l|0,0)});if(!d.hasClass(k,"edui-state-centered")){k.className+=" edui-state-centered"}this._show()},getContentHtml:function(){var j="";if(typeof this.content=="string"){j=this.content}else{if(this.iframeUrl){j='<span id="'+this.id+'_contmask" class="dialogcontmask"></span><iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>'}}return j},getHtmlTpl:function(){var k="";if(this.buttons){var l=[];for(var j=0;j<this.buttons.length;j++){l[j]=this.buttons[j].renderHtml()}k='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+l.join("")+"</div></div>"}return'<div id="##" class="%%"><div class="%%-wrap"><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+(this.title||"")+"</span></div>"+this.closeButton.renderHtml()+'</div><div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"</div>"+k+"</div></div></div>"},postRender:function(){if(!this.modalMask.getDom()){this.modalMask.render();this.modalMask.hide()}if(!this.dragMask.getDom()){this.dragMask.render();this.dragMask.hide()}var k=this;this.addListener("show",function(){k.modalMask.show(this.getDom().style.zIndex-2)});this.addListener("hide",function(){k.modalMask.hide()});if(this.buttons){for(var j=0;j<this.buttons.length;j++){this.buttons[j].postRender()}}d.on(window,"resize",function(){setTimeout(function(){if(!k.isHidden()){k.safeSetOffset(a.getClientRect(k.getDom()))}})});this._hide()},mesureSize:function(){var j=this.getDom("body");var k=a.getClientRect(this.getDom("content")).width;var l=j.style;l.width=k;return a.getClientRect(j)},_onTitlebarMouseDown:function(j,k){if(this.draggable){var m;var n=a.getViewportRect();var l=this;a.startDrag(j,{ondragstart:function(){m=a.getClientRect(l.getDom());l.getDom("contmask").style.visibility="visible";l.dragMask.show(l.getDom().style.zIndex-1)},ondragmove:function(o,r){var q=m.left+o;var p=m.top+r;l.safeSetOffset({left:q,top:p})},ondragstop:function(){l.getDom("contmask").style.visibility="hidden";d.removeClasses(l.getDom(),["edui-state-centered"]);l.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml()},_show:function(){if(this._hidden){this.getDom().style.display="";this.editor.container.style.zIndex&&(this.getDom().style.zIndex=this.editor.container.style.zIndex*1+10);this._hidden=false;this.fireEvent("show");baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=this.getDom().style.zIndex-4}},isHidden:function(){return this._hidden},_hide:function(){if(!this._hidden){this.getDom().style.display="none";this.getDom().style.zIndex="";this._hidden=true;this.fireEvent("hide")}},open:function(){if(this.autoReset){try{this.reset()}catch(k){this.render();this.open()}}this.showAtCenter();if(this.iframeUrl){try{this.getDom("iframe").focus()}catch(j){}}},_onCloseButtonClick:function(j,k){this.close(false)},close:function(j){if(this.fireEvent("close",j)!==false){this._hide()}}};h.inherits(g,b)})();(function(){var b=baidu.editor.utils,c=baidu.editor.ui.Menu,a=baidu.editor.ui.SplitButton,d=baidu.editor.ui.MenuButton=function(e){this.initOptions(e);this.initMenuButton()};d.prototype={initMenuButton:function(){var e=this;this.uiName="menubutton";this.popup=new c({items:e.items,className:e.className,editor:e.editor});this.popup.addListener("show",function(){var g=this;for(var f=0;f<g.items.length;f++){g.items[f].removeState("checked");if(g.items[f].value==e._value){g.items[f].addState("checked");this.value=e._value}}});this.initSplitButton()},setValue:function(e){this._value=e}};b.inherits(d,a)})();(function(){var o=baidu.editor.utils;var k=baidu.editor.ui;var e=k.Dialog;k.buttons={};k.Dialog=function(i){var l=new e(i);l.addListener("hide",function(){if(l.editor){var u=l.editor;try{if(browser.gecko){var v=u.window.scrollY,p=u.window.scrollX;u.body.focus();u.window.scrollTo(p,v)}else{u.focus()}}catch(r){}}});return l};var f={anchor:"~/dialogs/anchor/anchor.html",insertimage:"~/dialogs/image/image.html",link:"~/dialogs/link/link.html",spechars:"~/dialogs/spechars/spechars.html",searchreplace:"~/dialogs/searchreplace/searchreplace.html",map:"~/dialogs/map/map.html",gmap:"~/dialogs/gmap/gmap.html",insertvideo:"~/dialogs/video/video.html",help:"~/dialogs/help/help.html",highlightcode:"~/dialogs/highlightcode/highlightcode.html",emotion:"~/dialogs/emotion/emotion.html",wordimage:"~/dialogs/wordimage/wordimage.html",attachment:"~/dialogs/attachment/attachment.html",insertframe:"~/dialogs/insertframe/insertframe.html",edittip:"~/dialogs/table/edittip.html",edittable:"~/dialogs/table/edittable.html",edittd:"~/dialogs/table/edittd.html",webapp:"~/dialogs/webapp/webapp.html",snapscreen:"~/dialogs/snapscreen/snapscreen.html",scrawl:"~/dialogs/scrawl/scrawl.html",music:"~/dialogs/music/music.html",template:"~/dialogs/template/template.html",background:"~/dialogs/background/background.html"};var j=["undo","redo","formatmatch","bold","italic","underline","touppercase","tolowercase","strikethrough","subscript","superscript","source","indent","outdent","blockquote","pasteplain","pagebreak","selectall","print","preview","horizontal","removeformat","time","date","unlink","insertparagraphbeforetable","insertrow","insertcol","mergeright","mergedown","deleterow","deletecol","splittorows","splittocols","splittocells","mergecells","deletetable"];for(var g=0,t;t=j[g++];){t=t.toLowerCase();k[t]=function(i){return function(l){var p=new k.Button({className:"edui-for-"+i,title:l.options.labelMap[i]||l.getLang("labelMap."+i)||"",onclick:function(){l.execCommand(i)},theme:l.options.theme,showText:false});k.buttons[i]=p;l.addListener("selectionchange",function(u,r,w){var v=l.queryCommandState(i);if(v==-1){p.setDisabled(true);p.setChecked(false)}else{if(!w){p.setDisabled(false);p.setChecked(v)}}});return p}}(t)}k.cleardoc=function(i){var l=new k.Button({className:"edui-for-cleardoc",title:i.options.labelMap.cleardoc||i.getLang("labelMap.cleardoc")||"",theme:i.options.theme,onclick:function(){if(confirm(i.getLang("confirmClear"))){i.execCommand("cleardoc")}}});k.buttons.cleardoc=l;i.addListener("selectionchange",function(){l.setDisabled(i.queryCommandState("cleardoc")==-1)});return l};var n={justify:["left","right","center","justify"],imagefloat:["none","left","center","right"],directionality:["ltr","rtl"]};for(var b in n){(function(r,u){for(var p=0,l;l=u[p++];){(function(i){k[r.replace("float","")+i]=function(v){var w=new k.Button({className:"edui-for-"+r.replace("float","")+i,title:v.options.labelMap[r.replace("float","")+i]||v.getLang("labelMap."+r.replace("float","")+i)||"",theme:v.options.theme,onclick:function(){v.execCommand(r,i)}});k.buttons[r]=w;v.addListener("selectionchange",function(y,x,z){w.setDisabled(v.queryCommandState(r)==-1);w.setChecked(v.queryCommandValue(r)==i&&!z)});return w}})(l)}})(b,n[b])}for(var g=0,t;t=["backcolor","forecolor"][g++];){k[t]=function(i){return function(l){var p=new k.ColorButton({className:"edui-for-"+i,color:"default",title:l.options.labelMap[i]||l.getLang("labelMap."+i)||"",editor:l,onpickcolor:function(u,r){l.execCommand(i,r)},onpicknocolor:function(){l.execCommand(i,"default");this.setColor("transparent");this.color="default"},onbuttonclick:function(){l.execCommand(i,this.color)}});k.buttons[i]=p;l.addListener("selectionchange",function(){p.setDisabled(l.queryCommandState(i)==-1)});return p}}(t)}var h={noOk:["searchreplace","help","spechars","webapp"],ok:["attachment","anchor","link","insertimage","map","gmap","insertframe","wordimage","insertvideo","highlightcode","insertframe","edittip","edittable","edittd","scrawl","template","music","background"]};for(var b in h){(function(r,u){for(var p=0,l;l=u[p++];){if(browser.opera&&l==="searchreplace"){continue}(function(i){k[i]=function(x,w,z){w=w||(x.options.iframeUrlMap||{})[i]||f[i];z=x.options.labelMap[i]||x.getLang("labelMap."+i)||"";var v;if(w){v=new k.Dialog(o.extend({iframeUrl:x.ui.mapUrl(w),editor:x,className:"edui-for-"+i,title:z,closeDialog:x.getLang("closeDialog")},r=="ok"?{buttons:[{className:"edui-okbutton",label:x.getLang("ok"),editor:x,onclick:function(){v.close(true)}},{className:"edui-cancelbutton",label:x.getLang("cancel"),editor:x,onclick:function(){v.close(false)}}]}:{}));x.ui._dialogs[i+"Dialog"]=v}var y=new k.Button({className:"edui-for-"+i,title:z,onclick:function(){if(v){switch(i){case"wordimage":x.execCommand("wordimage","word_img");if(x.word_img){v.render();v.open()}break;case"scrawl":if(x.queryCommandState("scrawl")!=-1){v.render();v.open()}break;default:v.render();v.open()}}},theme:x.options.theme,disabled:i=="scrawl"&&x.queryCommandState("scrawl")==-1});k.buttons[i]=y;x.addListener("selectionchange",function(){var A={edittable:1};if(i in A){return}var B=x.queryCommandState(i);if(y.getDom()){y.setDisabled(B==-1);y.setChecked(B)}});return y}})(l.toLowerCase())}})(b,h[b])}k.snapscreen=function(p,l,u){u=p.options.labelMap.snapscreen||p.getLang("labelMap.snapscreen")||"";var r=new k.Button({className:"edui-for-snapscreen",title:u,onclick:function(){p.execCommand("snapscreen")},theme:p.options.theme});k.buttons.snapscreen=r;l=l||(p.options.iframeUrlMap||{})["snapscreen"]||f.snapscreen;if(l){var i=new k.Dialog({iframeUrl:p.ui.mapUrl(l),editor:p,className:"edui-for-snapscreen",title:u,buttons:[{className:"edui-okbutton",label:p.getLang("ok"),editor:p,onclick:function(){i.close(true)}},{className:"edui-cancelbutton",label:p.getLang("cancel"),editor:p,onclick:function(){i.close(false)}}]});i.render();p.ui._dialogs.snapscreenDialog=i}p.addListener("selectionchange",function(){r.setDisabled(p.queryCommandState("snapscreen")==-1)});return r};k.fontfamily=function(u,w,y){w=u.options.fontfamily||[];y=u.options.labelMap.fontfamily||u.getLang("labelMap.fontfamily")||"";if(!w.length){return}for(var r=0,p,l=[];p=w[r];r++){var x=u.getLang("fontfamily")[p.name]||"";(function(i,z){l.push({label:i,value:z,theme:u.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+o.unhtml(this.value)+'">'+(this.label||"")+"</div>"}})})(p.label||x,p.val)}var v=new k.Combox({editor:u,items:l,onselect:function(z,i){u.execCommand("FontFamily",this.items[i].value)},onbuttonclick:function(){this.showPopup()},title:y,initValue:y,className:"edui-for-fontfamily",indexByValue:function(B){if(B){for(var A=0,z;z=this.items[A];A++){if(z.value.indexOf(B)!=-1){return A}}}return -1}});k.buttons.fontfamily=v;u.addListener("selectionchange",function(z,i,C){if(!C){var B=u.queryCommandState("FontFamily");if(B==-1){v.setDisabled(true)}else{v.setDisabled(false);var A=u.queryCommandValue("FontFamily");A&&(A=A.replace(/['"]/g,"").split(",")[0]);v.setValue(A)}}});return v};k.fontsize=function(u,w,x){x=u.options.labelMap.fontsize||u.getLang("labelMap.fontsize")||"";w=w||u.options.fontsize||[];if(!w.length){return}var l=[];for(var r=0;r<w.length;r++){var p=w[r]+"px";l.push({label:p,value:p,theme:u.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="line-height:1;font-size:'+this.value+'">'+(this.label||"")+"</div>"}})}var v=new k.Combox({editor:u,items:l,title:x,initValue:x,onselect:function(y,i){u.execCommand("FontSize",this.items[i].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"});k.buttons.fontsize=v;u.addListener("selectionchange",function(y,i,A){if(!A){var z=u.queryCommandState("FontSize");if(z==-1){v.setDisabled(true)}else{v.setDisabled(false);v.setValue(u.queryCommandValue("FontSize"))}}});return v};k.paragraph=function(r,v,w){w=r.options.labelMap.paragraph||r.getLang("labelMap.paragraph")||"";v=r.options.paragraph||[];if(o.isEmptyObject(v)){return}var l=[];for(var p in v){l.push({value:p,label:v[p]||r.getLang("paragraph")[p],theme:r.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"</span></div>"}})}var u=new k.Combox({editor:r,items:l,title:w,initValue:w,className:"edui-for-paragraph",onselect:function(x,i){r.execCommand("Paragraph",this.items[i].value)},onbuttonclick:function(){this.showPopup()}});k.buttons.paragraph=u;r.addListener("selectionchange",function(y,x,B){if(!B){var A=r.queryCommandState("Paragraph");if(A==-1){u.setDisabled(true)}else{u.setDisabled(false);var z=r.queryCommandValue("Paragraph");var i=u.indexByValue(z);if(i!=-1){u.setValue(z)}else{u.setValue(u.initValue)}}}});return u};k.customstyle=function(v){var x=v.options.customstyle||[],y=v.options.labelMap.customstyle||v.getLang("labelMap.customstyle")||"";if(!x.length){return}var u=v.getLang("customstyle");for(var r=0,l=[],p;p=x[r++];){(function(z){var i={};i.label=z.label?z.label:u[z.name];i.style=z.style;i.className=z.className;i.tag=z.tag;l.push({label:i.label,value:i,theme:v.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+i.tag+" "+(i.className?' class="'+i.className+'"':"")+(i.style?' style="'+i.style+'"':"")+">"+i.label+"</"+i.tag+"></div>"}})})(p)}var w=new k.Combox({editor:v,items:l,title:y,initValue:y,className:"edui-for-customstyle",onselect:function(z,i){v.execCommand("customstyle",this.items[i].value)},onbuttonclick:function(){this.showPopup()},indexByValue:function(B){for(var z=0,A;A=this.items[z++];){if(A.label==B){return z-1}}return -1}});k.buttons.customstyle=w;v.addListener("selectionchange",function(A,z,D){if(!D){var C=v.queryCommandState("customstyle");if(C==-1){w.setDisabled(true)}else{w.setDisabled(false);var B=v.queryCommandValue("customstyle");var i=w.indexByValue(B);if(i!=-1){w.setValue(B)}else{w.setValue(w.initValue)}}}});return w};k.inserttable=function(l,i,r){r=l.options.labelMap.inserttable||l.getLang("labelMap.inserttable")||"";var p=new k.TableButton({editor:l,title:r,className:"edui-for-inserttable",onpicktable:function(u,w,v){l.execCommand("InsertTable",{numRows:v,numCols:w,border:1})},onbuttonclick:function(){this.showPopup()}});k.buttons.inserttable=p;l.addListener("selectionchange",function(){p.setDisabled(l.queryCommandState("inserttable")==-1)});return p};k.lineheight=function(u){var w=u.options.lineheight||[];if(!w.length){return}for(var r=0,p,l=[];p=w[r++];){l.push({label:p,value:p,theme:u.options.theme,onclick:function(){u.execCommand("lineheight",this.value)}})}var v=new k.MenuButton({editor:u,className:"edui-for-lineheight",title:u.options.labelMap.lineheight||u.getLang("labelMap.lineheight")||"",items:l,onbuttonclick:function(){var i=u.queryCommandValue("LineHeight")||this.value;u.execCommand("LineHeight",i)}});k.buttons.lineheight=v;u.addListener("selectionchange",function(){var x=u.queryCommandState("LineHeight");if(x==-1){v.setDisabled(true)}else{v.setDisabled(false);var i=u.queryCommandValue("LineHeight");i&&v.setValue((i+"").replace(/cm/,""));v.setChecked(x)}});return v};var c=["top","bottom"];for(var a=0,m;m=c[a++];){(function(i){k["rowspacing"+i]=function(u){var w=u.options["rowspacing"+i]||[];if(!w.length){return null}for(var r=0,p,l=[];p=w[r++];){l.push({label:p,value:p,theme:u.options.theme,onclick:function(){u.execCommand("rowspacing",this.value,i)}})}var v=new k.MenuButton({editor:u,className:"edui-for-rowspacing"+i,title:u.options.labelMap["rowspacing"+i]||u.getLang("labelMap.rowspacing"+i)||"",items:l,onbuttonclick:function(){var x=u.queryCommandValue("rowspacing",i)||this.value;u.execCommand("rowspacing",x,i)}});k.buttons[i]=v;u.addListener("selectionchange",function(){var y=u.queryCommandState("rowspacing",i);if(y==-1){v.setDisabled(true)}else{v.setDisabled(false);var x=u.queryCommandValue("rowspacing",i);x&&v.setValue((x+"").replace(/%/,""));v.setChecked(y)}});return v}})(m)}var s=["insertorderedlist","insertunorderedlist"];for(var d=0,q;q=s[d++];){(function(i){k[i]=function(r){var v=r.options[i],w=function(){r.execCommand(i,this.value)},l=[];for(var p in v){l.push({label:v[p]||r.getLang()[i][p]||"",value:p,theme:r.options.theme,onclick:w})}var u=new k.MenuButton({editor:r,className:"edui-for-"+i,title:r.getLang("labelMap."+i)||"",items:l,onbuttonclick:function(){var x=r.queryCommandValue(i)||this.value;r.execCommand(i,x)}});k.buttons[i]=u;r.addListener("selectionchange",function(){var y=r.queryCommandState(i);if(y==-1){u.setDisabled(true)}else{u.setDisabled(false);var x=r.queryCommandValue(i);u.setValue(x);u.setChecked(y)}});return u}})(q)}k.fullscreen=function(i,p){p=i.options.labelMap.fullscreen||i.getLang("labelMap.fullscreen")||"";var l=new k.Button({className:"edui-for-fullscreen",title:p,theme:i.options.theme,onclick:function(){if(i.ui){i.ui.setFullScreen(!i.ui.isFullScreen())}this.setChecked(i.ui.isFullScreen())}});k.buttons.fullscreen=l;i.addListener("selectionchange",function(){var r=i.queryCommandState("fullscreen");l.setDisabled(r==-1);l.setChecked(i.ui.isFullScreen())});return l};k.emotion=function(l,i){var p=new k.MultiMenuPop({title:l.options.labelMap.emotion||l.getLang("labelMap.emotion")||"",editor:l,className:"edui-for-emotion",iframeUrl:l.ui.mapUrl(i||(l.options.iframeUrlMap||{})["emotion"]||f.emotion)});k.buttons.emotion=p;l.addListener("selectionchange",function(){p.setDisabled(l.queryCommandState("emotion")==-1)});return p};k.autotypeset=function(i){var l=new k.AutoTypeSetButton({editor:i,title:i.options.labelMap.autotypeset||i.getLang("labelMap.autotypeset")||"",className:"edui-for-autotypeset",onbuttonclick:function(){i.execCommand("autotypeset")}});k.buttons.autotypeset=l;i.addListener("selectionchange",function(){l.setDisabled(i.queryCommandState("autotypeset")==-1)});return l}})();(function(){var b=baidu.editor.utils,d=baidu.editor.ui.uiUtils,f=baidu.editor.ui.UIBase,a=baidu.editor.dom.domUtils;var e=[];function c(h){this.initOptions(h);this.initEditorUI()}c.prototype={uiName:"editor",initEditorUI:function(){this.editor.ui=this;this._dialogs={};this.initUIBase();this._initToolbars();var j=this.editor,k=this;j.addListener("ready",function(){j.getDialog=function(p){return j.ui._dialogs[p+"Dialog"]};a.on(j.window,"scroll",function(p){baidu.editor.ui.Popup.postHide(p)});j.ui._actualFrameWidth=j.options.initialFrameWidth;if(j.options.elementPathEnabled){j.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">'+j.getLang("elementPathTip")+":</div>"}if(j.options.wordCount){function o(){l(j,k);a.un(j.document,"click",arguments.callee)}a.on(j.document,"click",o);j.ui.getDom("wordcount").innerHTML=j.getLang("wordCountTip")}j.ui._scale();if(j.options.scaleEnabled){if(j.autoHeightEnabled){j.disableAutoHeight()}k.enableScale()}else{k.disableScale()}if(!j.options.elementPathEnabled&&!j.options.wordCount&&!j.options.scaleEnabled){j.ui.getDom("elementpath").style.display="none";j.ui.getDom("wordcount").style.display="none";j.ui.getDom("scale").style.display="none"}if(!j.selection.isFocus()){return}j.fireEvent("selectionchange",false,true)});j.addListener("mousedown",function(p,o){var q=o.target||o.srcElement;baidu.editor.ui.Popup.postHide(o,q)});j.addListener("delcells",function(){if(UE.ui.edittip){new UE.ui.edittip(j)}j.getDialog("edittip").open()});var i,m=false,n;j.addListener("afterpaste",function(){if(j.queryCommandState("pasteplain")){return}i=new baidu.editor.ui.Popup({content:new baidu.editor.ui.PastePicker({editor:j}),editor:j,className:"edui-wordpastepop"});i.render();m=true});j.addListener("afterinserthtml",function(){clearTimeout(n);n=setTimeout(function(){if(i&&(m||j.ui._isTransfer)){var p=a.createElement(j.document,"span",{style:"line-height:0px;",innerHTML:"\ufeff"}),o=j.selection.getRange();o.insertNode(p);i.showAnchor(p);a.remove(p);delete j.ui._isTransfer;m=false}},200)});j.addListener("contextmenu",function(p,o){baidu.editor.ui.Popup.postHide(o)});j.addListener("keydown",function(p,o){if(i){i.dispose(o)}var q=o.keyCode||o.which;if(o.altKey&&q==90){UE.ui.buttons.fullscreen.onclick()}});j.addListener("wordcount",function(o){l(this,k)});function l(r,u){r.setOpt({wordCount:true,maximumWords:10000,wordCountMsg:r.options.wordCountMsg||r.getLang("wordCountMsg"),wordOverFlowMsg:r.options.wordOverFlowMsg||r.getLang("wordOverFlowMsg")});var p=r.options,o=p.maximumWords,v=p.wordCountMsg,t=p.wordOverFlowMsg,q=u.getDom("wordcount");if(!p.wordCount){return}var s=r.getContentLength(true);if(s>o){q.innerHTML=t;r.fireEvent("wordcountoverflow")}else{q.innerHTML=v.replace("{#leave}",o-s).replace("{#count}",s)}}j.addListener("selectionchange",function(){if(j.options.elementPathEnabled){k[(j.queryCommandState("elementpath")==-1?"dis":"en")+"ableElementPath"]()}if(j.options.scaleEnabled){k[(j.queryCommandState("scale")==-1?"dis":"en")+"ableScale"]()}});var h=new baidu.editor.ui.Popup({editor:j,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide();j.ui._dialogs.linkDialog.open()},_onImgEditButtonClick:function(o){this.hide();j.ui._dialogs[o]&&j.ui._dialogs[o].open()},_onImgSetFloat:function(o){this.hide();j.execCommand("imagefloat",o)},_setIframeAlign:function(o){var p=h.anchorEl;var q=p.cloneNode(true);switch(o){case -2:q.setAttribute("align","");break;case -1:q.setAttribute("align","left");break;case 1:q.setAttribute("align","right");break}p.parentNode.insertBefore(q,p);a.remove(p);h.anchorEl=q;h.showAnchor(h.anchorEl)},_updateIframe:function(){j._iframe=h.anchorEl;j.ui._dialogs.insertframeDialog.open();h.hide()},_onRemoveButtonClick:function(o){j.execCommand(o);this.hide()},queryAutoHide:function(o){if(o&&o.ownerDocument==j.document){if(o.tagName.toLowerCase()=="img"||a.findParentByTagName(o,"a",true)){return o!==h.anchorEl}}return baidu.editor.ui.Popup.prototype.queryAutoHide.call(this,o)}});h.render();if(j.options.imagePopup){j.addListener("mouseover",function(q,o){o=o||window.event;var r=o.target||o.srcElement;if(j.ui._dialogs.insertframeDialog&&/iframe/ig.test(r.tagName)){var p=h.formatHtml("<nobr>"+j.getLang("property")+': <span onclick=$$._setIframeAlign(-2) class="edui-clickable">'+j.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">'+j.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">'+j.getLang("justifyright")+'</span>&nbsp;&nbsp; <span onclick="$$._updateIframe( this);" class="edui-clickable">'+j.getLang("modify")+"</span></nobr>");if(p){h.getDom("content").innerHTML=p;h.anchorEl=r;h.showAnchor(h.anchorEl)}else{h.hide()}}});j.addListener("selectionchange",function(y,r){if(!r){return}var v="",w="",u=j.selection.getRange().getClosedNode(),p=j.ui._dialogs;if(u&&u.tagName=="IMG"){var q="insertimageDialog";if(u.className.indexOf("edui-faked-video")!=-1){q="insertvideoDialog"}if(u.className.indexOf("edui-faked-webapp")!=-1){q="webappDialog"}if(u.src.indexOf("http://api.map.baidu.com")!=-1){q="mapDialog"}if(u.className.indexOf("edui-faked-music")!=-1){q="musicDialog"}if(u.src.indexOf("http://maps.google.com/maps/api/staticmap")!=-1){q="gmapDialog"}if(u.getAttribute("anchorname")){q="anchorDialog";v=h.formatHtml("<nobr>"+j.getLang("property")+': <span onclick=$$._onImgEditButtonClick("anchorDialog") class="edui-clickable">'+j.getLang("modify")+"</span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick('anchor') class=\"edui-clickable\">"+j.getLang("delete")+"</span></nobr>")}if(u.getAttribute("word_img")){j.word_img=[u.getAttribute("word_img")];q="wordimageDialog"}if(!p[q]){return}w="<nobr>"+j.getLang("property")+': <span onclick=$$._onImgSetFloat("none") class="edui-clickable">'+j.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable">'+j.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable">'+j.getLang("justifyright")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable">'+j.getLang("justifycenter")+"</span>&nbsp;&nbsp;<span onclick=\"$$._onImgEditButtonClick('"+q+'\');" class="edui-clickable">'+j.getLang("modify")+"</span></nobr>";!v&&(v=h.formatHtml(w))}if(j.ui._dialogs.linkDialog){var x=j.queryCommandValue("link");var o;if(x&&(o=(x.getAttribute("data_ue_src")||x.getAttribute("href",2)))){var s=o;if(o.length>30){s=o.substring(0,20)+"..."}if(v){v+='<div style="height:5px;"></div>'}v+=h.formatHtml("<nobr>"+j.getLang("anthorMsg")+': <a target="_blank" href="'+o+'" title="'+o+'" >'+s+'</a> <span class="edui-clickable" onclick="$$._onEditButtonClick();">'+j.getLang("modify")+'</span> <span class="edui-clickable" onclick="$$._onRemoveButtonClick(\'unlink\');"> '+j.getLang("clear")+"</span></nobr>");h.showAnchor(x)}}if(v){h.getDom("content").innerHTML=v;h.anchorEl=u||x;h.showAnchor(h.anchorEl)}else{h.hide()}})}},_initToolbars:function(){var p=this.editor;var r=this.toolbars||[];var l=[];for(var o=0;o<r.length;o++){var q=r[o];var m=new baidu.editor.ui.Toolbar({theme:p.options.theme});for(var n=0;n<q.length;n++){var h=q[n];var k=null;if(typeof h=="string"){h=h.toLowerCase();if(h=="|"){h="Separator"}if(baidu.editor.ui[h]){k=new baidu.editor.ui[h](p)}if(h=="fullscreen"){if(l&&l[0]){l[0].items.splice(0,0,k)}else{k&&m.items.splice(0,0,k)}continue}}else{k=h}if(k&&k.id){m.add(k)}}l[o]=m}this.toolbars=l},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox">'+(this.toolbars.length?'<div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+"</div></div>":"")+'<div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;"><div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">'+this.editor.getLang("clickToUpload")+'</div><div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div><div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div><div style="height:0;overflow:hidden;clear:both;"></div></div></div><div id="##_iframeholder" class="%%-iframeholder"></div><div id="##_bottombar" class="%%-bottomContainer"><table><tr><td id="##_elementpath" class="%%-bottombar"></td><td id="##_wordcount" class="%%-wordcount"></td><td id="##_scale" class="%%-scale"><div class="%%-icon"></div></td></tr></table></div><div id="##_scalelayer"></div></div>'},showWordImageDialog:function(){this.editor.execCommand("wordimage","word_img");this._dialogs.wordimageDialog.open()},renderToolbarBoxHtml:function(){var j=[];for(var h=0;h<this.toolbars.length;h++){j.push(this.toolbars[h].renderHtml())}return j.join("")},setFullScreen:function(m){var l=this.editor,j=l.container.parentNode.parentNode;if(this._fullscreen!=m){this._fullscreen=m;this.editor.fireEvent("beforefullscreenchange",m);if(baidu.editor.browser.gecko){var i=l.selection.getRange().createBookmark()}if(m){while(j.tagName!="BODY"){var h=baidu.editor.dom.domUtils.getComputedStyle(j,"position");e.push(h);j.style.position="static";j=j.parentNode}this._bakHtmlOverflow=document.documentElement.style.overflow;this._bakBodyOverflow=document.body.style.overflow;this._bakAutoHeight=this.editor.autoHeightEnabled;this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop);if(this._bakAutoHeight){l.autoHeightEnabled=false;this.editor.disableAutoHeight()}document.documentElement.style.overflow="hidden";document.body.style.overflow="hidden";this._bakCssText=this.getDom().style.cssText;this._bakCssText1=this.getDom("iframeholder").style.cssText;this._updateFullScreen()}else{while(j.tagName!="BODY"){j.style.position=e.shift();j=j.parentNode}this.getDom().style.cssText=this._bakCssText;this.getDom("iframeholder").style.cssText=this._bakCssText1;if(this._bakAutoHeight){l.autoHeightEnabled=true;this.editor.enableAutoHeight()}document.documentElement.style.overflow=this._bakHtmlOverflow;document.body.style.overflow=this._bakBodyOverflow;window.scrollTo(0,this._bakScrollTop)}if(baidu.editor.browser.gecko){var k=document.createElement("input");document.body.appendChild(k);l.body.contentEditable=false;setTimeout(function(){k.focus();setTimeout(function(){l.body.contentEditable=true;l.selection.getRange().moveToBookmark(i).select(true);baidu.editor.dom.domUtils.remove(k);m&&window.scroll(0,0)},0)},0)}this.editor.fireEvent("fullscreenchanged",m);this.triggerLayout()}},_updateFullScreen:function(){if(this._fullscreen){var h=d.getViewportRect();this.getDom().style.cssText="border:0;position:absolute;left:0;top:"+(this.editor.options.topOffset||0)+"px;width:"+h.width+"px;height:"+h.height+"px;z-index:"+(this.getDom().style.zIndex*1+100);d.setViewportOffset(this.getDom(),{left:0,top:this.editor.options.topOffset||0});this.editor.setHeight(h.height-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight-(this.editor.options.topOffset||0))}},_updateElementPath:function(){var h=this.getDom("elementpath"),l;if(this.elementPathEnabled&&(l=this.editor.queryCommandValue("elementpath"))){var m=[];for(var k=0,j;j=l[k];k++){m[k]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+k+'&quot;);">'+j+"</span>")}h.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">'+this.editor.getLang("elementPathTip")+": "+m.join(" &gt; ")+"</div>"}else{h.style.display="none"}},disableElementPath:function(){var h=this.getDom("elementpath");h.innerHTML="";h.style.display="none";this.elementPathEnabled=false},enableElementPath:function(){var h=this.getDom("elementpath");h.style.display="";this.elementPathEnabled=true;this._updateElementPath()},_scale:function(){var B=document,l=this.editor,z=l.container,j=l.document,n=this.getDom("toolbarbox"),o=this.getDom("bottombar"),A=this.getDom("scale"),x=this.getDom("scalelayer");var r=false,y=null,m=0,v=l.options.minFrameWidth,i=0,h=0,u=0,k=0;function q(){y=a.getXY(z);if(!m){m=l.options.minFrameHeight+n.offsetHeight+o.offsetHeight}x.style.cssText="position:absolute;left:0;display:;top:0;background-color:#41ABFF;opacity:0.4;filter: Alpha(opacity=40);width:"+z.offsetWidth+"px;height:"+z.offsetHeight+"px;z-index:"+(l.options.zIndex+1);a.on(B,"mousemove",s);a.on(j,"mouseup",p);a.on(B,"mouseup",p)}var w=this;this.editor.addListener("fullscreenchanged",function(E,C){if(C){w.disableScale()}else{if(w.editor.options.scaleEnabled){w.enableScale();var D=w.editor.document.createElement("span");w.editor.body.appendChild(D);w.editor.body.style.height=Math.max(a.getXY(D).y,w.editor.iframe.offsetHeight-20)+"px";a.remove(D)}}});function s(C){t();var D=C||window.event;i=D.pageX||(B.documentElement.scrollLeft+D.clientX);h=D.pageY||(B.documentElement.scrollTop+D.clientY);u=i-y.x;k=h-y.y;if(u>=v){r=true;x.style.width=u+"px"}if(k>=m){r=true;x.style.height=k+"px"}}function p(){if(r){r=false;l.ui._actualFrameWidth=x.offsetWidth-2;z.style.width=l.ui._actualFrameWidth+"px";l.setHeight(x.offsetHeight-o.offsetHeight-n.offsetHeight-2)}if(x){x.style.display="none"}t();a.un(B,"mousemove",s);a.un(j,"mouseup",p);a.un(B,"mouseup",p)}function t(){if(browser.ie){B.selection.clear()}else{window.getSelection().removeAllRanges()}}this.enableScale=function(){if(l.queryCommandState("source")==1){return}A.style.display="";this.scaleEnabled=true;a.on(A,"mousedown",q)};this.disableScale=function(){A.style.display="none";this.scaleEnabled=false;a.un(A,"mousedown",q)}},isFullScreen:function(){return this._fullscreen},postRender:function(){f.prototype.postRender.call(this);for(var k=0;k<this.toolbars.length;k++){this.toolbars[k].postRender()}var l=this;var j,h=baidu.editor.dom.domUtils,m=function(){clearTimeout(j);j=setTimeout(function(){l._updateFullScreen()})};h.on(window,"resize",m);l.addListener("destroy",function(){h.un(window,"resize",m);clearTimeout(j)})},showToolbarMsg:function(j,i){this.getDom("toolbarmsg_label").innerHTML=j;this.getDom("toolbarmsg").style.display="";if(!i){var h=this.getDom("upload_dialog");h.style.display="none"}},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(h){return h?h.replace("~/",this.editor.options.UEDITOR_HOME_URL||""):""},triggerLayout:function(){var h=this.getDom();if(h.style.zoom=="1"){h.style.zoom="100%"}else{h.style.zoom="1"}}};b.inherits(c,baidu.editor.ui.UIBase);var g={};UE.ui.Editor=function(h){var j=new baidu.editor.Editor(h);j.options.editor=j;b.loadFile(document,{href:j.options.themePath+j.options.theme+"/css/ueditor.css",tag:"link",type:"text/css",rel:"stylesheet"});var i=j.render;j.render=function(k){if(k.constructor===String){j.key=k;g[k]=j}b.domReady(function(){j.langIsReady?l():j.addListener("langReady",l);function l(){j.setOpt({labelMap:j.options.labelMap||j.getLang("labelMap")});new c(j.options);if(k){if(k.constructor===String){k=document.getElementById(k)}k&&k.getAttribute("name")&&(j.options.textarea=k.getAttribute("name"));if(k&&/script|textarea/ig.test(k.tagName)){var o=document.createElement("div");k.parentNode.insertBefore(o,k);var m=k.value||k.innerHTML;j.options.initialContent=/^[\t\r\n ]*$/.test(m)?j.options.initialContent:m.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><");k.className&&(o.className=k.className);k.style.cssText&&(o.style.cssText=k.style.cssText);if(/textarea/i.test(k.tagName)){j.textarea=k;j.textarea.style.display="none"}else{k.parentNode.removeChild(k);k.id&&(o.id=k.id)}k=o;k.innerHTML=""}}a.addClass(k,"edui-"+j.options.theme);j.ui.render(k);var n=j.ui.getDom("iframeholder");j.container=j.ui.getDom();var p=j.options.initialFrameWidth;if(!/%/g.test(p)){p+="px"}j.container.style.cssText="z-index:"+j.options.zIndex+";width:"+p;i.call(j,n)}})};return j};UE.getEditor=function(j,h){var i=g[j];if(!i){i=g[j]=new UE.ui.Editor(h);i.render(j)}return i};UE.delEditor=function(i){var h;if(h=g[i]){h.key&&h.destroy();delete g[i]}}})();(function(){var c=baidu.editor.utils,d=baidu.editor.ui.Popup,b=baidu.editor.ui.SplitButton,a=baidu.editor.ui.MultiMenuPop=function(e){this.initOptions(e);this.initMultiMenu()};a.prototype={initMultiMenu:function(){var e=this;this.popup=new d({content:"",editor:e.editor,iframe_rendered:false,onshow:function(){if(!this.iframe_rendered){this.iframe_rendered=true;this.getDom("content").innerHTML='<iframe id="'+e.id+'_iframe" src="'+e.iframeUrl+'" frameborder="0"></iframe>';e.editor.container.style.zIndex&&(this.getDom().style.zIndex=e.editor.container.style.zIndex*1+1)}}});this.onbuttonclick=function(){this.showPopup()};this.initSplitButton()}};c.inherits(a,b)})();UE.plugins.basestyle=function(){var d={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},c=function(f,e){return domUtils.filterNodeList(f.selection.getStartElementPath(),e)},b=this;b.addshortcutkey({Bold:"ctrl+66",Italic:"ctrl+73",Underline:"ctrl+85"});for(var a in d){(function(f,e){b.commands[f]={execCommand:function(h){var g=b.selection.getRange(),k=c(this,e);if(g.collapsed){if(k){var j=b.document.createTextNode("");g.insertNode(j).removeInlineStyle(e);g.setStartBefore(j);domUtils.remove(j)}else{var i=g.document.createElement(e[0]);if(h=="superscript"||h=="subscript"){j=b.document.createTextNode("");g.insertNode(j).removeInlineStyle(["sub","sup"]).setStartBefore(j).collapse(true)}g.insertNode(i).setStart(i,0)}g.collapse(true)}else{if(h=="superscript"||h=="subscript"){if(!k||k.tagName.toLowerCase()!=h){g.removeInlineStyle(["sub","sup"])}}k?g.removeInlineStyle(e):g.applyInlineStyle(e[0])}g.select()},queryCommandState:function(){return c(this,e)?1:0}}})(a,d[a])}};UE.plugins.removeformat=function(){var a=this;a.setOpt({removeFormatTags:"b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var",removeFormatAttributes:"class,style,lang,width,height,align,hspace,valign"});a.commands.removeformat={execCommand:function(m,o,b,k,l){var g=new RegExp("^(?:"+(o||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),f=b?[]:(k||this.options.removeFormatAttributes).split(","),h=new dom.Range(this.document),i,e,j,c=function(p){return p.nodeType==1};function d(s){if(s.nodeType==3||s.tagName.toLowerCase()!="span"){return 0}if(browser.ie){var q=s.attributes;if(q.length){for(var r=0,p=q.length;r<p;r++){if(q[r].specified){return 0}}return 1}}return !s.attributes.length}function n(v){var p=v.createBookmark();if(v.collapsed){v.enlarge(true)}if(!l){var q=domUtils.findParentByTagName(v.startContainer,"a",true);if(q){v.setStartBefore(q)}q=domUtils.findParentByTagName(v.endContainer,"a",true);if(q){v.setEndAfter(q)}}i=v.createBookmark();r=i.start;while((j=r.parentNode)&&!domUtils.isBlockElm(j)){domUtils.breakParent(r,j);domUtils.clearEmptySibling(r)}if(i.end){r=i.end;while((j=r.parentNode)&&!domUtils.isBlockElm(j)){domUtils.breakParent(r,j);domUtils.clearEmptySibling(r)}var w=domUtils.getNextDomNode(i.start,false,c),u;while(w){if(w==i.end){break}u=domUtils.getNextDomNode(w,true,c);if(!dtd.$empty[w.tagName.toLowerCase()]&&!domUtils.isBookmarkNode(w)){if(g.test(w.tagName)){if(b){domUtils.removeStyle(w,b);if(d(w)&&b!="text-decoration"){domUtils.remove(w,true)}}else{domUtils.remove(w,true)}}else{if(!dtd.$tableContent[w.tagName]&&!dtd.$list[w.tagName]){domUtils.removeAttributes(w,f);if(d(w)){domUtils.remove(w,true)}}}}w=u}}var x=i.start.parentNode;if(domUtils.isBlockElm(x)&&!dtd.$tableContent[x.tagName]&&!dtd.$list[x.tagName]){domUtils.removeAttributes(x,f)}x=i.end.parentNode;if(i.end&&domUtils.isBlockElm(x)&&!dtd.$tableContent[x.tagName]&&!dtd.$list[x.tagName]){domUtils.removeAttributes(x,f)}v.moveToBookmark(i).moveToBookmark(p);var r=v.startContainer,t,s=v.collapsed;while(r.nodeType==1&&domUtils.isEmptyNode(r)&&dtd.$removeEmpty[r.tagName]){t=r.parentNode;v.setStartBefore(r);if(v.startContainer===v.endContainer){v.endOffset--}domUtils.remove(r);r=t}if(!s){r=v.endContainer;while(r.nodeType==1&&domUtils.isEmptyNode(r)&&dtd.$removeEmpty[r.tagName]){t=r.parentNode;v.setEndBefore(r);domUtils.remove(r);r=t}}}h=this.selection.getRange();n(h);h.select()}}};UE.plugins.font=function(){var a=this,c={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration"};a.setOpt({fontfamily:[{name:"songti",val:"\u5b8b\u4f53,SimSun"},{name:"yahei",val:"\u5fae\u8f6f\u96c5\u9ed1,Microsoft YaHei"},{name:"kaiti",val:"\u6977\u4f53,\u6977\u4f53_GB2312, SimKai"},{name:"heiti",val:"\u9ed1\u4f53, SimHei"},{name:"lishu",val:"\u96b6\u4e66, SimLi"},{name:"andaleMono",val:"andale mono"},{name:"arial",val:"arial, helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"comicSansMs",val:"comic sans ms"},{name:"impact",val:"impact,chicago"},{name:"timesNewRoman",val:"times new roman"}],fontsize:[10,11,12,14,16,18,20,24,36]});for(var b in c){(function(e,d){UE.commands[e]={execCommand:function(g,j){j=j||(this.queryCommandState(g)?"none":g=="underline"?"underline":"line-through");var i=this,f=this.selection.getRange(),l;if(j=="default"){if(f.collapsed){l=i.document.createTextNode("font");f.insertNode(l).select()}i.execCommand("removeFormat","span,a",d);if(l){f.setStartBefore(l).setCursor();domUtils.remove(l)}}else{if(!f.collapsed){if((e=="underline"||e=="strikethrough")&&i.queryCommandValue(e)){i.execCommand("removeFormat","span,a",d)}f=i.selection.getRange();f.applyInlineStyle("span",{style:d+":"+j}).select()}else{var h=domUtils.findParentByTagName(f.startContainer,"span",true);l=i.document.createTextNode("font");if(h&&!h.children.length&&!h[browser.ie?"innerText":"textContent"].replace(fillCharReg,"").length){f.insertNode(l);if(e=="underline"||e=="strikethrough"){f.selectNode(l).select();i.execCommand("removeFormat","span,a",d,null);h=domUtils.findParentByTagName(l,"span",true);f.setStartBefore(l)}h.style.cssText+=";"+d+":"+j;f.collapse(true).select()}else{f.insertNode(l);f.selectNode(l).select();h=f.document.createElement("span");if(e=="underline"||e=="strikethrough"){if(domUtils.findParentByTagName(l,"a",true)){f.setStartBefore(l).setCursor();domUtils.remove(l);return}i.execCommand("removeFormat","span,a",d)}h.style.cssText=d+":"+j;l.parentNode.insertBefore(h,l);if(!browser.ie||browser.ie&&browser.version==9){var k=h.parentNode;while(!domUtils.isBlockElm(k)){if(k.tagName=="SPAN"){h.style.cssText=k.style.cssText+";"+h.style.cssText}k=k.parentNode}}if(opera){setTimeout(function(){f.setStart(h,0).setCursor()})}else{f.setStart(h,0).setCursor()}}domUtils.remove(l)}}return true},queryCommandValue:function(g){var f=this.selection.getStart();if(g=="underline"||g=="strikethrough"){var h=f,i;while(h&&!domUtils.isBlockElm(h)&&!domUtils.isBody(h)){if(h.nodeType==1){i=domUtils.getComputedStyle(h,d);if(i!="none"){return i}}h=h.parentNode}return"none"}return domUtils.getComputedStyle(f,d)},queryCommandState:function(f){if(!(f=="underline"||f=="strikethrough")){return 0}return this.queryCommandValue(f)==(f=="underline"?"underline":"line-through")}}})(b,c[b])}};UE.plugins.list=function(){var f=this,b={TD:1,PRE:1,BLOCKQUOTE:1};var g={cn:"cn-1-",cn1:"cn-2-",cn2:"cn-3-",num:"num-1-",num1:"num-2-",num2:"num-3-",dash:"dash",dot:"dot"};f.setOpt({insertorderedlist:{num:"",num1:"",num2:"",cn:"",cn1:"",cn2:"",decimal:"","lower-alpha":"","lower-roman":"","upper-alpha":"","upper-roman":""},insertunorderedlist:{circle:"",disc:"",square:"",dash:"",dot:""},listDefaultPaddingLeft:"30",listiconpath:"http://bs.baidu.com/listicon/",maxListLevel:3});var a=f.options.listiconpath;for(var h in g){if(!f.options.insertorderedlist.hasOwnProperty(h)&&!f.options.insertunorderedlist.hasOwnProperty(h)){delete g[h]}}f.ready(function(){var l=[];for(var k in g){if(k=="dash"||k=="dot"){l.push("li.list-"+g[k]+"{background-image:url("+a+g[k]+".gif)}");l.push("ul.custom_"+k+"{list-style:none;}ul.custom_"+k+" li{background-position:0 3px;background-repeat:no-repeat}")}else{for(var j=0;j<99;j++){l.push("li.list-"+g[k]+j+"{background-image:url("+a+"list-"+g[k]+j+".gif)}")}l.push("ol.custom_"+k+"{list-style:none;}ol.custom_"+k+" li{background-position:0 3px;background-repeat:no-repeat}")}switch(k){case"cn":l.push("li.list-"+k+"-paddingleft-1{padding-left:25px}");l.push("li.list-"+k+"-paddingleft-2{padding-left:40px}");l.push("li.list-"+k+"-paddingleft-3{padding-left:55px}");break;case"cn1":l.push("li.list-"+k+"-paddingleft-1{padding-left:30px}");l.push("li.list-"+k+"-paddingleft-2{padding-left:40px}");l.push("li.list-"+k+"-paddingleft-3{padding-left:55px}");break;case"cn2":l.push("li.list-"+k+"-paddingleft-1{padding-left:40px}");l.push("li.list-"+k+"-paddingleft-2{padding-left:55px}");l.push("li.list-"+k+"-paddingleft-3{padding-left:68px}");break;case"num":case"num1":l.push("li.list-"+k+"-paddingleft-1{padding-left:25px}");break;case"num2":l.push("li.list-"+k+"-paddingleft-1{padding-left:35px}");l.push("li.list-"+k+"-paddingleft-2{padding-left:40px}");break;case"dash":l.push("li.list-"+k+"-paddingleft{padding-left:35px}");break;case"dot":l.push("li.list-"+k+"-paddingleft{padding-left:20px}")}}l.push(".list-paddingleft-1{padding-left:0}");l.push(".list-paddingleft-2{padding-left:"+f.options.listDefaultPaddingLeft+"px}");l.push(".list-paddingleft-3{padding-left:"+f.options.listDefaultPaddingLeft*2+"px}");utils.cssRule("list","ol,ul{margin:0;pading:0;"+(browser.ie?"":"width:95%")+"}li{clear:both;}"+l.join("\n"),f.document)});function e(k){var j=k.className;if(domUtils.hasClass(k,/custom_/)){return j.match(/custom_(\w+)/)[1]}return""}f.addListener("contentchange",function(){utils.each(domUtils.getElementsByTagName(f.document,"ol ul"),function(m){if(!domUtils.inDoc(m,f.document)){return}var j=0,l=2,k=m.parentNode;if(domUtils.hasClass(m,/custom_/)){if(!(/[ou]l/i.test(k.tagName)&&domUtils.hasClass(k,/custom_/))){l=1}}else{if(/[ou]l/i.test(k.tagName)&&domUtils.hasClass(k,/custom_/)){l=3}}style=domUtils.getStyle(m,"list-style-type");m.style.cssText=style?"list-style-type:"+style:"";m.className=utils.trim(m.className.replace(/list-paddingleft-\w+/,""))+" list-paddingleft-"+l;utils.each(domUtils.getElementsByTagName(m,"li"),function(n){n.style.cssText&&(n.style.cssText="");if(!n.firstChild){domUtils.remove(n);return}if(n.parentNode!==m){return}j++;if(domUtils.hasClass(m,/custom_/)){var p=1,o=e(m);if(m.tagName=="OL"){if(o){switch(o){case"cn":case"cn1":case"cn2":if(j>10&&(j%10==0||j>10&&j<20)){p=2}else{if(j>20){p=3}}break;case"num2":if(j>9){p=2}}}n.className="list-"+g[o]+j+" list-"+o+"-paddingleft-"+p}else{n.className="list-"+g[o]+" list-"+o+"-paddingleft"}}else{n.className=n.className.replace(/list-[\w\-]+/gi,"")}var q=n.getAttribute("class");if(q!==null&&!q.replace(/\s/g,"")){domUtils.removeAttributes(n,"class")}});d(m,m.tagName.toLowerCase(),e(m)||domUtils.getStyle(m,"list-style-type"),true)})});function d(o,k,n,m){var l=o.nextSibling;if(l&&l.nodeType==1&&l.tagName.toLowerCase()==k&&(e(l)||domUtils.getStyle(l,"list-style-type")||(k=="ol"?"decimal":"disc"))==n){domUtils.moveChild(l,o);if(l.childNodes.length==0){domUtils.remove(l)}}if(l&&domUtils.isFillChar(l)){domUtils.remove(l)}var j=o.previousSibling;if(j&&j.nodeType==1&&j.tagName.toLowerCase()==k&&(e(j)||domUtils.getStyle(j,"list-style-type")||(k=="ol"?"decimal":"disc"))==n){domUtils.moveChild(o,j)}if(j&&domUtils.isFillChar(j)){domUtils.remove(j)}!m&&domUtils.isEmptyBlock(o)&&domUtils.remove(o)}function i(k,j){if(g[j]){k.className="custom_"+j}try{domUtils.setStyle(k,"list-style-type",j)}catch(l){}}function c(k){var j=k.previousSibling;if(j&&domUtils.isEmptyBlock(j)){domUtils.remove(j)}j=k.nextSibling;if(j&&domUtils.isEmptyBlock(j)){domUtils.remove(j)}}f.addListener("keydown",function(t,z){function o(){z.preventDefault?z.preventDefault():(z.returnValue=false);f.fireEvent("contentchange");f.undoManger&&f.undoManger.save()}function s(p,B){while(p&&!domUtils.isBody(p)){if(B(p)){return null}if(p.nodeType==1&&/[ou]l/i.test(p.tagName)){return p}p=p.parentNode}return null}var A=z.keyCode||z.which;if(A==13&&!z.shiftKey){var r=f.selection.getRange(),k=s(r.startContainer,function(p){return p.tagName=="TABLE"}),n=r.collapsed?k:s(r.endContainer,function(p){return p.tagName=="TABLE"});if(k&&n&&k===n){if(!r.collapsed){k=domUtils.findParentByTagName(r.startContainer,"li",true);n=domUtils.findParentByTagName(r.endContainer,"li",true);if(k&&n&&k===n){r.deleteContents();x=domUtils.findParentByTagName(r.startContainer,"li",true);if(x&&domUtils.isEmptyBlock(x)){m=x.previousSibling;next=x.nextSibling;j=f.document.createElement("p");domUtils.fillNode(f.document,j);v=x.parentNode;if(m&&next){r.setStart(next,0).collapse(true).select(true);domUtils.remove(x)}else{if(!m&&!next||!m){v.parentNode.insertBefore(j,v)}else{x.parentNode.parentNode.insertBefore(j,v.nextSibling)}domUtils.remove(x);if(!v.firstChild){domUtils.remove(v)}r.setStart(j,0).setCursor()}o();return}}else{var y=r.cloneRange(),l=y.collapse(false).createBookmark();r.deleteContents();y.moveToBookmark(l);var x=domUtils.findParentByTagName(y.startContainer,"li",true);c(x);y.select();o();return}}x=domUtils.findParentByTagName(r.startContainer,"li",true);if(x){if(domUtils.isEmptyBlock(x)){l=r.createBookmark();var v=x.parentNode;if(x!==v.lastChild){domUtils.breakParent(x,v);c(x)}else{v.parentNode.insertBefore(x,v.nextSibling);if(domUtils.isEmptyNode(v)){domUtils.remove(v)}}if(!dtd.$list[x.parentNode.tagName]){if(!domUtils.isBlockElm(x.firstChild)){j=f.document.createElement("p");x.parentNode.insertBefore(j,x);while(x.firstChild){j.appendChild(x.firstChild)}domUtils.remove(x)}else{domUtils.remove(x,true)}}r.moveToBookmark(l).select()}else{var q=x.firstChild;if(!q||!domUtils.isBlockElm(q)){var j=f.document.createElement("p");!x.firstChild&&domUtils.fillNode(f.document,j);while(x.firstChild){j.appendChild(x.firstChild)}x.appendChild(j);q=j}var u=f.document.createElement("span");r.insertNode(u);domUtils.breakParent(u,x);var w=u.nextSibling;q=w.firstChild;if(!q){j=f.document.createElement("p");domUtils.fillNode(f.document,j);w.appendChild(j);q=j}if(domUtils.isEmptyNode(q)){q.innerHTML="";domUtils.fillNode(f.document,q)}r.setStart(q,0).collapse(true).shrinkBoundary().select();domUtils.remove(u);var m=w.previousSibling;if(m&&domUtils.isEmptyBlock(m)){m.innerHTML="<p></p>";domUtils.fillNode(f.document,m.firstChild)}}o()}}}if(A==8){r=f.selection.getRange();if(r.collapsed&&domUtils.isStartInblock(r)){y=r.cloneRange().trimBoundary();x=domUtils.findParentByTagName(r.startContainer,"li",true);if(x&&domUtils.isStartInblock(y)){k=domUtils.findParentByTagName(r.startContainer,"p",true);if(k&&k!==x.firstChild){var v=domUtils.findParentByTagName(k,["ol","ul"]);domUtils.breakParent(k,v);c(k);f.fireEvent("contentchange");r.setStart(k,0).setCursor(false,true);f.fireEvent("saveScene");domUtils.preventDefault(z);return}if(x&&(m=x.previousSibling)){if(A==46&&x.childNodes.length){return}if(dtd.$list[m.tagName]){m=m.lastChild}f.undoManger&&f.undoManger.save();q=x.firstChild;if(domUtils.isBlockElm(q)){if(domUtils.isEmptyNode(q)){m.appendChild(q);r.setStart(q,0).setCursor(false,true);while(x.firstChild){m.appendChild(x.firstChild)}}else{u=f.document.createElement("span");r.insertNode(u);if(domUtils.isEmptyBlock(m)){m.innerHTML=""}domUtils.moveChild(x,m);r.setStartBefore(u).collapse(true).select(true);domUtils.remove(u)}}else{if(domUtils.isEmptyNode(x)){var j=f.document.createElement("p");m.appendChild(j);r.setStart(j,0).setCursor()}else{r.setEnd(m,m.childNodes.length).collapse().select(true);while(x.firstChild){m.appendChild(x.firstChild)}}}domUtils.remove(x);f.fireEvent("contentchange");f.fireEvent("saveScene");domUtils.preventDefault(z);return}if(x&&!x.previousSibling){var v=x.parentNode;var l=r.createBookmark();if(domUtils.isTagNode(v.parentNode,"ol ul")){v.parentNode.insertBefore(x,v);if(domUtils.isEmptyNode(v)){domUtils.remove(v)}}else{while(x.firstChild){v.parentNode.insertBefore(x.firstChild,v)}domUtils.remove(x);if(domUtils.isEmptyNode(v)){domUtils.remove(v)}}r.moveToBookmark(l).setCursor(false,true);f.fireEvent("contentchange");f.fireEvent("saveScene");domUtils.preventDefault(z);return}}}}});f.addListener("tabkeydown",function(){function v(A){var z=[];for(var B in A){z.push(B)}return z}var o=f.selection.getRange(),t={OL:v(f.options.insertorderedlist),UL:v(f.options.insertunorderedlist)};function w(z){if(f.options.maxListLevel!=-1){var B=z.parentNode,A=0;while(/[ou]l/i.test(B.tagName)){A++;B=B.parentNode}if(A>=f.options.maxListLevel){return true}}}var x=domUtils.findParentByTagName(o.startContainer,"li",true);if(x){var m;if(o.collapsed){if(w(x)){return true}var l=x.parentNode,s=f.document.createElement(l.tagName),p=utils.indexOf(t[s.tagName],e(l)||domUtils.getComputedStyle(l,"list-style-type"));p=p+1==t[s.tagName].length?0:p+1;var k=t[s.tagName][p];i(s,k);if(domUtils.isStartInblock(o)){f.fireEvent("saveScene");m=o.createBookmark();l.insertBefore(s,x);s.appendChild(x);d(s,s.tagName.toLowerCase(),k);f.fireEvent("contentchange");o.moveToBookmark(m).select(true);return true}}else{f.fireEvent("saveScene");m=o.createBookmark();for(var n=0,j,u=domUtils.findParents(x),y;y=u[n++];){if(domUtils.isTagNode(y,"ol ul")){j=y;break}}var r=x;if(m.end){while(r&&!(domUtils.getPosition(r,m.end)&domUtils.POSITION_FOLLOWING)){if(w(r)){r=domUtils.getNextDomNode(r,false,null,function(z){return z!==j});continue}var l=r.parentNode,s=f.document.createElement(l.tagName),p=utils.indexOf(t[s.tagName],e(l)||domUtils.getComputedStyle(l,"list-style-type"));var q=p+1==t[s.tagName].length?0:p+1;var k=t[s.tagName][q];i(s,k);l.insertBefore(s,r);while(r&&!(domUtils.getPosition(r,m.end)&domUtils.POSITION_FOLLOWING)){x=r.nextSibling;s.appendChild(r);if(!x||domUtils.isTagNode(x,"ol ul")){if(x){while(x=x.firstChild){if(x.tagName=="LI"){break}}}else{x=domUtils.getNextDomNode(r,false,null,function(z){return z!==j})}break}r=x}d(s,s.tagName.toLowerCase(),k);r=x}}f.fireEvent("contentchange");o.moveToBookmark(m).select();return true}}});f.commands.insertorderedlist=f.commands.insertunorderedlist={execCommand:function(n,F){if(!F){F=n.toLowerCase()=="insertorderedlist"?"decimal":"disc"}var N=this,y=this.selection.getRange(),z=function(p){return p.nodeType==1?p.tagName.toLowerCase()!="br":!domUtils.isWhitespace(p)},P=n.toLowerCase()=="insertorderedlist"?"ol":"ul",m=N.document.createDocumentFragment();y.adjustmentBoundary().shrinkBoundary();var s=y.createBookmark(true),q=domUtils.findParentByTagName(N.document.getElementById(s.start),"li"),C=0,o=domUtils.findParentByTagName(N.document.getElementById(s.end),"li"),D=0,L,v,G,I;if(q||o){q&&(L=q.parentNode);if(!s.end){o=q}o&&(v=o.parentNode);if(L===v){while(q!==o){I=q;q=q.nextSibling;if(!domUtils.isBlockElm(I.firstChild)){var A=N.document.createElement("p");while(I.firstChild){A.appendChild(I.firstChild)}I.appendChild(A)}m.appendChild(I)}I=N.document.createElement("span");L.insertBefore(I,o);if(!domUtils.isBlockElm(o.firstChild)){A=N.document.createElement("p");while(o.firstChild){A.appendChild(o.firstChild)}o.appendChild(A)}m.appendChild(o);domUtils.breakParent(I,L);if(domUtils.isEmptyNode(I.previousSibling)){domUtils.remove(I.previousSibling)}if(domUtils.isEmptyNode(I.nextSibling)){domUtils.remove(I.nextSibling)}var r=e(L)||domUtils.getComputedStyle(L,"list-style-type")||(n.toLowerCase()=="insertorderedlist"?"decimal":"disc");if(L.tagName.toLowerCase()==P&&r==F){for(var E=0,w,t=N.document.createDocumentFragment();w=m.childNodes[E++];){if(domUtils.isTagNode(w,"ol ul")){utils.each(domUtils.getElementsByTagName(w,"li"),function(p){while(p.firstChild){t.appendChild(p.firstChild)}})}else{while(w.firstChild){t.appendChild(w.firstChild)}}}I.parentNode.insertBefore(t,I)}else{G=N.document.createElement(P);i(G,F);G.appendChild(m);I.parentNode.insertBefore(G,I)}domUtils.remove(I);G&&d(G,P,F);y.moveToBookmark(s).select();return}if(q){while(q){I=q.nextSibling;if(domUtils.isTagNode(q,"ol ul")){m.appendChild(q)}else{var k=N.document.createDocumentFragment(),K=0;while(q.firstChild){if(domUtils.isBlockElm(q.firstChild)){K=1}k.appendChild(q.firstChild)}if(!K){var O=N.document.createElement("p");O.appendChild(k);m.appendChild(O)}else{m.appendChild(k)}domUtils.remove(q)}q=I}L.parentNode.insertBefore(m,L.nextSibling);if(domUtils.isEmptyNode(L)){y.setStartBefore(L);domUtils.remove(L)}else{y.setStartAfter(L)}C=1}if(o&&domUtils.inDoc(v,N.document)){q=v.firstChild;while(q&&q!==o){I=q.nextSibling;if(domUtils.isTagNode(q,"ol ul")){m.appendChild(q)}else{k=N.document.createDocumentFragment();K=0;while(q.firstChild){if(domUtils.isBlockElm(q.firstChild)){K=1}k.appendChild(q.firstChild)}if(!K){O=N.document.createElement("p");O.appendChild(k);m.appendChild(O)}else{m.appendChild(k)}domUtils.remove(q)}q=I}var j=domUtils.createElement(N.document,"div",{tmpDiv:1});domUtils.moveChild(o,j);m.appendChild(j);domUtils.remove(o);v.parentNode.insertBefore(m,v);y.setEndBefore(v);if(domUtils.isEmptyNode(v)){domUtils.remove(v)}D=1}}if(!C){y.setStartBefore(N.document.getElementById(s.start))}if(s.end&&!D){y.setEndAfter(N.document.getElementById(s.end))}y.enlarge(true,function(p){return b[p.tagName]});m=N.document.createDocumentFragment();var l=y.createBookmark(),B=domUtils.getNextDomNode(l.start,false,z),M=y.cloneRange(),H,u=domUtils.isBlockElm;while(B&&B!==l.end&&(domUtils.getPosition(B,l.end)&domUtils.POSITION_PRECEDING)){if(B.nodeType==3||dtd.li[B.tagName]){if(B.nodeType==1&&dtd.$list[B.tagName]){while(B.firstChild){m.appendChild(B.firstChild)}H=domUtils.getNextDomNode(B,false,z);domUtils.remove(B);B=H;continue}H=B;M.setStartBefore(B);while(B&&B!==l.end&&(!u(B)||domUtils.isBookmarkNode(B))){H=B;B=domUtils.getNextDomNode(B,false,null,function(p){return !b[p.tagName]})}if(B&&u(B)){I=domUtils.getNextDomNode(H,false,z);if(I&&domUtils.isBookmarkNode(I)){B=domUtils.getNextDomNode(I,false,z);H=I}}M.setEndAfter(H);B=domUtils.getNextDomNode(H,false,z);var x=y.document.createElement("li");x.appendChild(M.extractContents());if(domUtils.isEmptyNode(x)){var H=y.document.createElement("p");while(x.firstChild){H.appendChild(x.firstChild)}x.appendChild(H)}m.appendChild(x)}else{B=domUtils.getNextDomNode(B,true,z)}}y.moveToBookmark(l).collapse(true);G=N.document.createElement(P);i(G,F);G.appendChild(m);y.insertNode(G);d(G,P,F,true);for(var E=0,w,J=domUtils.getElementsByTagName(G,"div");w=J[E++];){if(w.getAttribute("tmpDiv")){domUtils.remove(w,true)}}y.moveToBookmark(s).select()},queryCommandState:function(j){return domUtils.filterNodeList(this.selection.getStartElementPath(),j.toLowerCase()=="insertorderedlist"?"ol":"ul")?1:0},queryCommandValue:function(k){var j=domUtils.filterNodeList(this.selection.getStartElementPath(),k.toLowerCase()=="insertorderedlist"?"ol":"ul");return j?e(j)||domUtils.getComputedStyle(j,"list-style-type"):null}}};UE.commands.inserthtml={execCommand:function(h,k,b){var n=this,l,a;if(!k){return}l=n.selection.getRange();a=l.document.createElement("div");a.style.display="inline";var p=n.serialize;if(!b&&p){var e=p.parseHTML(k);e=p.transformInput(e);e=p.filter(e);k=p.toHTML(e)}a.innerHTML=utils.trim(k);if(!l.collapsed){var d=l.startContainer;if(domUtils.isFillChar(d)){l.setStartBefore(d)}d=l.endContainer;if(domUtils.isFillChar(d)){l.setEndAfter(d)}l.txtToElmBoundary();if(l.endContainer&&l.endContainer.nodeType==1){d=l.endContainer.childNodes[l.endOffset];if(d&&domUtils.isBr(d)){l.setEndAfter(d)}}if(l.startOffset==0){d=l.startContainer;if(domUtils.isBoundaryNode(d,"firstChild")){d=l.endContainer;if(l.endOffset==(d.nodeType==3?d.nodeValue.length:d.childNodes.length)&&domUtils.isBoundaryNode(d,"lastChild")){n.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>";l.setStart(n.body.firstChild,0).collapse(true)}}}!l.collapsed&&l.deleteContents();if(l.startContainer.nodeType==1){var c=l.startContainer.childNodes[l.startOffset],f;if(c&&domUtils.isBlockElm(c)&&(f=c.previousSibling)&&domUtils.isBlockElm(f)){l.setEnd(f,f.childNodes.length).collapse();while(c.firstChild){f.appendChild(c.firstChild)}domUtils.remove(c)}}}var c,o,f,i,m=0,g;if(l.inFillChar()){c=l.startContainer;l.setStartBefore(c).collapse(true);domUtils.remove(c)}while(c=a.firstChild){l.insertNode(c);g=c.nextSibling;if(!m&&c.nodeType==domUtils.NODE_ELEMENT&&domUtils.isBlockElm(c)){o=domUtils.findParent(c,function(q){return domUtils.isBlockElm(q)});if(o&&o.tagName.toLowerCase()!="body"&&!(dtd[o.tagName][c.nodeName]&&c.parentNode===o)){if(!dtd[o.tagName][c.nodeName]){f=o}else{i=c.parentNode;while(i!==o){f=i;i=i.parentNode}}domUtils.breakParent(c,f||i);var f=c.previousSibling;domUtils.trimWhiteTextNode(f);if(!f.childNodes.length){domUtils.remove(f)}if(!browser.ie&&(j=c.nextSibling)&&domUtils.isBlockElm(j)&&j.lastChild&&!domUtils.isBr(j.lastChild)){j.appendChild(n.document.createElement("br"))}m=1}}var j=c.nextSibling;if(!a.firstChild&&j&&domUtils.isBlockElm(j)){l.setStart(j,0).collapse(true);break}l.setEndAfter(c).collapse()}c=l.startContainer;if(g&&domUtils.isBr(g)){domUtils.remove(g)}if(domUtils.isBlockElm(c)&&domUtils.isEmptyNode(c)){if(g=c.nextSibling){domUtils.remove(c);if(g.nodeType==1&&dtd.$block[g.tagName]){l.setStart(g,0).collapse(true).shrinkBoundary()}}else{c.innerHTML=browser.ie?domUtils.fillChar:"<br/>"}}l.select(true);setTimeout(function(){l=n.selection.getRange();l.scrollToView(n.autoHeightEnabled,n.autoHeightEnabled?domUtils.getXY(n.iframe).y:0);n.fireEvent("afterinserthtml")},200)}};UE.commands.horizontal={execCommand:function(b){var d=this;if(d.queryCommandState(b)!==-1){d.execCommand("insertHtml","<hr>");var a=d.selection.getRange(),e=a.startContainer;if(e.nodeType==1&&!e.childNodes[a.startOffset]){var c;if(c=e.childNodes[a.startOffset-1]){if(c.nodeType==1&&c.tagName=="HR"){if(d.options.enterTag=="p"){c=d.document.createElement("p");a.insertNode(c);a.setStart(c,0).setCursor()}else{c=d.document.createElement("br");a.insertNode(c);a.setStartBefore(c).setCursor()}}}}return true}},queryCommandState:function(){return domUtils.filterNodeList(this.selection.getStartElementPath(),"table")?-1:0}};(function(){function a(d){var e=d.startContainer,c=d.endContainer;if(e=domUtils.findParentByTagName(e,"a",true)){d.setStartBefore(e)}if(c=domUtils.findParentByTagName(c,"a",true)){d.setEndAfter(c)}}UE.commands.unlink={execCommand:function(){var c=this.selection.getRange(),d;if(c.collapsed&&!domUtils.findParentByTagName(c.startContainer,"a",true)){return}d=c.createBookmark();a(c);c.removeInlineStyle("a").moveToBookmark(d).select()},queryCommandState:function(){return !this.highlight&&this.queryCommandValue("link")?0:-1}};function b(d,e,g){var h=d.cloneRange(),f=g.queryCommandValue("link");a(d=d.adjustmentBoundary());var j=d.startContainer;if(j.nodeType==1&&f){j=j.childNodes[d.startOffset];if(j&&j.nodeType==1&&j.tagName=="A"&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(j[browser.ie?"innerText":"textContent"])){j[browser.ie?"innerText":"textContent"]=utils.html(e.textValue||e.href)}}if(!h.collapsed||f){d.removeInlineStyle("a");h=d.cloneRange()}if(h.collapsed){var c=d.document.createElement("a"),i="";if(e.textValue){i=utils.html(e.textValue);delete e.textValue}else{i=utils.html(e.href)}domUtils.setAttributes(c,e);j=domUtils.findParentByTagName(h.startContainer,"a",true);if(j&&domUtils.isInNodeEndBoundary(h,j)){d.setStartAfter(j).collapse(true)}c[browser.ie?"innerText":"textContent"]=i;d.insertNode(c).selectNode(c)}else{d.applyInlineStyle("a",e)}}UE.commands.link={execCommand:function(d,e){var c;e.data_ue_src&&(e.data_ue_src=utils.unhtml(e.data_ue_src,/[<">]/g));e.href&&(e.href=utils.unhtml(e.href,/[<">]/g));e.textValue&&(e.textValue=utils.unhtml(e.textValue,/[<">]/g));b(c=this.selection.getRange(),e,this);c.collapse().select(true)},queryCommandValue:function(){var j=this.selection.getRange(),e;if(j.collapsed){e=j.startContainer;e=e.nodeType==1?e:e.parentNode;if(e&&(e=domUtils.findParentByTagName(e,"a",true))&&!domUtils.isInNodeEndBoundary(j,e)){return e}}else{j.shrinkBoundary();var d=j.startContainer.nodeType==3||!j.startContainer.childNodes[j.startOffset]?j.startContainer:j.startContainer.childNodes[j.startOffset],g=j.endContainer.nodeType==3||j.endOffset==0?j.endContainer:j.endContainer.childNodes[j.endOffset-1],k=j.getCommonAncestor();e=domUtils.findParentByTagName(k,"a",true);if(!e&&k.nodeType==1){var f=k.getElementsByTagName("a"),c,l;for(var h=0,m;m=f[h++];){c=domUtils.getPosition(m,d),l=domUtils.getPosition(m,g);if((c&domUtils.POSITION_FOLLOWING||c&domUtils.POSITION_CONTAINS)&&(l&domUtils.POSITION_PRECEDING||l&domUtils.POSITION_CONTAINS)){e=m;break}}}return e}},queryCommandState:function(){var d=this.selection.getRange().getClosedNode(),c=d&&(d.className=="edui-faked-video");return c?-1:0}}})();(function(){var c=domUtils.isBlockElm,b=function(d){return domUtils.filterNodeList(d.selection.getStartElementPath(),function(e){return e.getAttribute("dir")})},a=function(h,i,g){var l,o=function(p){return p.nodeType==1?!domUtils.isBookmarkNode(p):!domUtils.isWhitespace(p)},f=b(i);if(f&&h.collapsed){f.setAttribute("dir",g);return h}l=h.createBookmark();h.enlarge(true);var q=h.createBookmark(),k=domUtils.getNextDomNode(q.start,false,o),m=h.cloneRange(),e;while(k&&!(domUtils.getPosition(k,q.end)&domUtils.POSITION_FOLLOWING)){if(k.nodeType==3||!c(k)){m.setStartBefore(k);while(k&&k!==q.end&&!c(k)){e=k;k=domUtils.getNextDomNode(k,false,null,function(p){return !c(p)})}m.setEndAfter(e);var j=m.getCommonAncestor();if(!domUtils.isBody(j)&&c(j)){j.setAttribute("dir",g);k=j}else{var d=h.document.createElement("p");d.setAttribute("dir",g);var n=m.extractContents();d.appendChild(n);m.insertNode(d);k=d}k=domUtils.getNextDomNode(k,false,o)}else{k=domUtils.getNextDomNode(k,true,o)}}return h.moveToBookmark(q).moveToBookmark(l)};UE.commands.directionality={execCommand:function(g,f){var e=this.selection.getRange();if(e.collapsed){var d=this.document.createTextNode("d");e.insertNode(d)}a(e,this,f);if(d){e.setStartBefore(d).collapse(true);domUtils.remove(d)}e.select();return true},queryCommandValue:function(){var d=b(this);return d?d.getAttribute("dir"):"ltr"}}})();UE.plugins.undo=function(){var i=this,m=i.options.maxUndoCount||20,h=i.options.maxInputCount||20,d=new RegExp(domUtils.fillChar+"|</hr>","gi");function f(q,p){if(q.length!=p.length){return 0}for(var o=0,n=q.length;o<n;o++){if(q[o]!=p[o]){return 0}}return 1}function j(o,n){if(o.collapsed!=n.collapsed){return 0}if(!f(o.startAddress,n.startAddress)||!f(o.endAddress,n.endAddress)){return 0}return 1}function k(n){var o=/\b(?:href|src|name)="[^"]*?"/gi;return n.replace(o,"").replace(/([\w\-]*?)\s*=\s*(("([^"]*)")|('([^']*)')|([^\s>]+))/gi,function(q,p,r){return p.toLowerCase()+"="+r.replace(/['"]/g,"").toLowerCase()}).replace(/(<[\w\-]+)|([\w\-]+>)/gi,function(q,p,r){return(p||r).toLowerCase()})}function b(){this.list=[];this.index=0;this.hasUndo=false;this.hasRedo=false;this.undo=function(){if(this.hasUndo){var q=this.getScene(),o=this.list[this.index],n=k(o.content),p=k(q.content);if(n!=p){this.save()}if(!this.list[this.index-1]&&this.list.length==1){this.reset();return}while(this.list[this.index].content==this.list[this.index-1].content){this.index--;if(this.index==0){return this.restore(0)}}this.restore(--this.index)}};this.redo=function(){if(this.hasRedo){while(this.list[this.index].content==this.list[this.index+1].content){this.index++;if(this.index==this.list.length-1){return this.restore(this.index)}}this.restore(++this.index)}};this.restore=function(){var n=this.list[this.index];i.document.body.innerHTML=n.content.replace(d,"");if(browser.ie){utils.each(domUtils.getElementsByTagName(i.document,"td th caption p"),function(o){if(domUtils.isEmptyNode(o)){domUtils.fillNode(i.document,o)}})}new dom.Range(i.document).moveToAddress(n.address).select();this.update();this.clearKey();i.fireEvent("reset",true)};this.getScene=function(p){var o=i.selection.getRange(),q=o.createAddress(),s=o.createAddress(false,true);i.fireEvent("beforegetscene");var n=i.body.innerHTML.replace(d,"");browser.ie&&(n=n.replace(/>&nbsp;</g,"><").replace(/\s*</g,"<").replace(/>\s*/g,">"));i.fireEvent("aftergetscene");try{!p&&o.moveToAddress(q).select(true)}catch(r){}return{address:s,content:n}};this.save=function(q,n){var p=this.getScene(n),o=this.list[this.index];if(o&&o.content==p.content&&(q?1:j(o.address,p.address))){return}this.list=this.list.slice(0,this.index+1);this.list.push(p);if(this.list.length>m){this.list.shift()}this.index=this.list.length-1;this.clearKey();this.update()};this.update=function(){this.hasRedo=!!this.list[this.index+1];this.hasUndo=!!this.list[this.index-1]};this.reset=function(){this.list=[];this.index=0;this.hasUndo=false;this.hasRedo=false;this.clearKey()};this.clearKey=function(){e=0;a=null}}i.undoManger=new b();function g(){this.undoManger.save()}i.addListener("saveScene",function(){i.undoManger.save()});i.addListener("beforeexeccommand",g);i.addListener("afterexeccommand",g);i.addListener("reset",function(o,n){if(!n){i.undoManger.reset()}});i.commands.redo=i.commands.undo={execCommand:function(n){i.undoManger[n]()},queryCommandState:function(n){return i.undoManger["has"+(n.toLowerCase()=="undo"?"Undo":"Redo")]?0:-1},notNeedUndo:1};var l={16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},e=0,a;var c=false;i.addListener("ready",function(){domUtils.on(i.body,"compositionstart",function(){c=true});domUtils.on(i.body,"compositionend",function(){c=false})});i.addshortcutkey({Undo:"ctrl+90",Redo:"ctrl+89"});i.addListener("keydown",function(o,n){var p=n.keyCode||n.which;if(!l[p]&&!n.ctrlKey&&!n.metaKey&&!n.shiftKey&&!n.altKey){if(c){return}if(i.undoManger.list.length==0||((p==8||p==46)&&a!=p)){i.fireEvent("contentchange");i.undoManger.save(true,true);a=p;return}if(i.undoManger.list.length==2&&i.undoManger.index==0&&e==0){i.undoManger.list.splice(1,1);i.undoManger.update()}a=p;e++;if(e>=h||i.undoManger.mousedown){if(i.selection.getRange().collapsed){i.fireEvent("contentchange")}i.undoManger.save(false,true);i.undoManger.mousedown=false}}});i.addListener("mousedown",function(){i.undoManger.mousedown=true})};UE.plugins.serialize=function(){var a=browser.ie,i=browser.version;function h(p){return/pt/.test(p)?p.replace(/([\d.]+)pt/g,function(q){return Math.round(parseFloat(q)*96/72)+"px"}):p}var k=this,b=k.options.autoClearEmptyNode,e=dtd.$empty,n=function(){var r=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,p=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,s={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1},v={script:1,style:1},q={li:{"$":"ul",ul:1,ol:1},dd:{"$":"dl",dl:1},dt:{"$":"dl",dl:1},option:{"$":"select",select:1},td:{"$":"tr",tr:1},th:{"$":"tr",tr:1},tr:{"$":"tbody",tbody:1,thead:1,tfoot:1,table:1},tbody:{"$":"table",table:1,colgroup:1},thead:{"$":"table",table:1},tfoot:{"$":"table",table:1},col:{"$":"colgroup",colgroup:1}};var t={table:"td",tbody:"td",thead:"td",tfoot:"td",colgroup:"col",ul:"li",ol:"li",dl:"dd",select:"option"};function u(z,D){var A,B=0,x,I;r.exec("");while((A=r.exec(z))){var G=A.index;if(G>B){var J=z.slice(B,G);if(I){I.push(J)}else{D.onText(J)}}B=r.lastIndex;if((x=A[1])){x=x.toLowerCase();if(I&&x==I._tag_name){D.onCDATA(I.join(""));I=null}if(!I){D.onTagClose(x);continue}}if(I){I.push(A[0]);continue}if((x=A[3])){if(/="/.test(x)){continue}x=x.toLowerCase();var H=A[4],w,y={},F=H&&H.slice(-1)=="/";if(H){p.exec("");while((w=p.exec(H))){var E=w[1].toLowerCase(),C=w[2]||w[3]||w[4]||"";if(!C&&s[E]){C=E}if(E=="style"){if(a&&i<=6){C=C.replace(/(?!;)\s*([\w-]+):/g,function(K,L){return L.toLowerCase()+":"})}}if(C){y[E]=C.replace(/:\s*/g,":")}}}D.onTagOpen(x,y,F);if(!I&&v[x]){I=[];I._tag_name=x}continue}if((x=A[2])){D.onComment(x)}}if(z.length>B){D.onText(z.slice(B,z.length))}}return function(z,A){var x={type:"fragment",parent:null,children:[]};var y=x;function C(D){D.parent=y;y.children.push(D)}function B(E,D){var F=E;if(q[F.tag]){while(q[y.tag]&&q[y.tag][F.tag]){y=y.parent}if(y.tag==F.tag){y=y.parent}while(q[F.tag]){if(q[F.tag][y.tag]){break}F=F.parent={type:"element",tag:q[F.tag]["$"],attributes:{},children:[F]}}}if(A){while(dtd[F.tag]&&!(y.tag=="span"?utils.extend(dtd.strong,{a:1,A:1}):(dtd[y.tag]||dtd.div))[F.tag]){if(w(y)){continue}if(!y.parent){break}y=y.parent}}F.parent=y;y.children.push(F);if(D){y=E}if(E.attributes.style){E.attributes.style=E.attributes.style.toLowerCase()}return E}function w(D){var E;if(!D.children.length&&(E=t[D.tag])){B({type:"element",tag:E,attributes:{},children:[]},true);return true}return false}u(z,{onText:function(D){while(!(dtd[y.tag]||dtd.div)["#"]){if(w(y)){continue}y=y.parent}C({type:"text",data:D})},onComment:function(D){C({type:"comment",data:D})},onCDATA:function(D){while(!(dtd[y.tag]||dtd.div)["#"]){if(w(y)){continue}y=y.parent}C({type:"cdata",data:D})},onTagOpen:function(D,F,E){E=E||e[D];B({type:"element",tag:D,attributes:F,closed:E,children:[]},!E)},onTagClose:function(D){var E=y;while(E&&D!=E.tag){E=E.parent}if(E){for(var F=y;F!==E.parent;F=F.parent){w(F)}y=E.parent}else{if(!(dtd.$removeEmpty[D]||dtd.$removeEmptyBlock[D]||D=="embed")){E={type:"element",tag:D,attributes:{},children:[]};B(E,true);w(E);y=E.parent}}}});while(y!==x){w(y);y=y.parent}return x}}();var l=function(){var q={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function p(r){return q[r]}return function(r){r=r+"";return r?r.replace(/[<>"']/g,p):""}}();var f=function(){function q(z,y){var x=z.children;var A=[];for(var w=0,v;v=x[w];w++){A.push(f(v,y))}return A.join("")}function s(w){var y=[];for(var v in w){var x=w[v];if(v=="style"){x=h(x);if(/rgba?\s*\([^)]*\)/.test(x)){x=x.replace(/rgba?\s*\(([^)]*)\)/g,function(z){return utils.fixColor("color",z)})}w[v]=utils.optCss(x.replace(/windowtext/g,"#000")).replace(/white-space[^;]+;/g,"");if(!w[v]){continue}}y.push(v+'="'+l(w[v])+'"')}return y.join(" ")}function p(w,v){return v?w.data.replace(/&nbsp;/g," "):l(w.data).replace(/ /g,"&nbsp;")}var u={li:"p",h1:"p",h2:"p",h3:"p",h4:"p",h5:"p",h6:"p",tr:"p",br:"br",div:"p",p:"p"};var r={table:1,tbody:1,ol:1,ul:1,dt:1};function t(z,y){if(z.type=="element"&&!z.children.length&&(dtd.$removeEmpty[z.tag])&&z.tag!="a"&&utils.isEmptyObject(z.attributes)&&b){return x}var v=z.tag;if(y&&v=="td"){if(!x){x=""}x+=q(z,y)+"&nbsp;&nbsp;&nbsp;"}else{var w=s(z.attributes);var x=y&&r[v]?"":"<"+(y&&u[v]!==undefined?u[v]:v)+(w?" "+w:"")+(e[v]?" />":">");if(!e[v]){if(v=="p"&&!z.children.length){x+=browser.ie?"&nbsp;":"<br/>"}x+=q(z,y);x+=(y&&r[v]?"":"</"+(y&&u[v]!==undefined?u[v]:v)+">")}}return x}return function(w,v){if(w.type=="fragment"){return q(w,v)}else{if(w.type=="element"){return t(w,v)}else{if(w.type=="text"||w.type=="cdata"){return p(w,dtd.$notTransContent[w.parent.tag])}else{if(w.type=="comment"){return"<!--"+w.data+"-->"}}}}return""}}();var o={text:"#text",comment:"#comment",cdata:"#cdata-section",fragment:"#document-fragment"};function j(s,t){var v=[0,10,12,16,18,24,32,48],u,x=utils.indexOf;switch(s.tag){case"script":s.tag="div";s.attributes._ue_org_tagName="script";s.attributes._ue_div_script=1;s.attributes._ue_script_data=s.children[0]?encodeURIComponent(s.children[0].data):"";s.attributes._ue_custom_node_=1;s.children=[];break;case"style":s.tag="div";s.attributes._ue_div_style=1;s.attributes._ue_org_tagName="style";s.attributes._ue_style_data=s.children[0]?encodeURIComponent(s.children[0].data):"";s.attributes._ue_custom_node_=1;s.children=[];break;case"img":if(s.attributes.src&&/^data:/.test(s.attributes.src)){return{type:"fragment",children:[]}}if(s.attributes.src&&/^(?:file)/.test(s.attributes.src)){if(!/(gif|bmp|png|jpg|jpeg)$/.test(s.attributes.src)){return{type:"fragment",children:[]}}s.attributes.word_img=s.attributes.src;s.attributes.src=k.options.UEDITOR_HOME_URL+"themes/default/images/spacer.gif";var w=parseInt(s.attributes.width)<128||parseInt(s.attributes.height)<43;s.attributes.style="background:url("+(w?k.options.themePath+k.options.theme+"/images/word.gif":k.options.langPath+k.options.lang+"/images/localimage.png")+") no-repeat center center;border:1px solid #ddd";t&&(t.flag=1)}if(browser.ie&&browser.version<7){s.attributes.orgSrc=s.attributes.src}s.attributes.data_ue_src=s.attributes.data_ue_src||s.attributes.src;break;case"li":var q=s.children[0];if(!q||q.type!="element"||q.tag!="p"&&dtd.p[q.tag]){var r={type:"element",tag:"p",attributes:{},parent:s};r.children=q?s.children:[browser.ie?{type:"text",data:domUtils.fillChar,parent:r}:{type:"element",tag:"br",attributes:{},closed:true,children:[],parent:r}];s.children=[r]}break;case"table":case"td":d(s);break;case"a":if(s.attributes.anchorname){s.tag="img";s.attributes={"class":"anchorclass",anchorname:s.attributes.name};s.closed=1}s.attributes.href&&(s.attributes.data_ue_src=s.attributes.href);break;case"b":s.tag=s.name="strong";break;case"i":s.tag=s.name="em";break;case"u":s.tag=s.name="span";s.attributes.style=(s.attributes.style||"")+";text-decoration:underline;";break;case"s":case"del":s.tag=s.name="span";s.attributes.style=(s.attributes.style||"")+";text-decoration:line-through;";if(s.children.length==1){q=s.children[0];if(q.tag==s.tag){s.attributes.style+=";"+q.attributes.style;s.children=q.children}}break;case"span":var p=s.attributes.style;if(p){if(!s.attributes.style||browser.webkit&&p=="white-space:nowrap;"){delete s.attributes.style}}if(browser.gecko&&browser.version<=10902&&s.parent){var y=s.parent;if(y.tag=="span"&&y.attributes&&y.attributes.style){s.attributes.style=y.attributes.style+";"+s.attributes.style}}if(utils.isEmptyObject(s.attributes)&&b){s.type="fragment"}break;case"font":s.tag=s.name="span";u=s.attributes;s.attributes={style:(u.size?"font-size:"+(v[u.size]||12)+"px":"")+";"+(u.color?"color:"+u.color:"")+";"+(u.face?"font-family:"+u.face:"")+";"+(u.style||"")};while(s.parent.tag==s.tag&&s.parent.children.length==1){s.attributes.style&&(s.parent.attributes.style?(s.parent.attributes.style+=";"+s.attributes.style):(s.parent.attributes.style=s.attributes.style));s.parent.children=s.children;s=s.parent}break;case"p":if(s.attributes.align){s.attributes.style=(s.attributes.style||"")+";text-align:"+s.attributes.align+";";delete s.attributes.align}}return s}function d(q){if(a&&q.attributes.style){var p=q.attributes.style;q.attributes.style=p.replace(/;\s*/g,";");q.attributes.style=q.attributes.style.replace(/^\s*|\s*$/,"")}}function m(p){switch(p.tag){case"div":if(p.attributes._ue_div_script){p.tag="script";p.children=[{type:"cdata",data:p.attributes._ue_script_data?decodeURIComponent(p.attributes._ue_script_data):"",parent:p}];delete p.attributes._ue_div_script;delete p.attributes._ue_script_data;delete p.attributes._ue_custom_node_;delete p.attributes._ue_org_tagName}if(p.attributes._ue_div_style){p.tag="style";p.children=[{type:"cdata",data:p.attributes._ue_style_data?decodeURIComponent(p.attributes._ue_style_data):"",parent:p}];delete p.attributes._ue_div_style;delete p.attributes._ue_style_data;delete p.attributes._ue_custom_node_;delete p.attributes._ue_org_tagName}break;case"table":!p.attributes.style&&delete p.attributes.style;if(a&&p.attributes.style){d(p)}break;case"td":case"th":if(/display\s*:\s*none/i.test(p.attributes.style)){return{type:"fragment",children:[]}}if(a&&!p.children.length){var q={type:"text",data:domUtils.fillChar,parent:p};p.children[0]=q}if(a&&p.attributes.style){d(p)}break;case"img":if(p.attributes.anchorname){p.tag="a";p.attributes={name:p.attributes.anchorname,anchorname:1};p.closed=null}else{if(p.attributes.data_ue_src){p.attributes.src=p.attributes.data_ue_src;delete p.attributes.data_ue_src}}break;case"a":if(p.attributes.data_ue_src){p.attributes.href=p.attributes.data_ue_src;delete p.attributes.data_ue_src}}return p}function g(v,u,p){if(!v.children||!v.children.length){return v}var t=v.children;for(var s=0;s<t.length;s++){var r=u(t[s],p);if(r.type=="fragment"){var q=[s,1];q.push.apply(q,r.children);t.splice.apply(t,q);if(!t.length){v={type:"fragment",children:[]}}s--}else{t[s]=r}}return v}function c(p){this.rules=p}c.prototype={rules:null,filter:function(r,u,t){u=u||this.rules;var q=u&&u.whiteList;var p=u&&u.blackList;function s(z,y){z.name=z.type=="element"?z.tag:o[z.type];if(y==null){return g(z,s,z)}if(p&&(p[z.name]||(z.attributes&&z.attributes._ue_org_tagName&&p[z.attributes._ue_org_tagName]))){t&&(t.flag=1);return{type:"fragment",children:[]}}if(q){if(z.type=="element"){if(y.type=="fragment"?q[z.name]:q[z.name]&&q[y.name][z.name]){var x;if((x=q[z.name].$)){var A=z.attributes;var w={};for(var v in x){if(A[v]){w[v]=A[v]}}z.attributes=w}}else{t&&(t.flag=1);z.type="fragment";z.name=y.name}}else{}}if(p||q){g(z,s,z)}return z}return s(r,null)},transformInput:function(q,p){function r(s){s=j(s,p);s=g(s,r,s);if(k.options.pageBreakTag&&s.type=="text"&&s.data.replace(/\s/g,"")==k.options.pageBreakTag){s.type="element";s.name=s.tag="hr";delete s.data;s.attributes={"class":"pagebreak",noshade:"noshade",size:"5",unselectable:"on",style:"moz-user-select:none;-khtml-user-select: none;"};s.children=[]}if(s.type=="text"&&!dtd.$notTransContent[s.parent.tag]){s.data=s.data.replace(/[\r\t\n]*/g,"")}return s}return r(q)},transformOutput:function(p){function q(r){if(r.tag=="hr"&&r.attributes["class"]=="pagebreak"){delete r.tag;r.type="text";r.data=k.options.pageBreakTag;delete r.children}r=m(r);r=g(r,q,r);return r}return q(p)},toHTML:f,parseHTML:n,word:UE.filterWord};k.serialize=new c(k.options.serialize||{});UE.serialize=new c({})};UE.plugins.justify=function(){var c=this,d=domUtils.isBlockElm,b={left:1,right:1,center:1,justify:1},a=function(h,e){var k=h.createBookmark(),n=function(p){return p.nodeType==1?p.tagName.toLowerCase()!="br"&&!domUtils.isBookmarkNode(p):!domUtils.isWhitespace(p)};h.enlarge(true);var o=h.createBookmark(),j=domUtils.getNextDomNode(o.start,false,n),l=h.cloneRange(),g;while(j&&!(domUtils.getPosition(j,o.end)&domUtils.POSITION_FOLLOWING)){if(j.nodeType==3||!d(j)){l.setStartBefore(j);while(j&&j!==o.end&&!d(j)){g=j;j=domUtils.getNextDomNode(j,false,null,function(p){return !d(p)})}l.setEndAfter(g);var i=l.getCommonAncestor();if(!domUtils.isBody(i)&&d(i)){domUtils.setStyles(i,utils.isString(e)?{"text-align":e}:e);j=i}else{var f=h.document.createElement("p");domUtils.setStyles(f,utils.isString(e)?{"text-align":e}:e);var m=l.extractContents();f.appendChild(m);l.insertNode(f);j=f}j=domUtils.getNextDomNode(j,false,n)}else{j=domUtils.getNextDomNode(j,true,n)}}return h.moveToBookmark(o).moveToBookmark(k)};UE.commands.justify={execCommand:function(g,h){var f=this.selection.getRange(),e;if(f.collapsed){e=this.document.createTextNode("p");f.insertNode(e)}a(f,h);if(e){f.setStartBefore(e).collapse(true);domUtils.remove(e)}f.select();return true},queryCommandValue:function(){var e=this.selection.getStart(),f=domUtils.getComputedStyle(e,"text-align");return b[f]?f:"left"},queryCommandState:function(){var f=this.selection.getStart(),e=f&&domUtils.findParentByTagName(f,["td","th","caption"],true);return e?-1:0}}};UE.plugins.paragraph=function(){var b=this,d=domUtils.isBlockElm,c=["TD","LI","PRE"],a=function(g,e,m,j){var i=g.createBookmark(),n=function(q){return q.nodeType==1?q.tagName.toLowerCase()!="br"&&!domUtils.isBookmarkNode(q):!domUtils.isWhitespace(q)},p;g.enlarge(true);var o=g.createBookmark(),h=domUtils.getNextDomNode(o.start,false,n),l=g.cloneRange(),f;while(h&&!(domUtils.getPosition(h,o.end)&domUtils.POSITION_FOLLOWING)){if(h.nodeType==3||!d(h)){l.setStartBefore(h);while(h&&h!==o.end&&!d(h)){f=h;h=domUtils.getNextDomNode(h,false,null,function(q){return !d(q)})}l.setEndAfter(f);p=g.document.createElement(e);if(m){domUtils.setAttributes(p,m);if(j&&j=="customstyle"&&m.style){p.style.cssText=m.style}}p.appendChild(l.extractContents());if(domUtils.isEmptyNode(p)){domUtils.fillChar(g.document,p)}l.insertNode(p);var k=p.parentNode;if(d(k)&&!domUtils.isBody(p.parentNode)&&utils.indexOf(c,k.tagName)==-1){if(!(j&&j=="customstyle")){k.getAttribute("dir")&&p.setAttribute("dir",k.getAttribute("dir"));k.style.cssText&&(p.style.cssText=k.style.cssText+";"+p.style.cssText);k.style.textAlign&&!p.style.textAlign&&(p.style.textAlign=k.style.textAlign);k.style.textIndent&&!p.style.textIndent&&(p.style.textIndent=k.style.textIndent);k.style.padding&&!p.style.padding&&(p.style.padding=k.style.padding)}if(m&&/h\d/i.test(k.tagName)&&!/h\d/i.test(p.tagName)){domUtils.setAttributes(k,m);if(j&&j=="customstyle"&&m.style){k.style.cssText=m.style}domUtils.remove(p,true);p=k}else{domUtils.remove(p.parentNode,true)}}if(utils.indexOf(c,k.tagName)!=-1){h=k}else{h=p}h=domUtils.getNextDomNode(h,false,n)}else{h=domUtils.getNextDomNode(h,true,n)}}return g.moveToBookmark(o).moveToBookmark(i)};b.setOpt("paragraph",{p:"",h1:"",h2:"",h3:"",h4:"",h5:"",h6:""});b.commands.paragraph={execCommand:function(i,j,h,g){var f=this.selection.getRange();if(f.collapsed){var e=this.document.createTextNode("p");f.insertNode(e);if(browser.ie){var k=e.previousSibling;if(k&&domUtils.isWhitespace(k)){domUtils.remove(k)}k=e.nextSibling;if(k&&domUtils.isWhitespace(k)){domUtils.remove(k)}}}f=a(f,j,h,g);if(e){f.setStartBefore(e).collapse(true);pN=e.parentNode;domUtils.remove(e);if(domUtils.isBlockElm(pN)&&domUtils.isEmptyNode(pN)){domUtils.fillNode(this.document,pN)}}if(browser.gecko&&f.collapsed&&f.startContainer.nodeType==1){var l=f.startContainer.childNodes[f.startOffset];if(l&&l.nodeType==1&&l.tagName.toLowerCase()==j){f.setStart(l,0).collapse(true)}}f.select();return true},queryCommandValue:function(){var e=domUtils.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return e?e.tagName.toLowerCase():""}}};UE.commands.indent={execCommand:function(){var a=this,b=a.queryCommandState("indent")?"0em":(a.options.indentValue||"2em");a.execCommand("Paragraph","p",{style:"text-indent:"+b})},queryCommandState:function(){var a=domUtils.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return a&&a.style.textIndent&&parseInt(a.style.textIndent)?1:0}};UE.plugins.rowspacing=function(){var a=this;a.setOpt({rowspacingtop:["5","10","15","20","25"],rowspacingbottom:["5","10","15","20","25"]});a.commands.rowspacing={execCommand:function(c,d,b){this.execCommand("paragraph","p",{style:"margin-"+b+":"+d+"px"});return true},queryCommandValue:function(d,c){var b=domUtils.filterNodeList(this.selection.getStartElementPath(),function(f){return domUtils.isBlockElm(f)}),e;if(b){e=domUtils.getComputedStyle(b,"margin-"+c).replace(/[^\d]/g,"");return !e?0:e}return 0}}};UE.plugins.lineheight=function(){var a=this;a.setOpt({lineheight:["1","1.5","1.75","2","3","4","5"]});a.commands.lineheight={execCommand:function(b,c){this.execCommand("paragraph","p",{style:"line-height:"+(c=="1"?"normal":c+"em")});return true},queryCommandValue:function(){var b=domUtils.filterNodeList(this.selection.getStartElementPath(),function(d){return domUtils.isBlockElm(d)});if(b){var c=domUtils.getComputedStyle(b,"line-height");return c=="normal"?1:c.replace(/[^\d.]*/ig,"")}}}};UE.plugins.table=function(){var x=this,D=true;function j(Y){if(D){throw Y}}var G=null,h=null,n="",M=false,d=null,J=false,g=null,P=null;var v=false,N=true;x.setOpt({maxColNum:20,maxRowNum:100,defaultCols:5,defaultRows:5,tdvalign:"top",cursorpath:x.options.UEDITOR_HOME_URL+"themes/default/images/cursor_",tableDragable:false});x.getUETable=C;var L={deletetable:1,inserttable:1,cellvalign:1,insertcaption:1,deletecaption:1,inserttitle:1,deletetitle:1,mergeright:1,mergedown:1,mergecells:1,insertrow:1,insertrownext:1,deleterow:1,insertcol:1,insertcolnext:1,deletecol:1,splittocells:1,splittorows:1,splittocols:1,adaptbytext:1,adaptbywindow:1,adaptbycustomer:1,insertparagraph:1,averagedistributecol:1,averagedistributerow:1};x.ready(function(){utils.cssRule("table",".selectTdClass{background-color:#edf5fa !important}table.noBorderTable td,table.noBorderTable th,table.noBorderTable caption{border:1px dashed #ddd !important}table{margin-bottom:10px;border-collapse:collapse;display:table;}td,th{ background:white; padding: 5px 10px;border: 1px solid #DDD;}caption{border:1px dashed #DDD;border-bottom:0;padding:3px;text-align:center;}th{border-top:2px solid #BBB;background:#F7F7F7;}td p{margin:0;padding:0;}",x.document);var Z,ab,Y;x.addListener("keydown",function(ag,ao){var am=this;var ap=ao.keyCode||ao.which;if(ap==8){var ah=w(am);if(ah&&ah.selectedTds.length){am.fireEvent("saveScene");if(ah.isFullCol()){am.execCommand("deletecol")}else{if(ah.isFullRow()){am.execCommand("deleterow")}else{am.fireEvent("delcells")}}domUtils.preventDefault(ao)}var ar=domUtils.findParentByTagName(am.selection.getStart(),"caption",true),al=am.selection.getRange();if(al.collapsed&&ar&&e(ar)){am.fireEvent("saveScene");var aq=ar.parentNode;domUtils.remove(ar);if(aq){al.setStart(aq.rows[0].cells[0],0).setCursor(false,true)}}am.fireEvent("saveScene")}if(ap==46){ah=w(am);if(ah){am.fireEvent("saveScene");for(var aj=0,at;at=ah.selectedTds[aj++];){domUtils.fillNode(am.document,at)}am.fireEvent("saveScene");domUtils.preventDefault(ao)}}if(ap==13){var ae=am.selection.getRange(),ar=domUtils.findParentByTagName(ae.startContainer,"caption",true);if(ar){var aq=domUtils.findParentByTagName(ar,"table");if(!ae.collapsed){ae.deleteContents();am.fireEvent("saveScene")}else{if(ar){ae.setStart(aq.rows[0].cells[0],0).setCursor(false,true)}}domUtils.preventDefault(ao);return}if(ae.collapsed){var aq=domUtils.findParentByTagName(ae.startContainer,"table");if(aq){var an=aq.rows[0].cells[0],af=domUtils.findParentByTagName(am.selection.getStart(),["td","th"],true),ak=aq.previousSibling;if(an===af&&(!ak||ak.nodeType==1&&ak.tagName=="TABLE")&&domUtils.isStartInblock(ae)){am.execCommand("insertparagraphbeforetable");domUtils.preventDefault(ao)}}}}if((ao.ctrlKey||ao.metaKey)&&ao.keyCode=="67"){Z=null;aq=w(am);if(aq){var ai=aq.selectedTds;ab=aq.isFullCol();Y=aq.isFullRow();Z=[[B(ai[0])]];for(var aj=1,at;at=ai[aj];aj++){if(at.parentNode!==ai[aj-1].parentNode){Z.push([B(at)])}else{Z[Z.length-1].push(B(at))}}}}});x.addListener("beforepaste",function(ax,aq){var aB=this;var ah=aB.selection.getRange();if(domUtils.findParentByTagName(ah.startContainer,"caption",true)){var at=aB.document.createElement("div");at.innerHTML=aq.html;aq.html=at[browser.ie?"innerText":"textContent"];return}var az=w(aB);if(Z){aB.fireEvent("saveScene");var ah=aB.selection.getRange();var ai=domUtils.findParentByTagName(ah.startContainer,["td","th"],true),aA,ae;if(ai){var aj=C(ai);if(Y){var ao=aj.getCellInfo(ai).rowIndex;if(ai.tagName=="TH"){ao++}for(var ay=0,ap;ap=Z[ay++];){var af=aj.insertRow(ao++,"td");for(var aw=0,an;an=ap[aw];aw++){var ag=af.cells[aw];if(!ag){ag=af.insertCell(aw)}ag.innerHTML=an.innerHTML;an.getAttribute("width")&&ag.setAttribute("width",an.getAttribute("width"));an.getAttribute("vAlign")&&ag.setAttribute("vAlign",an.getAttribute("vAlign"));an.getAttribute("align")&&ag.setAttribute("align",an.getAttribute("align"));an.style.cssText&&(ag.style.cssText=an.style.cssText)}for(var aw=0,an;an=af.cells[aw];aw++){if(!ap[aw]){break}an.innerHTML=ap[aw].innerHTML;ap[aw].getAttribute("width")&&an.setAttribute("width",ap[aw].getAttribute("width"));ap[aw].getAttribute("vAlign")&&an.setAttribute("vAlign",ap[aw].getAttribute("vAlign"));ap[aw].getAttribute("align")&&an.setAttribute("align",ap[aw].getAttribute("align"));ap[aw].style.cssText&&(an.style.cssText=ap[aw].style.cssText)}}}else{if(ab){al=aj.getCellInfo(ai);var am=0;for(var aw=0,ap=Z[0],an;an=ap[aw++];){am+=an.colSpan||1}aB.__hasEnterExecCommand=true;for(ay=0;ay<am;ay++){aB.execCommand("insertcol")}aB.__hasEnterExecCommand=false;ai=aj.table.rows[0].cells[al.cellIndex];if(ai.tagName=="TH"){ai=aj.table.rows[1].cells[al.cellIndex]}}for(var ay=0,ap;ap=Z[ay++];){aA=ai;for(var aw=0,an;an=ap[aw++];){if(ai){ai.innerHTML=an.innerHTML;an.getAttribute("width")&&ai.setAttribute("width",an.getAttribute("width"));an.getAttribute("vAlign")&&ai.setAttribute("vAlign",an.getAttribute("vAlign"));an.getAttribute("align")&&ai.setAttribute("align",an.getAttribute("align"));an.style.cssText&&(ai.style.cssText=an.style.cssText);ae=ai;ai=ai.nextSibling}else{var ar=an.cloneNode(true);domUtils.removeAttributes(ar,["class","rowSpan","colSpan"]);ae.parentNode.appendChild(ar)}}ai=aj.getNextCell(aA,true,true);if(!Z[ay]){break}if(!ai){var al=aj.getCellInfo(aA);aj.table.insertRow(aj.table.rows.length);aj.update();ai=aj.getVSideCell(aA,true)}}}aj.update()}else{az=aB.document.createElement("table");for(var ay=0,ap;ap=Z[ay++];){var af=az.insertRow(az.rows.length);for(var aw=0,an;an=ap[aw++];){ar=B(an);domUtils.removeAttributes(ar,["class"]);af.appendChild(ar)}if(aw==2&&ar.rowSpan>1){ar.rowSpan=1}}var av=f(aB),au=aB.body.offsetWidth-(N?parseInt(domUtils.getComputedStyle(aB.body,"margin-left"),10)*2:0)-av.tableBorder*2-(aB.options.offsetWidth||0);aB.execCommand("insertHTML","<table  "+(ab&&Y?'width="'+au+'"':"")+">"+az.innerHTML.replace(/>\s*</g,"><").replace(/\bth\b/gi,"td")+"</table>")}aB.fireEvent("contentchange");aB.fireEvent("saveScene");aq.html=""}else{var at=aB.document.createElement("div"),ak;at.innerHTML=aq.html;ak=at.getElementsByTagName("table");if(domUtils.findParentByTagName(aB.selection.getStart(),"table")){utils.each(ak,function(aC){domUtils.remove(aC)});if(domUtils.findParentByTagName(aB.selection.getStart(),"caption",true)){at.innerHTML=at[browser.ie?"innerText":"textContent"]}}else{utils.each(ak,function(aC){W(aC,true);domUtils.removeAttributes(aC,["style","border"]);utils.each(domUtils.getElementsByTagName(aC,"td"),function(aD){if(e(aD)){domUtils.fillNode(aB.document,aD)}W(aD,true)})})}aq.html=at.innerHTML}});x.addListener("afterpaste",function(){utils.each(domUtils.getElementsByTagName(x.body,"table"),function(af){if(af.offsetWidth>x.body.offsetWidth){var ae=f(x,af);af.style.width=x.body.offsetWidth-(N?parseInt(domUtils.getComputedStyle(x.body,"margin-left"),10)*2:0)-ae.tableBorder*2-(x.options.offsetWidth||0)+"px"}})});x.addListener("blur",function(){Z=null});var ad;x.addListener("keydown",function(){clearTimeout(ad);ad=setTimeout(function(){var af=x.selection.getRange(),ae=domUtils.findParentByTagName(af.startContainer,["th","td"],true);if(ae){var ag=ae.parentNode.parentNode.parentNode;if(ag.offsetWidth>ag.getAttribute("width")){ae.style.wordBreak="break-all"}}},100)});x.addListener("selectionchange",function(){A(x,false,"",null)});x.addListener("contentchange",function(){var af=this;q(af);if(w(af)){return}var ae=af.selection.getRange();var ag=ae.startContainer;ag=domUtils.findParentByTagName(ag,["td","th"],true);utils.each(domUtils.getElementsByTagName(af.document,"table"),function(ah){if(af.fireEvent("excludetable",ah)===true){return}ah.ueTable=new a(ah);utils.each(domUtils.getElementsByTagName(af.document,"td"),function(ai){if(domUtils.isEmptyBlock(ai)&&ai!==ag){domUtils.fillNode(af.document,ai);if(browser.ie&&browser.version==6){ai.innerHTML="&nbsp;"}}});utils.each(domUtils.getElementsByTagName(af.document,"th"),function(ai){if(domUtils.isEmptyBlock(ai)&&ai!==ag){domUtils.fillNode(af.document,ai);if(browser.ie&&browser.version==6){ai.innerHTML="&nbsp;"}}});ah.onmousemove=function(){af.options.tableDragable&&y(true,this,af)};ah.onmouseout=function(){A(af,false,"",null);q(af)};ah.onclick=function(ao){ao=af.window.event||ao;var am=O(ao.target||ao.srcElement);if(!am){return}var ak=C(am),ap=ak.table,al=ak.getCellInfo(am),ai,aj=af.selection.getRange();if(K(ap,am,ao,true)){var aq=ak.getCell(ak.indexTable[ak.rowsNum-1][al.colIndex].rowIndex,ak.indexTable[ak.rowsNum-1][al.colIndex].cellIndex);if(ao.shiftKey&&ak.selectedTds.length){if(ak.selectedTds[0]!==aq){ai=ak.getCellsRange(ak.selectedTds[0],aq);ak.setSelected(ai)}else{aj&&aj.selectNodeContents(aq).select()}}else{if(am!==aq){ai=ak.getCellsRange(am,aq);ak.setSelected(ai)}else{aj&&aj.selectNodeContents(aq).select()}}return}if(K(ap,am,ao)){var an=ak.getCell(ak.indexTable[al.rowIndex][ak.colsNum-1].rowIndex,ak.indexTable[al.rowIndex][ak.colsNum-1].cellIndex);if(ao.shiftKey&&ak.selectedTds.length){if(ak.selectedTds[0]!==an){ai=ak.getCellsRange(ak.selectedTds[0],an);ak.setSelected(ai)}else{aj&&aj.selectNodeContents(an).select()}}else{if(am!==an){ai=ak.getCellsRange(am,an);ak.setSelected(ai)}else{aj&&aj.selectNodeContents(an).select()}}}};ah.ondblclick=function(aj){aj=af.window.event||aj;var al=O(aj.target||aj.srcElement);if(al){var ak;if(ak=t(al,E(aj))){if(ak=="h1"){ak="h";if(K(domUtils.findParentByTagName(al,"table"),al,aj)){af.execCommand("adaptbywindow")}else{al=C(al).getPreviewCell(al);if(al){var ai=af.selection.getRange();ai.selectNodeContents(al).setCursor(true,true)}}}ak=="h"&&af.execCommand("adaptbytext")}}}});m(true)});if(!browser.ie||(browser.ie&&browser.version>7)){domUtils.on(x.document,"mousemove",p)}domUtils.on(x.document,"mouseout",function(ae){var af=ae.target||ae.srcElement;if(af.tagName=="TABLE"){A(x,false,"",null)}});x.addListener("mousedown",c);x.addListener("mouseup",l);var ac=0;x.addListener("mousedown",function(){ac=0});x.addListener("tabkeydown",function(){var af=this.selection.getRange(),ai=af.getCommonAncestor(true,true),aj=domUtils.findParentByTagName(ai,"table");if(aj){if(domUtils.findParentByTagName(ai,"caption",true)){var ae=domUtils.getElementsByTagName(aj,"th td");if(ae&&ae.length){af.setStart(ae[0],0).setCursor(false,true)}}else{var ae=domUtils.findParentByTagName(ai,["td","th"],true),ag=C(ae);ac=ae.rowSpan>1?ac:ag.getCellInfo(ae).rowIndex;var ah=ag.getTabNextCell(ae,ac);if(ah){if(e(ah)){af.setStart(ah,0).setCursor(false,true)}else{af.selectNodeContents(ah).select()}}else{x.fireEvent("saveScene");x.__hasEnterExecCommand=true;this.execCommand("insertrownext");x.__hasEnterExecCommand=false;af=this.selection.getRange();af.setStart(aj.rows[aj.rows.length-1].cells[0],0).setCursor();x.fireEvent("saveScene")}}return true}});browser.ie&&x.addListener("selectionchange",function(){A(this,false,"",null)});x.addListener("keydown",function(af,ae){var ag=this;var ai=ae.keyCode||ae.which;if(ai==8||ai==46){return}var aj=!ae.ctrlKey&&!ae.metaKey&&!ae.shiftKey&&!ae.altKey;aj&&u(domUtils.getElementsByTagName(ag.body,"td"));var ah=w(ag);if(!ah){return}aj&&ah.clearSelected()});x.addListener("beforegetcontent",function(){m(false);browser.ie&&utils.each(x.document.getElementsByTagName("caption"),function(ae){if(domUtils.isEmptyNode(ae)){ae.innerHTML="&nbsp;"}})});x.addListener("aftergetcontent",function(){m(true)});x.addListener("getAllHtml",function(){u(x.document.getElementsByTagName("td"))});x.addListener("fullscreenchanged",function(ag,ah){if(!ah){var af=this.body.offsetWidth/document.body.offsetWidth,ae=domUtils.getElementsByTagName(this.body,"table");utils.each(ae,function(ak){if(ak.offsetWidth<x.body.offsetWidth){return false}var aj=domUtils.getElementsByTagName(ak,"td"),al=[];utils.each(aj,function(an){al.push(an.offsetWidth)});for(var ai=0,am;am=aj[ai];ai++){am.setAttribute("width",Math.floor(al[ai]*af))}ak.setAttribute("width",Math.floor(R(x,N,f(x))))})}});var aa=x.execCommand;x.execCommand=function(ag){var an=this;ag=ag.toLowerCase();var ah=w(an),ak,al=new dom.Range(an.document),am=an.commands[ag]||UE.commands[ag],aq;if(!am){return}if(ah&&!L[ag]&&!am.notNeedUndo&&!an.__hasEnterExecCommand){an.__hasEnterExecCommand=true;an.fireEvent("beforeexeccommand",ag);ak=ah.selectedTds;var ae=-2,ao=-2,ap,af;for(var aj=0,ai;ai=ak[aj];aj++){if(e(ai)){al.setStart(ai,0).setCursor(false,true)}else{al.selectNodeContents(ai).select(true)}af=an.queryCommandState(ag);ap=an.queryCommandValue(ag);if(af!=-1){if(ae!==af||ao!==ap){an._ignoreContentChange=true;aq=aa.apply(an,arguments);an._ignoreContentChange=false}ae=an.queryCommandState(ag);ao=an.queryCommandValue(ag);if(domUtils.isEmptyBlock(ai)){domUtils.fillNode(an.document,ai)}}}al.setStart(ak[0],0).shrinkBoundary(true).setCursor(false,true);an.fireEvent("contentchange");an.fireEvent("afterexeccommand",ag);an.__hasEnterExecCommand=false;an._selectionChange()}else{aq=aa.apply(an,arguments)}return aq}});function W(Z,Y){S(Z,"width",true);S(Z,"height",true)}function S(aa,Z,Y){if(aa.style[Z]){Y&&aa.setAttribute(Z,parseInt(aa.style[Z],10));aa.style[Z]=""}}function O(Y){if(Y.tagName=="TD"||Y.tagName=="TH"){return Y}var Z;if(Z=domUtils.findParentByTagName(Y,"td",true)||domUtils.findParentByTagName(Y,"th",true)){return Z}return null}function e(Z){var Y=new RegExp(domUtils.fillChar,"g");if(Z[browser.ie?"innerText":"textContent"].replace(/^\s*$/,"").replace(Y,"").length>0){return 0}for(var aa in dtd.$isNotEmpty){if(Z.getElementsByTagName(aa).length){return 0}}return 1}function E(Y){if(Y.pageX||Y.pageY){return{x:Y.pageX,y:Y.pageY}}return{x:Y.clientX+x.document.body.scrollLeft-x.document.body.clientLeft,y:Y.clientY+x.document.body.scrollTop-x.document.body.clientTop}}function p(Y){try{var ac=O(Y.target||Y.srcElement),ad;if(n&&P){x.document.body.style.webkitUserSelect="none";x.selection.getNative()[browser.ie?"empty":"removeAllRanges"]();ad=E(Y);A(x,true,"",ad,ac);if(n=="h"){g.style.left=b(P,Y)+"px"}else{if(n=="v"){g.style.top=X(P,Y)+"px"}}return}if(ac){if(x.fireEvent("excludetable",ac)===true){return}ad=E(Y);var aa=t(ac,ad),Z=domUtils.findParentByTagName(ac,"table",true);if(K(Z,ac,Y,true)){if(x.fireEvent("excludetable",Z)===true){return}x.body.style.cursor="url("+x.options.cursorpath+"h.png),pointer"}else{if(K(Z,ac,Y)){if(x.fireEvent("excludetable",Z)===true){return}x.body.style.cursor="url("+x.options.cursorpath+"v.png),pointer"}else{x.body.style.cursor="text";if(/\d/.test(aa)){aa=aa.replace(/\d/,"");ac=C(ac).getPreviewCell(ac,aa=="v")}A(x,ac?!!aa:false,ac?aa:"",ad,ac)}}}else{y(false,Z,x)}}catch(ab){j(ab)}}var s;function y(Y,aa,Z){if(!Y){if(J){return}s=setTimeout(function(){!J&&d&&d.parentNode&&d.parentNode.removeChild(d)},2000)}else{F(aa,Z)}}function F(Z,Y){var ae=domUtils.getXY(Z),aa=Z.ownerDocument;if(d&&d.parentNode){return d}d=aa.createElement("div");d.contentEditable=false;d.innerHTML="";d.style.cssText="width:15px;height:15px;background-image:url("+Y.options.UEDITOR_HOME_URL+"dialogs/table/dragicon.png);position: absolute;cursor:move;top:"+(ae.y-15)+"px;left:"+(ae.x)+"px;";domUtils.unSelectable(d);d.onmouseover=function(af){J=true};d.onmouseout=function(af){J=false};domUtils.on(d,"click",function(ag,af){ac(af,this)});domUtils.on(d,"dblclick",function(ag,af){ab(af)});domUtils.on(d,"dragstart",function(ag,af){domUtils.preventDefault(af)});var ad;function ac(af,ag){clearTimeout(ad);ad=setTimeout(function(){Y.fireEvent("tableClicked",Z,ag)},300)}function ab(ag){clearTimeout(ad);var ai=C(Z),aj=Z.rows[0].cells[0],af=ai.getLastCell(),ah=ai.getCellsRange(aj,af);Y.selection.getRange().setStart(aj,0).setCursor(false,true);ai.setSelected(ah)}aa.body.appendChild(d)}function K(ac,Y,aa,ae){var af=E(aa),ad=t(Y,af);if(ae){var ab=ac.getElementsByTagName("caption")[0],Z=ab?ab.offsetHeight:0;return(ad=="v1")&&((af.y-domUtils.getXY(ac).y-Z)<8)}else{return(ad=="h1")&&((af.x-domUtils.getXY(ac).x)<8)}}function b(ad,Y){var ae=C(ad);if(ae){var ab=ae.getSameEndPosCells(ad,"x")[0],ac=ae.getSameStartPosXCells(ad)[0],aa=E(Y).x,af=(ab?domUtils.getXY(ab).x:domUtils.getXY(ae.table).x)+20,Z=ac?domUtils.getXY(ac).x+ac.offsetWidth-20:(x.body.offsetWidth+5||parseInt(domUtils.getComputedStyle(x.body,"width"),10));return aa<af?af:aa>Z?Z:aa}}function X(Z,Y){try{var ab=domUtils.getXY(Z).y,ac=E(Y).y;return ac<ab?ab:ac}catch(aa){j(aa)}}function A(ab,ac,aa,Z,Y){try{ab.body.style.cursor=aa=="h"?"col-resize":aa=="v"?"row-resize":"text";if(browser.ie){if(aa&&!v&&!w(ab)){U(ab,ab.document);I(aa,Y)}else{q(ab)}}M=ac}catch(ad){j(ad)}}function t(Z,Y){var aa=domUtils.getXY(Z);if(aa.x+Z.offsetWidth-Y.x<4){return"h"}if(Y.x-aa.x<4){return"h1"}if(aa.y+Z.offsetHeight-Y.y<4){return"v"}if(Y.y-aa.y<4){return"v1"}return""}function c(aa,Z){if(Z.button==2){var ad=w(x),Y=false;if(ad){var ae=z(x,Z);utils.each(ad.selectedTds,function(af){if(af===ae){Y=true}});if(!Y){u(domUtils.getElementsByTagName(x.body,"td"));u(domUtils.getElementsByTagName(x.body,"th"));ad.clearSelected()}else{ae=ad.selectedTds[0];setTimeout(function(){x.selection.getRange().setStart(ae,0).setCursor(false,true)},0)}}return}if(Z.shiftKey){return}u(domUtils.getElementsByTagName(x.body,"td"));u(domUtils.getElementsByTagName(x.body,"th"));utils.each(x.document.getElementsByTagName("table"),function(af){af.ueTable=null});G=z(x,Z);if(!G){return}var ab=domUtils.findParentByTagName(G,"table",true);ad=C(ab);ad&&ad.clearSelected();if(!M){x.document.body.style.webkitUserSelect="";v=true;x.addListener("mouseover",r)}else{if(browser.ie&&browser.version<8){return}var ac=t(G,E(Z));if(/\d/.test(ac)){ac=ac.replace(/\d/,"");G=C(G).getPreviewCell(G,ac=="v")}q(x);U(x,x.document);I(ac,G);v=true;n=ac;P=G}}function u(Y){utils.each(Y,function(Z){domUtils.removeClasses(Z,"selectTdClass")})}function o(Y){utils.each(Y,function(Z){domUtils.addClass(Z,"selectTdClass")})}function V(Y){if(!Y){return 0}return parseInt(domUtils.getComputedStyle(Y,"width"),10)}function Q(ag,ab){if(Math.abs(ab)<10){return}var Z=C(ag);if(Z){var ah=Z.table,ac=V(ah),ad=f(x,ah),Y=Z.getSameEndPosCells(ag,"x"),af=V(Y[0])-ad.tdPadding*2-ad.tdBorder,aa=Z.getSameStartPosXCells(ag),ae=V(aa[0])-ad.tdPadding*2-ad.tdBorder;utils.each(Y,function(ai){if(ai.style.width){ai.style.width=""}if(ab<0){ai.style.wordBreak="break-all"}ai.setAttribute("width",af+ab)});utils.each(aa,function(ai){if(ai.style.width){ai.style.width=""}if(ab>0){ai.style.wordBreak="break-all"}ai.setAttribute("width",ae-ab)});if(!ag.nextSibling){if(ah.style.width){ah.style.width=""}ah.setAttribute("width",ac+ab)}}}function i(ae,ac){if(Math.abs(ac)<10){return}var ad=C(ae);if(ad){var aa=ad.getSameEndPosCells(ae,"y"),Z=aa[0]?aa[0].offsetHeight:0;for(var ab=0,Y;Y=aa[ab++];){T(Y,ac,Z)}}}function T(Z,Y,aa){var ab=parseInt(domUtils.getComputedStyle(Z,"line-height"),10),ac=aa+Y;Y=ac<ab?ab:ac;if(Z.style.height){Z.style.height=""}Z.rowSpan==1?Z.setAttribute("height",Y):(Z.removeAttribute&&Z.removeAttribute("height"))}function l(ag,ai){if(ai.button==2){return}var af=this;var ad=af.selection.getRange(),Y=domUtils.findParentByTagName(ad.startContainer,"table",true),ab=domUtils.findParentByTagName(ad.endContainer,"table",true);if(Y||ab){if(Y===ab){Y=domUtils.findParentByTagName(ad.startContainer,["td","th","caption"],true);ab=domUtils.findParentByTagName(ad.endContainer,["td","th","caption"],true);if(Y!==ab){af.selection.clearRange()}}else{af.selection.clearRange()}}v=false;af.document.body.style.webkitUserSelect="";if((!browser.ie||(browser.ie&&browser.version>7))&&n&&P){g=af.document.getElementById("ue_tableDragLine");var aa=domUtils.getXY(P),ac=domUtils.getXY(g);switch(n){case"h":Q(P,ac.x-aa.x-P.offsetWidth);break;case"v":i(P,ac.y-aa.y-P.offsetHeight);break;default:}n="";P=null;q(af);return}if(!G){var ae=domUtils.findParentByTagName(ai.target||ai.srcElement,"td",true);if(!ae){ae=domUtils.findParentByTagName(ai.target||ai.srcElement,"th",true)}if(ae&&(ae.tagName=="TD"||ae.tagName=="TH")){if(af.fireEvent("excludetable",ae)===true){return}ad=new dom.Range(af.document);ad.setStart(ae,0).setCursor(false,true)}}else{var Z=C(G),ah=Z?Z.selectedTds[0]:null;if(ah){ad=new dom.Range(af.document);if(domUtils.isEmptyBlock(ah)){ad.setStart(ah,0).setCursor(false,true)}else{ad.selectNodeContents(ah).shrinkBoundary().setCursor(false,true)}}else{ad=af.selection.getRange().shrinkBoundary();if(!ad.collapsed){var Y=domUtils.findParentByTagName(ad.startContainer,["td","th"],true),ab=domUtils.findParentByTagName(ad.endContainer,["td","th"],true);if(Y&&!ab||!Y&&ab||Y&&ab&&Y!==ab){ad.setCursor(false,true)}}}G=null;af.removeListener("mouseover",r)}af._selectionChange(250,ai)}function r(ab,Z){var ac=this,Y=Z.target||Z.srcElement;h=domUtils.findParentByTagName(Y,"td",true)||domUtils.findParentByTagName(Y,"th",true);if(G&&h&&((G.tagName=="TD"&&h.tagName=="TD")||(G.tagName=="TH"&&h.tagName=="TH"))&&domUtils.findParentByTagName(G,"table")==domUtils.findParentByTagName(h,"table")){var ad=C(h);if(G!=h){ac.document.body.style.webkitUserSelect="none";ac.selection.getNative()[browser.ie?"empty":"removeAllRanges"]();var aa=ad.getCellsRange(G,h);ad.setSelected(aa)}else{ac.document.body.style.webkitUserSelect="";ad.clearSelected()}}Z.preventDefault?Z.preventDefault():(Z.returnValue=false)}function C(Z){var Y=Z.tagName.toLowerCase();Z=(Y=="td"||Y=="th"||Y=="caption")?domUtils.findParentByTagName(Z,"table",true):Z;if(!Z.ueTable){Z.ueTable=new a(Z)}return Z.ueTable}function w(Y){var Z=H(Y).table;if(Z&&Z.ueTable&&Z.ueTable.selectedTds.length){return Z.ueTable}return null}function U(Y,Z){if(v){return}g=Y.document.createElement("div");domUtils.setAttributes(g,{id:"ue_tableDragLine",unselectable:"on",contenteditable:false,onresizestart:"return false",ondragstart:"return false",onselectstart:"return false",style:"background-color:blue;position:absolute;padding:0;margin:0;background-image:none;border:0px none;opacity:0;filter:alpha(opacity=0)"});Y.body.appendChild(g)}function q(Z){if(v){return}var Y;while(Y=Z.document.getElementById("ue_tableDragLine")){domUtils.remove(Y)}}function I(Y,ac){if(!ac){return}var ae=domUtils.findParentByTagName(ac,"table"),ag=ae.getElementsByTagName("caption"),Z=ae.offsetWidth,ad=ae.offsetHeight-(ag.length>0?ag[0].offsetHeight:0),ab=domUtils.getXY(ae),af=domUtils.getXY(ac),aa;switch(Y){case"h":aa="height:"+ad+"px;top:"+(ab.y+(ag.length>0?ag[0].offsetHeight:0))+"px;left:"+(af.x+ac.offsetWidth-2);g.style.cssText=aa+"px;position: absolute;display:block;background-color:blue;width:1px;border:0; color:blue;opacity:.3;filter:alpha(opacity=30)";break;case"v":aa="width:"+Z+"px;left:"+ab.x+"px;top:"+(af.y+ac.offsetHeight-2);g.style.cssText=aa+"px;overflow:hidden;position: absolute;display:block;background-color:blue;height:1px;border:0;color:blue;opacity:.2;filter:alpha(opacity=20)";break;default:}}function m(Y){var aa=domUtils.getElementsByTagName(x.body,"table"),Z;for(var ab=0,ac;ac=aa[ab++];){var ad=domUtils.getElementsByTagName(ac,"td");if(ad[0]){if(Y){Z=(ad[0].style.borderColor).replace(/\s/g,"");if(/(#ffffff)|(rgb\(255,f55,255\))/ig.test(Z)){domUtils.addClass(ac,"noBorderTable")}}else{domUtils.removeClasses(ac,"noBorderTable")}}}}function R(aa,ab,Z){var Y=aa.body;return Y.offsetWidth-(ab?parseInt(domUtils.getComputedStyle(Y,"margin-left"),10)*2:0)-Z.tableBorder*2-(aa.options.offsetWidth||0)}UE.commands.inserttable={queryCommandState:function(){return H(this).table?-1:0},execCommand:function(aa,Z){function ag(al,aj,ap){var ak=[],an=al.numRows,ai=al.numCols;for(var am=0;am<an;am++){ak.push("<tr>");for(var ao=0;ao<ai;ao++){ak.push('<td width="'+ap+'"  vAlign="'+al.tdvalign+'" >'+(browser.ie?domUtils.fillChar:"<br/>")+"</td>")}ak.push("</tr>")}return'<table width="'+aj+'"   ><tbody>'+ak.join("")+"</tbody></table>"}if(!Z){Z=utils.extend({},{numCols:this.options.defaultCols,numRows:this.options.defaultRows,tdvalign:this.options.tdvalign})}var ab=this.selection.getRange(),Y=ab.startContainer,ah=domUtils.findParent(Y,function(ai){return domUtils.isBlockElm(ai)},true);var ae=this,af=f(ae),ad=R(ae,N,af)-(ah?parseInt(domUtils.getXY(ah).x,10):0),ac=Math.floor(ad/Z.numCols-af.tdPadding*2-af.tdBorder);!Z.tdvalign&&(Z.tdvalign=ae.options.tdvalign);ae.execCommand("inserthtml",ag(Z,ad,ac))}};UE.commands.insertparagraphbeforetable={queryCommandState:function(){return H(this).cell?0:-1},execCommand:function(){var Y=H(this).table;if(Y){var Z=this.document.createElement("p");Z.innerHTML=browser.ie?"&nbsp;":"<br />";Y.parentNode.insertBefore(Z,Y);this.selection.getRange().setStart(Z,0).setCursor()}}};UE.commands.deletetable={queryCommandState:function(){var Y=this.selection.getRange();return domUtils.findParentByTagName(Y.startContainer,"table",true)?0:-1},execCommand:function(ab,aa){var Y=this.selection.getRange();aa=aa||domUtils.findParentByTagName(Y.startContainer,"table",true);if(aa){var Z=aa.nextSibling;if(!Z){Z=domUtils.createElement(this.document,"p",{innerHTML:browser.ie?domUtils.fillChar:"<br/>"});aa.parentNode.insertBefore(Z,aa)}domUtils.remove(aa);Y=this.selection.getRange();if(Z.nodeType==3){Y.setStartBefore(Z)}else{Y.setStart(Z,0)}Y.setCursor(false,true);A(this,false,"",null);if(d){domUtils.remove(d)}}}};UE.commands.cellalign={queryCommandState:function(){return k(this).length?0:-1},execCommand:function(ab,ac){var Y=k(this);if(Y.length){for(var aa=0,Z;Z=Y[aa++];){Z.setAttribute("align",ac)}}}};UE.commands.cellvalign={queryCommandState:function(){return k(this).length?0:-1},execCommand:function(ac,ab){var Y=k(this);if(Y.length){for(var aa=0,Z;Z=Y[aa++];){Z.setAttribute("vAlign",ab)}}}};UE.commands.insertcaption={queryCommandState:function(){var Y=H(this).table;if(Y){return Y.getElementsByTagName("caption").length==0?1:-1}return -1},execCommand:function(){var aa=H(this).table;if(aa){var Z=this.document.createElement("caption");Z.innerHTML=browser.ie?domUtils.fillChar:"<br/>";aa.insertBefore(Z,aa.firstChild);var Y=this.selection.getRange();Y.setStart(Z,0).setCursor()}}};UE.commands.deletecaption={queryCommandState:function(){var Y=this.selection.getRange(),Z=domUtils.findParentByTagName(Y.startContainer,"table");if(Z){return Z.getElementsByTagName("caption").length==0?-1:1}return -1},execCommand:function(){var Y=this.selection.getRange(),aa=domUtils.findParentByTagName(Y.startContainer,"table");if(aa){domUtils.remove(aa.getElementsByTagName("caption")[0]);var Z=this.selection.getRange();Z.setStart(aa.rows[0].cells[0],0).setCursor()}}};UE.commands.inserttitle={queryCommandState:function(){var Y=H(this).table;if(Y){var Z=Y.rows[0];return Z.getElementsByTagName("th").length==0?0:-1}return -1},execCommand:function(){var Z=H(this).table;if(Z){C(Z).insertRow(0,"th")}var Y=Z.getElementsByTagName("th")[0];this.selection.getRange().setStart(Y,0).setCursor(false,true)}};UE.commands.deletetitle={queryCommandState:function(){var Y=H(this).table;if(Y){var Z=Y.rows[0];return Z.getElementsByTagName("th").length?0:-1}return -1},execCommand:function(){var Y=H(this).table;if(Y){domUtils.remove(Y.rows[0])}var Z=Y.getElementsByTagName("td")[0];this.selection.getRange().setStart(Z,0).setCursor(false,true)}};UE.commands.mergeright={queryCommandState:function(ac){var ad=H(this);if(!ad.cell){return -1}var ab=C(ad.table);if(ab.selectedTds.length){return -1}var aa=ab.getCellInfo(ad.cell),Z=aa.colIndex+aa.colSpan;if(Z>=ab.colsNum){return -1}var Y=ab.indexTable[aa.rowIndex][Z];return(Y.rowIndex==aa.rowIndex&&Y.rowSpan==aa.rowSpan)?0:-1},execCommand:function(ac){var aa=this.selection.getRange(),Z=aa.createBookmark(true);var Y=H(this).cell,ab=C(Y);ab.mergeRight(Y);aa.moveToBookmark(Z).select()}};UE.commands.mergedown={queryCommandState:function(ac){var ad=H(this),Y=ad.cell;if(!Y||Y.tagName=="TH"){return -1}var ab=C(ad.table);if(ab.selectedTds.length){return -1}var Z=ab.getCellInfo(ad.cell),ae=Z.rowIndex+Z.rowSpan;if(ae>=ab.rowsNum){return -1}var aa=ab.indexTable[ae][Z.colIndex];return(aa.colIndex==Z.colIndex&&aa.colSpan==Z.colSpan)&&ad.cell.tagName!=="TH"?0:-1},execCommand:function(){var aa=this.selection.getRange(),Z=aa.createBookmark(true);var Y=H(this).cell,ab=C(Y);ab.mergeDown(Y);aa.moveToBookmark(Z).select()}};UE.commands.mergecells={queryCommandState:function(){return w(this)?0:-1},execCommand:function(){var aa=w(this);if(aa&&aa.selectedTds.length){var Y=aa.selectedTds[0];w(this).mergeRange();var Z=this.selection.getRange();if(domUtils.isEmptyBlock(Y)){Z.setStart(Y,0).collapse(true)}else{Z.selectNodeContents(Y)}Z.select()}}};UE.commands.insertrow={queryCommandState:function(){var Z=H(this),Y=Z.cell;return Y&&Y.tagName=="TD"&&C(Z.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var ab=this.selection.getRange(),aa=ab.createBookmark(true);var Z=H(this).cell,af=C(Z),ad=af.getCellInfo(Z);if(!af.selectedTds.length){af.insertRow(ad.rowIndex,Z)}else{var ac=af.cellsRange;for(var ae=0,Y=ac.endRowIndex-ac.beginRowIndex+1;ae<Y;ae++){af.insertRow(ac.beginRowIndex,Z)}}ab.moveToBookmark(aa).select()}};UE.commands.insertrownext={queryCommandState:function(){var Z=H(this),Y=Z.cell;return Y&&(Y.tagName=="TD")&&C(Z.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var ab=this.selection.getRange(),aa=ab.createBookmark(true);var Z=H(this).cell,af=C(Z),ad=af.getCellInfo(Z);if(!af.selectedTds.length){af.insertRow(ad.rowIndex+ad.rowSpan,Z)}else{var ac=af.cellsRange;for(var ae=0,Y=ac.endRowIndex-ac.beginRowIndex+1;ae<Y;ae++){af.insertRow(ac.endRowIndex+1,Z)}}ab.moveToBookmark(aa).select()}};UE.commands.deleterow={queryCommandState:function(){var Y=H(this);if(!Y.cell){return -1}},execCommand:function(){var ag=H(this).cell,ab=C(ag),Y=ab.cellsRange,ac=ab.getCellInfo(ag),aa=ab.getVSideCell(ag),ai=ab.getVSideCell(ag,true),Z=this.selection.getRange();if(utils.isEmptyObject(Y)){ab.deleteRow(ac.rowIndex)}else{for(var af=Y.beginRowIndex;af<Y.endRowIndex+1;af++){ab.deleteRow(Y.beginRowIndex)}}var ah=ab.table;if(!ah.getElementsByTagName("td").length){var ad=ah.nextSibling;domUtils.remove(ah);if(ad){Z.setStart(ad,0).setCursor(false,true)}}else{if(ac.rowSpan==1||ac.rowSpan==Y.endRowIndex-Y.beginRowIndex+1){if(ai||aa){Z.selectNodeContents(ai||aa).setCursor(false,true)}}else{var ae=ab.getCell(ac.rowIndex,ab.indexTable[ac.rowIndex][ac.colIndex].cellIndex);if(ae){Z.selectNodeContents(ae).setCursor(false,true)}}}}};UE.commands.insertcol={queryCommandState:function(Z){var aa=H(this),Y=aa.cell;return Y&&(Y.tagName=="TD"||Y.tagName=="TH")&&C(aa.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(Z){var Y=this.selection.getRange(),ab=Y.createBookmark(true);if(this.queryCommandState(Z)==-1){return}var ag=H(this).cell,aa=C(ag),ac=aa.getCellInfo(ag);if(!aa.selectedTds.length){aa.insertCol(ac.colIndex,ag)}else{var ae=aa.cellsRange;for(var ad=0,af=ae.endColIndex-ae.beginColIndex+1;ad<af;ad++){aa.insertCol(ae.beginColIndex,ag)}}Y.moveToBookmark(ab).select(true)}};UE.commands.insertcolnext={queryCommandState:function(){var Z=H(this),Y=Z.cell;return Y&&C(Z.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(){var ab=this.selection.getRange(),aa=ab.createBookmark(true);var Z=H(this).cell,af=C(Z),ad=af.getCellInfo(Z);if(!af.selectedTds.length){af.insertCol(ad.colIndex+ad.colSpan,Z)}else{var ac=af.cellsRange;for(var ae=0,Y=ac.endColIndex-ac.beginColIndex+1;ae<Y;ae++){af.insertCol(ac.endColIndex+1,Z)}}ab.moveToBookmark(aa).select()}};UE.commands.deletecol={queryCommandState:function(){var Y=H(this);if(!Y.cell){return -1}},execCommand:function(){var af=H(this).cell,aa=C(af),ae=aa.cellsRange,ab=aa.getCellInfo(af),Z=aa.getHSideCell(af),ah=aa.getHSideCell(af,true);if(utils.isEmptyObject(ae)){aa.deleteCol(ab.colIndex)}else{for(var ad=ae.beginColIndex;ad<ae.endColIndex+1;ad++){aa.deleteCol(ae.beginColIndex)}}var ag=aa.table,Y=this.selection.getRange();if(!ag.getElementsByTagName("td").length){var ac=ag.nextSibling;domUtils.remove(ag);if(ac){Y.setStart(ac,0).setCursor(false,true)}}else{if(domUtils.inDoc(af,this.document)){Y.setStart(af,0).setCursor(false,true)}else{if(ah&&domUtils.inDoc(ah,this.document)){Y.selectNodeContents(ah).setCursor(false,true)}else{if(Z&&domUtils.inDoc(Z,this.document)){Y.selectNodeContents(Z).setCursor(true,true)}}}}}};UE.commands.splittocells={queryCommandState:function(){var aa=H(this),Y=aa.cell;if(!Y){return -1}var Z=C(aa.table);if(Z.selectedTds.length>0){return -1}return Y&&(Y.colSpan>1||Y.rowSpan>1)?0:-1},execCommand:function(){var aa=this.selection.getRange(),Z=aa.createBookmark(true);var Y=H(this).cell,ab=C(Y);ab.splitToCells(Y);aa.moveToBookmark(Z).select()}};UE.commands.splittorows={queryCommandState:function(){var aa=H(this),Y=aa.cell;if(!Y){return -1}var Z=C(aa.table);if(Z.selectedTds.length>0){return -1}return Y&&Y.rowSpan>1?0:-1},execCommand:function(){var aa=this.selection.getRange(),Z=aa.createBookmark(true);var Y=H(this).cell,ab=C(Y);ab.splitToRows(Y);aa.moveToBookmark(Z).select()}};UE.commands.splittocols={queryCommandState:function(){var aa=H(this),Y=aa.cell;if(!Y){return -1}var Z=C(aa.table);if(Z.selectedTds.length>0){return -1}return Y&&Y.colSpan>1?0:-1},execCommand:function(){var aa=this.selection.getRange(),Z=aa.createBookmark(true);var Y=H(this).cell,ab=C(Y);ab.splitToCols(Y);aa.moveToBookmark(Z).select()}};function f(aa,ab){var af={thin:"0px",medium:"1px",thick:"2px"},Z,ad,ac,Y;if(!ab){ab=aa.document.createElement("table");ab.insertRow(0).insertCell(0).innerHTML="xxx";aa.body.appendChild(ab);var ae=ab.getElementsByTagName("td")[0];Y=domUtils.getComputedStyle(ab,"border-left-width");Z=parseInt(af[Y]||Y,10);Y=domUtils.getComputedStyle(ae,"padding-left");ad=parseInt(af[Y]||Y,10);Y=domUtils.getComputedStyle(ae,"border-left-width");ac=parseInt(af[Y]||Y,10);domUtils.remove(ab);return{tableBorder:Z,tdPadding:ad,tdBorder:ac}}else{ae=ab.getElementsByTagName("td")[0];Y=domUtils.getComputedStyle(ab,"border-left-width");Z=parseInt(af[Y]||Y,10);Y=domUtils.getComputedStyle(ae,"padding-left");ad=parseInt(af[Y]||Y,10);Y=domUtils.getComputedStyle(ae,"border-left-width");ac=parseInt(af[Y]||Y,10);return{tableBorder:Z,tdPadding:ad,tdBorder:ac}}}UE.commands.adaptbytext=UE.commands.adaptbywindow={queryCommandState:function(){return H(this).table?0:-1},execCommand:function(ad){var ae=H(this),ac=ae.table;if(ac){var ab=ac.getElementsByTagName("td");utils.each(ab,function(af){af.removeAttribute("width")});if(ad=="adaptbywindow"){ac.setAttribute("width",R(this,N,f(this,ac)));utils.each(ab,function(af){af.setAttribute("width",af.offsetWidth+"")})}else{ac.style.width="";ac.removeAttribute("width");var Z=f(x,ac);var aa=ac.offsetWidth,Y=x.body.offsetWidth;if(aa>Y){ac.setAttribute("width",R(x,N,Z))}}}}};UE.commands.averagedistributecol={queryCommandState:function(){var Y=w(this);if(!Y){return -1}return Y.isFullRow()||Y.isFullCol()?0:-1},execCommand:function(ac){var aa=this,ab=w(aa);function Z(){var ai=ab.table,ad,ag=0,ak=0,al=f(aa,ai);if(ab.isFullRow()){ag=ai.offsetWidth;ak=ab.colsNum}else{var ae=ab.cellsRange.beginColIndex,ah=ab.cellsRange.endColIndex,af;for(var aj=ae;aj<=ah;){af=ab.selectedTds[aj];ag+=af.offsetWidth;aj+=af.colSpan;ak+=1}}ad=Math.ceil(ag/ak)-al.tdBorder*2-al.tdPadding*2;return ad}function Y(ae){utils.each(domUtils.getElementsByTagName(ab.table,"th"),function(af){af.setAttribute("width","")});var ad=ab.isFullRow()?domUtils.getElementsByTagName(ab.table,"td"):ab.selectedTds;utils.each(ad,function(af){if(af.colSpan==1){af.setAttribute("width",ae)}})}if(ab&&ab.selectedTds.length){Y(Z())}}};UE.commands.averagedistributerow={queryCommandState:function(){var Y=w(this);if(!Y){return -1}if(Y.selectedTds&&/th/ig.test(Y.selectedTds[0].tagName)){return -1}return Y.isFullRow()||Y.isFullCol()?0:-1},execCommand:function(ab){var Z=this,aa=w(Z);function Y(){var ad,ao,ar=0,aj=aa.table,aq=f(Z,aj),ae=parseInt(domUtils.getComputedStyle(aj.getElementsByTagName("td")[0],"padding-top"));if(aa.isFullCol()){var ap=domUtils.getElementsByTagName(aj,"caption"),ag=domUtils.getElementsByTagName(aj,"th"),ai,an;if(ap.length>0){ai=ap[0].offsetHeight}if(ag.length>0){an=ag[0].offsetHeight}ar=aj.offsetHeight-(ai||0)-(an||0);ao=ag.length==0?aa.rowsNum:(aa.rowsNum-1)}else{var af=aa.cellsRange.beginRowIndex,ah=aa.cellsRange.endRowIndex,am=0,al=domUtils.getElementsByTagName(aj,"tr");for(var ak=af;ak<=ah;ak++){ar+=al[ak].offsetHeight;am+=1}ao=am}if(browser.ie&&browser.version<9){ad=Math.ceil(ar/ao)}else{ad=Math.ceil(ar/ao)-aq.tdBorder*2-ae*2}return ad}function ac(ae){var ad=aa.isFullCol()?domUtils.getElementsByTagName(aa.table,"td"):aa.selectedTds;utils.each(ad,function(af){if(af.rowSpan==1){af.setAttribute("height",ae)}})}if(aa&&aa.selectedTds.length){ac(Y())}}};UE.commands.cellalignment={queryCommandState:function(){return H(this).table?0:-1},execCommand:function(ac,ab){var Z=this,aa=w(Z);if(!aa){var ad=Z.selection.getStart(),Y=ad&&domUtils.findParentByTagName(ad,["td","th","caption"],true);if(!/caption/ig.test(Y.tagName)){domUtils.setAttributes(Y,ab)}else{Y.style.textAlign=ab.align;Y.style.verticalAlign=ab.vAlign}Z.selection.getRange().setCursor(true)}else{utils.each(aa.selectedTds,function(ae){domUtils.setAttributes(ae,ab)})}}};UE.commands.tablealignment={queryCommandState:function(){return H(this).table?0:-1},execCommand:function(ab,aa){var Z=this,ad=Z.selection.getStart(),Y=ad&&domUtils.findParentByTagName(ad,["table"],true);if(Y){var ac={};ac[aa[0]]=aa[1];Y.style[utils.cssStyleToDomStyle("float")]="";Y.style.margin="";domUtils.setStyles(Y,ac)}}};UE.commands.edittable={queryCommandState:function(){return H(this).table?0:-1},execCommand:function(ac,aa){var Z=this.selection.getRange(),ab=domUtils.findParentByTagName(Z.startContainer,"table");if(ab){var Y=domUtils.getElementsByTagName(ab,"td").concat(domUtils.getElementsByTagName(ab,"th"),domUtils.getElementsByTagName(ab,"caption"));utils.each(Y,function(ad){ad.style.borderColor=aa})}}};UE.commands.edittd={queryCommandState:function(){return H(this).table?0:-1},execCommand:function(ac,Z){var aa=this,ab=w(aa);if(!ab){var ad=aa.selection.getStart(),Y=ad&&domUtils.findParentByTagName(ad,["td","th","caption"],true);if(Y){Y.style.backgroundColor=Z}}else{utils.each(ab.selectedTds,function(ae){ae.style.backgroundColor=Z})}}};function a(Y){this.table=Y;this.indexTable=[];this.selectedTds=[];this.cellsRange={};this.update(Y)}a.prototype={getMaxRows:function(){var ad=this.table.rows,Y=1;for(var ab=0,ae;ae=ad[ab];ab++){var ac=1;for(var aa=0,Z;Z=ae.cells[aa++];){ac=Math.max(Z.rowSpan||1,ac)}Y=Math.max(ac+ab,Y)}return Y},getMaxCols:function(){var ag=this.table.rows,aa=0,Y={};for(var ad=0,af;af=ag[ad];ad++){var Z=0;for(var ac=0,ae;ae=af.cells[ac++];){Z+=(ae.colSpan||1);if(ae.rowSpan&&ae.rowSpan>1){for(var ab=1;ab<ae.rowSpan;ab++){if(!Y["row_"+(ad+ab)]){Y["row_"+(ad+ab)]=(ae.colSpan||1)}else{Y["row_"+(ad+ab)]++}}}}Z+=Y["row_"+ad]||0;aa=Math.max(Z,aa)}return aa},getCellColIndex:function(Y){},getHSideCell:function(Z,ad){try{var ac=this.getCellInfo(Z),ab,af;var Y=this.selectedTds.length,aa=this.cellsRange;if((!ad&&(!Y?!ac.colIndex:!aa.beginColIndex))||(ad&&(!Y?(ac.colIndex==(this.colsNum-1)):(aa.endColIndex==this.colsNum-1)))){return null}ab=!Y?ac.rowIndex:aa.beginRowIndex;af=!ad?(!Y?(ac.colIndex<1?0:(ac.colIndex-1)):aa.beginColIndex-1):(!Y?ac.colIndex+1:aa.endColIndex+1);return this.getCell(this.indexTable[ab][af].rowIndex,this.indexTable[ab][af].cellIndex)}catch(ae){j(ae)}},getTabNextCell:function(Y,ae){var aa=this.getCellInfo(Y),ad=ae||aa.rowIndex,Z=aa.colIndex+1+(aa.colSpan-1),ab;try{ab=this.getCell(this.indexTable[ad][Z].rowIndex,this.indexTable[ad][Z].cellIndex)}catch(ac){try{ad=ad*1+1;Z=0;ab=this.getCell(this.indexTable[ad][Z].rowIndex,this.indexTable[ad][Z].cellIndex)}catch(ac){}}return ab},getVSideCell:function(ag,Y,ac){try{var aa=this.getCellInfo(ag),af,Z;var ad=this.selectedTds.length&&!ac,ab=this.cellsRange;if((!Y&&(aa.rowIndex==0))||(Y&&(!ad?(aa.rowIndex+aa.rowSpan>this.rowsNum-1):(ab.endRowIndex==this.rowsNum-1)))){return null}af=!Y?(!ad?aa.rowIndex-1:ab.beginRowIndex-1):(!ad?(aa.rowIndex+aa.rowSpan):ab.endRowIndex+1);Z=!ad?aa.colIndex:ab.beginColIndex;return this.getCell(this.indexTable[af][Z].rowIndex,this.indexTable[af][Z].cellIndex)}catch(ae){j(ae)}},getSameEndPosCells:function(ah,Z){try{var ae=(Z.toLowerCase()==="x"),aa=domUtils.getXY(ah)[ae?"x":"y"]+ah["offset"+(ae?"Width":"Height")],aj=this.table.rows,ai=null,af=[];for(var ac=0;ac<this.rowsNum;ac++){ai=aj[ac].cells;for(var ab=0,ag;ag=ai[ab++];){var Y=domUtils.getXY(ag)[ae?"x":"y"]+ag["offset"+(ae?"Width":"Height")];if(Y>aa&&ae){break}if(ah==ag||aa==Y){if(ag[ae?"colSpan":"rowSpan"]==1){af.push(ag)}if(ae){break}}}}return af}catch(ad){j(ad)}},setCellContent:function(Y,Z){Y.innerHTML=Z||(browser.ie?domUtils.fillChar:"<br />")},cloneCell:B,getSameStartPosXCells:function(af){try{var Y=domUtils.getXY(af).x+af.offsetWidth,ah=this.table.rows,ag,ad=[];for(var aa=0;aa<this.rowsNum;aa++){ag=ah[aa].cells;for(var Z=0,ae;ae=ag[Z++];){var ab=domUtils.getXY(ae).x;if(ab>Y){break}if(ab==Y&&ae.colSpan==1){ad.push(ae);break}}}return ad}catch(ac){j(ac)}},update:function(at){this.table=at||this.table;this.selectedTds=[];this.cellsRange={};this.indexTable=[];var ai=this.table.rows,au=ai.length,aa=this.getMaxCols();this.rowsNum=au;this.colsNum=aa;for(var ap=0,ar=ai.length;ap<ar;ap++){this.indexTable[ap]=new Array(aa)}for(var aj=0,af;af=ai[aj];aj++){for(var ah=0,Y,ac=af.cells;Y=ac[ah];ah++){if(Y.rowSpan>au){Y.rowSpan=au}var al=ah,ad=Y.rowSpan||1,ag=Y.colSpan||1;while(this.indexTable[aj][al]){al++}for(var ao=0;ao<ad;ao++){for(var am=0;am<ag;am++){this.indexTable[aj+ao][al+am]={rowIndex:aj,cellIndex:ah,colIndex:al,rowSpan:ad,colSpan:ag}}}}}for(ao=0;ao<au;ao++){for(am=0;am<aa;am++){if(this.indexTable[ao][am]===undefined){af=ai[ao];Y=af.cells[af.cells.length-1];Y=Y?Y.cloneNode(true):this.table.ownerDocument.createElement("td");this.setCellContent(Y);if(Y.colSpan!==1){Y.colSpan=1}if(Y.rowSpan!==1){Y.rowSpan=1}af.appendChild(Y);this.indexTable[ao][am]={rowIndex:ao,cellIndex:Y.cellIndex,colIndex:am,rowSpan:1,colSpan:1}}}}var aq=domUtils.getElementsByTagName(this.table,"td"),ak=[];utils.each(aq,function(av){if(domUtils.hasClass(av,"selectTdClass")){ak.push(av)}});if(ak.length){var ae=ak[0],ab=ak[ak.length-1],Z=this.getCellInfo(ae),an=this.getCellInfo(ab);this.selectedTds=ak;this.cellsRange={beginRowIndex:Z.rowIndex,beginColIndex:Z.colIndex,endRowIndex:an.rowIndex+an.rowSpan-1,endColIndex:an.colIndex+an.colSpan-1}}},getCellInfo:function(Y){if(!Y){return}var ab=Y.cellIndex,ae=Y.parentNode.rowIndex,ac=this.indexTable[ae],ad=this.colsNum;for(var aa=ab;aa<ad;aa++){var Z=ac[aa];if(Z.rowIndex===ae&&Z.cellIndex===ab){return Z}}},getCell:function(Z,Y){return Z<this.rowsNum&&this.table.rows[Z].cells[Y]||null},deleteCell:function(Y,aa){aa=typeof aa=="number"?aa:Y.parentNode.rowIndex;var Z=this.table.rows[aa];Z.deleteCell(Y.cellIndex)},getCellsRange:function(Z,Y){function ac(au,al,am,ao){var an=au,ap=al,ar=am,aj=ao,ak,at,aq;if(au>0){for(at=al;at<ao;at++){ak=ah.indexTable[au][at];aq=ak.rowIndex;if(aq<au){an=Math.min(aq,an)}}}if(ao<ah.colsNum){for(aq=au;aq<am;aq++){ak=ah.indexTable[aq][ao];at=ak.colIndex+ak.colSpan-1;if(at>ao){aj=Math.max(at,aj)}}}if(am<ah.rowsNum){for(at=al;at<ao;at++){ak=ah.indexTable[am][at];aq=ak.rowIndex+ak.rowSpan-1;if(aq>am){ar=Math.max(aq,ar)}}}if(al>0){for(aq=au;aq<am;aq++){ak=ah.indexTable[aq][al];at=ak.colIndex;if(at<al){ap=Math.min(ak.colIndex,ap)}}}if(an!=au||ap!=al||ar!=am||aj!=ao){return ac(an,ap,ar,aj)}else{return{beginRowIndex:au,beginColIndex:al,endRowIndex:am,endColIndex:ao}}}try{var ah=this,ab=ah.getCellInfo(Z);if(Z===Y){return{beginRowIndex:ab.rowIndex,beginColIndex:ab.colIndex,endRowIndex:ab.rowIndex+ab.rowSpan-1,endColIndex:ab.colIndex+ab.colSpan-1}}var aa=ah.getCellInfo(Y);var ai=Math.min(ab.rowIndex,aa.rowIndex),ad=Math.min(ab.colIndex,aa.colIndex),ae=Math.max(ab.rowIndex+ab.rowSpan-1,aa.rowIndex+aa.rowSpan-1),af=Math.max(ab.colIndex+ab.colSpan-1,aa.colIndex+aa.colSpan-1);return ac(ai,ad,ae,af)}catch(ag){if(D){throw ag}}},getCells:function(ad){this.clearSelected();var ak=ad.beginRowIndex,Z=ad.beginColIndex,ac=ad.endRowIndex,ae=ad.endColIndex,Y,ag,aj,af={},ai=[];for(var ab=ak;ab<=ac;ab++){for(var aa=Z;aa<=ae;aa++){Y=this.indexTable[ab][aa];ag=Y.rowIndex;aj=Y.colIndex;var ah=ag+"|"+aj;if(af[ah]){continue}af[ah]=1;if(ag<ab||aj<aa||ag+Y.rowSpan-1>ac||aj+Y.colSpan-1>ae){return null}ai.push(this.getCell(ag,Y.cellIndex))}}return ai},clearSelected:function(){u(this.selectedTds);this.selectedTds=[];this.cellsRange={}},setSelected:function(Y){var Z=this.getCells(Y);o(Z);this.selectedTds=Z;this.cellsRange=Y},isFullRow:function(){var Y=this.cellsRange;return(Y.endColIndex-Y.beginColIndex+1)==this.colsNum},isFullCol:function(){var Z=this.cellsRange,aa=this.table,Y=aa.getElementsByTagName("th"),ab=Z.endRowIndex-Z.beginRowIndex+1;return !Y.length?ab==this.rowsNum:ab==this.rowsNum||(ab==this.rowsNum-1)},getNextCell:function(ag,Y,ac){try{var aa=this.getCellInfo(ag),af,Z;var ad=this.selectedTds.length&&!ac,ab=this.cellsRange;if((!Y&&(aa.rowIndex==0))||(Y&&(!ad?(aa.rowIndex+aa.rowSpan>this.rowsNum-1):(ab.endRowIndex==this.rowsNum-1)))){return null}af=!Y?(!ad?aa.rowIndex-1:ab.beginRowIndex-1):(!ad?(aa.rowIndex+aa.rowSpan):ab.endRowIndex+1);Z=!ad?aa.colIndex:ab.beginColIndex;return this.getCell(this.indexTable[af][Z].rowIndex,this.indexTable[af][Z].cellIndex)}catch(ae){j(ae)}},getPreviewCell:function(Z,af){try{var ac=this.getCellInfo(Z),ab,ae;var Y=this.selectedTds.length,aa=this.cellsRange;if((!af&&(!Y?!ac.colIndex:!aa.beginColIndex))||(af&&(!Y?(ac.rowIndex>(this.colsNum-1)):(aa.endColIndex==this.colsNum-1)))){return null}ab=!af?(!Y?ac.rowIndex:aa.beginRowIndex):(!Y?(ac.rowIndex<1?0:(ac.rowIndex-1)):aa.beginRowIndex);ae=!af?(!Y?(ac.colIndex<1?0:(ac.colIndex-1)):aa.beginColIndex-1):(!Y?ac.colIndex:aa.endColIndex+1);return this.getCell(this.indexTable[ab][ae].rowIndex,this.indexTable[ab][ae].cellIndex)}catch(ad){j(ad)}},moveContent:function(Z,Y){if(e(Y)){return}if(e(Z)){Z.innerHTML=Y.innerHTML;return}var aa=Z.lastChild;if(aa.nodeType==3||!dtd.$block[aa.tagName]){Z.appendChild(Z.ownerDocument.createElement("br"))}while(aa=Y.firstChild){Z.appendChild(aa)}},mergeRight:function(Y){var ab=this.getCellInfo(Y),aa=ab.colIndex+ab.colSpan,Z=this.indexTable[ab.rowIndex][aa],ac=this.getCell(Z.rowIndex,Z.cellIndex);Y.colSpan=ab.colSpan+Z.colSpan;Y.removeAttribute("width");this.moveContent(Y,ac);this.deleteCell(ac,Z.rowIndex);this.update()},mergeDown:function(Y){var aa=this.getCellInfo(Y),ac=aa.rowIndex+aa.rowSpan,ab=this.indexTable[ac][aa.colIndex],Z=this.getCell(ab.rowIndex,ab.cellIndex);Y.rowSpan=aa.rowSpan+ab.rowSpan;Y.removeAttribute("height");this.moveContent(Y,Z);this.deleteCell(Z,ab.rowIndex);this.update()},mergeRange:function(){var aa=this.cellsRange,ab=this.getCell(aa.beginRowIndex,this.indexTable[aa.beginRowIndex][aa.beginColIndex].cellIndex);if(ab.tagName=="TH"&&aa.endRowIndex!==aa.beginRowIndex){var ac=this.indexTable,Y=this.getCellInfo(ab);ab=this.getCell(1,ac[1][Y.colIndex].cellIndex);aa=this.getCellsRange(ab,this.getCell(ac[this.rowsNum-1][Y.colIndex].rowIndex,ac[this.rowsNum-1][Y.colIndex].cellIndex))}var ag=this.getCells(aa),ad=ag.length,af;while(ad--){af=ag[ad];if(af!==ab){this.moveContent(ab,af);this.deleteCell(af)}}ab.rowSpan=aa.endRowIndex-aa.beginRowIndex+1;ab.rowSpan>1&&ab.removeAttribute("height");ab.colSpan=aa.endColIndex-aa.beginColIndex+1;ab.colSpan>1&&ab.removeAttribute("width");if(ab.rowSpan==this.rowsNum&&ab.colSpan!=1){ab.colSpan=1}if(ab.colSpan==this.colsNum&&ab.rowSpan!=1){var ae=ab.parentNode.rowIndex;for(var Z=0;Z<ab.rowSpan-1;Z++){var ah=this.table.rows[ae+1];ah.parentNode.removeChild(ah)}ab.rowSpan=1}this.update()},insertRow:function(ac,ag){var aa=this.colsNum,ah=this.table,ai=ah.insertRow(ac),af,Y=parseInt((ah.offsetWidth-aa*20-aa-1)/aa,10);if(ac==0||ac==this.rowsNum){for(var ae=0;ae<aa;ae++){af=this.cloneCell(ag,true);this.setCellContent(af);af.getAttribute("vAlign")&&af.setAttribute("vAlign",af.getAttribute("vAlign"));ai.appendChild(af)}}else{var ad=this.indexTable[ac],ab=0;for(ae=0;ae<aa;ae++){var Z=ad[ae];if(Z.rowIndex<ac){af=this.getCell(Z.rowIndex,Z.cellIndex);af.rowSpan=Z.rowSpan+1}else{af=this.cloneCell(ag,true);this.setCellContent(af);ai.appendChild(af)}}}this.update();return ai},deleteRow:function(al){var ah=this.table.rows[al],ai=this.indexTable[al],ad=this.colsNum,aj=0;for(var am=0;am<ad;){var ak=ai[am],Z=this.getCell(ak.rowIndex,ak.cellIndex);if(Z.rowSpan>1){if(ak.rowIndex==al){var ao=Z.cloneNode(true);ao.rowSpan=Z.rowSpan-1;ao.innerHTML="";Z.rowSpan=1;var af=al+1,an=this.table.rows[af],ap,aa=this.getPreviewMergedCellsNum(af,am)-aj;if(aa<am){ap=am-aa-1;domUtils.insertAfter(an.cells[ap],ao)}else{if(an.cells.length){an.insertBefore(ao,an.cells[0])}}aj+=1}}am+=Z.colSpan||1}var ab=[],ag={};for(am=0;am<ad;am++){var ae=ai[am].rowIndex,ac=ai[am].cellIndex,aq=ae+"_"+ac;if(ag[aq]){continue}ag[aq]=1;Z=this.getCell(ae,ac);ab.push(Z)}var Y=[];utils.each(ab,function(ar){if(ar.rowSpan==1){ar.parentNode.removeChild(ar)}else{Y.push(ar)}});utils.each(Y,function(ar){ar.rowSpan--});ah.parentNode.removeChild(ah);this.update()},insertCol:function(ag,ai,ae){var Y=this.rowsNum,af=0,aa,ah,ac=parseInt((this.table.offsetWidth-(this.colsNum+1)*20-(this.colsNum+1))/(this.colsNum+1),10);function ad(am,ak,aj){if(am==0){var al=ak.nextSibling||ak.previousSibling;if(al.tagName=="TH"){al=ak.ownerDocument.createElement("th");al.appendChild(ak.firstChild);aj.insertBefore(al,ak);domUtils.remove(ak)}}}var Z;if(ag==0||ag==this.colsNum){for(;af<Y;af++){aa=this.table.rows[af];Z=aa.cells[ag==0?ag:aa.cells.length];ah=this.cloneCell(ai,true);this.setCellContent(ah);ah.setAttribute("vAlign",ah.getAttribute("vAlign"));Z&&ah.setAttribute("width",Z.getAttribute("width"));if(!ag){aa.insertBefore(ah,aa.cells[0])}else{domUtils.insertAfter(aa.cells[aa.cells.length-1],ah)}ad(af,ah,aa)}}else{for(;af<Y;af++){var ab=this.indexTable[af][ag];if(ab.colIndex<ag){ah=this.getCell(ab.rowIndex,ab.cellIndex);ah.colSpan=ab.colSpan+1}else{aa=this.table.rows[af];Z=aa.cells[ab.cellIndex];ah=this.cloneCell(ai,true);this.setCellContent(ah);ah.setAttribute("vAlign",ah.getAttribute("vAlign"));Z&&ah.setAttribute("width",Z.getAttribute("width"));aa.insertBefore(ah,Z)}ad(af,ah,aa)}}this.update();this.updateWidth(ac,ae||{tdPadding:10,tdBorder:1})},updateWidth:function(ab,Z){var ac=this.table,Y=V(ac)-Z.tdPadding*2-Z.tdBorder+ab;if(Y<ac.ownerDocument.body.offsetWidth){ac.setAttribute("width",Y);return}var aa=domUtils.getElementsByTagName(this.table,"td");utils.each(aa,function(ad){ad.setAttribute("width",ab)})},deleteCol:function(ah){var Z=this.indexTable,ad=this.table.rows,ab=this.table.getAttribute("width"),aj=0,Y=this.rowsNum,ai={};for(var ac=0;ac<Y;){var ae=Z[ac],aa=ae[ah],ag=aa.rowIndex+"_"+aa.colIndex;if(ai[ag]){continue}ai[ag]=1;var af=this.getCell(aa.rowIndex,aa.cellIndex);if(!aj){aj=af&&parseInt(af.offsetWidth/af.colSpan,10).toFixed(0)}if(af.colSpan>1){af.colSpan--}else{ad[ac].deleteCell(aa.cellIndex)}ac+=aa.rowSpan||1}this.table.setAttribute("width",ab-aj);this.update()},splitToCells:function(Y){var aa=this,Z=this.splitToRows(Y);utils.each(Z,function(ab){aa.splitToCols(ab)})},splitToRows:function(ag){var Z=this.getCellInfo(ag),ad=Z.rowIndex,af=Z.colIndex,ab=[];ag.rowSpan=1;ab.push(ag);for(var ac=ad,aa=ad+Z.rowSpan;ac<aa;ac++){if(ac==ad){continue}var Y=this.table.rows[ac],ae=Y.insertCell(af-this.getPreviewMergedCellsNum(ac,af));ae.colSpan=Z.colSpan;this.setCellContent(ae);ae.setAttribute("vAlign",ag.getAttribute("vAlign"));ae.setAttribute("align",ag.getAttribute("align"));if(ag.style.cssText){ae.style.cssText=ag.style.cssText}ab.push(ae)}this.update();return ab},getPreviewMergedCellsNum:function(ae,aa){var ad=this.indexTable[ae],Z=0;for(var ab=0;ab<aa;){var ac=ad[ab].colSpan,Y=ad[ab].rowIndex;Z+=(ac-(Y==ae?1:0));ab+=ac}return Z},splitToCols:function(ai){var ab=(ai.offsetWidth/ai.colSpan-22).toFixed(0),aa=this.getCellInfo(ai),af=aa.rowIndex,ah=aa.colIndex,ad=[];ai.colSpan=1;ai.setAttribute("width",ab);ad.push(ai);for(var ac=ah,ae=ah+aa.colSpan;ac<ae;ac++){if(ac==ah){continue}var Z=this.table.rows[af],ag=Z.insertCell(this.indexTable[af][ac].cellIndex+1);ag.rowSpan=aa.rowSpan;this.setCellContent(ag);ag.setAttribute("vAlign",ai.getAttribute("vAlign"));ag.setAttribute("align",ai.getAttribute("align"));ag.setAttribute("width",ab);if(ai.style.cssText){ag.style.cssText=ai.style.cssText}if(ai.tagName=="TH"){var Y=ai.ownerDocument.createElement("th");Y.appendChild(ag.firstChild);Y.setAttribute("vAlign",ai.getAttribute("vAlign"));Y.rowSpan=ag.rowSpan;Z.insertBefore(Y,ag);domUtils.remove(ag)}ad.push(ag)}this.update();return ad},isLastCell:function(Z,ab,Y){ab=ab||this.rowsNum;Y=Y||this.colsNum;var aa=this.getCellInfo(Z);return((aa.rowIndex+aa.rowSpan)==ab)&&((aa.colIndex+aa.colSpan)==Y)},getLastCell:function(Y){Y=Y||this.table.getElementsByTagName("td");var af=this.getCellInfo(Y[0]);var ab=this,aa=Y[0],ad=aa.parentNode,Z=0,ae=0,ac;utils.each(Y,function(ag){if(ag.parentNode==ad){ae+=ag.colSpan||1}Z+=ag.rowSpan*ag.colSpan||1});ac=Z/ae;utils.each(Y,function(ag){if(ab.isLastCell(ag,ac,ae)){aa=ag;return false}});return aa},selectRow:function(ac){var aa=this.indexTable[ac],ab=this.getCell(aa[0].rowIndex,aa[0].cellIndex),Y=this.getCell(aa[this.colsNum-1].rowIndex,aa[this.colsNum-1].cellIndex),Z=this.getCellsRange(ab,Y);this.setSelected(Z)},selectTable:function(){var Z=this.table.getElementsByTagName("td"),Y=this.getCellsRange(Z[0],Z[Z.length-1]);this.setSelected(Y)}};function k(Y){var Z=H(Y).cell||w(Y);return Z?(Z.nodeType?[Z]:Z.selectedTds):[]}function H(aa){var ad=aa.selection.getStart(),Y=ad&&domUtils.findParentByTagName(ad,["td","th"],true),ac=Y&&Y.parentNode,Z=ad&&domUtils.findParentByTagName(ad,"caption",true),ab=Z?Z.parentNode:ac&&ac.parentNode.parentNode;return{cell:Y,tr:ac,table:ab,caption:Z}}function z(Z,Y){var aa=domUtils.findParentByTagName(Y.target||Y.srcElement,["td","th"],true);return aa&&!(Z.fireEvent("excludetable",aa)===true)?aa:null}function B(Y,aa){if(!Y||utils.isString(Y)){return this.table.ownerDocument.createElement(Y||"td")}var Z=domUtils.hasClass(Y,"selectTdClass");Z&&domUtils.removeClasses(Y,"selectTdClass");var ab=Y.cloneNode(true);if(aa){ab.rowSpan=ab.colSpan=1}ab.style.borderLeftStyle="";ab.style.borderTopStyle="";ab.style.borderLeftColor=Y.style.borderRightColor;ab.style.borderLeftWidth=Y.style.borderRightWidth;ab.style.borderTopColor=Y.style.borderBottomColor;ab.style.borderTopWidth=Y.style.borderBottomWidth;Z&&domUtils.addClass(Y,"selectTdClass");return ab}};UE.plugins.selectall=function(){var a=this;a.commands.selectall={execCommand:function(){var e=this,c=e.body,d=e.selection.getRange();d.selectNodeContents(c);if(domUtils.isEmptyBlock(c)){if(browser.opera&&c.firstChild&&c.firstChild.nodeType==1){d.setStartAtFirst(c.firstChild)}d.collapse(true)}d.select(true)},notNeedUndo:1};function b(e,c){var d;while(!domUtils.isBody(e)){d=e;e=e.parentNode;if(d!==e[c]){return false}}return true}a.addListener("keydown",function(f,d){var c=a.selection.getRange();if(!c.collapsed&&!(d.ctrlKey||d.metaKey||d.shiftKey||d.altKey)){var e=c.startContainer;if(domUtils.isFillChar(e)){c.setStartBefore(e)}e=c.endContainer;if(domUtils.isFillChar(e)){c.setEndAfter(e)}c.txtToElmBoundary();if(c.startOffset==0){e=c.startContainer;if(b(e,"firstChild")){e=c.endContainer;if(c.endOffset==c.endContainer.childNodes.length&&b(e,"lastChild")){a.fireEvent("saveScene");a.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>";c.setStart(a.body.firstChild,0).setCursor(false,true);a.fireEvent("saveScene");browser.ie&&a._selectionChange();return}}}}});a.addshortcutkey({selectAll:"ctrl+65"})};UE.plugins.highlightcode=function(){var d=this;if(!/highlightcode/i.test(d.options.toolbars.join(""))){return}d.commands.highlightcode={execCommand:function(h,i,g){var f=this.selection.getRange(),l=domUtils.findParentByTagName(f.startContainer,"table",true),e=domUtils.findParentByTagName(f.endContainer,"table",true);if(l&&e&&l===e&&domUtils.hasClass(l,"syntaxhighlighter")){if(l.nextSibling){f.setStart(l.nextSibling,0)}else{if(l.previousSibling){f.setStartAtLast(l.previousSibling)}else{var k=d.document.createElement("p");domUtils.fillNode(d.document,k);l.parentNode.insertBefore(k,l);f.setStart(k,0)}}f.setCursor(false,true);domUtils.remove(l)}if(i&&g){d.execCommand("inserthtml",'<pre id="highlightcode_id" class="brush: '+g+';toolbar:false;">'+utils.unhtml(i)+"</pre>",true);var j=d.document.getElementById("highlightcode_id");if(j){domUtils.removeAttributes(j,"id");d.window.SyntaxHighlighter.highlight(j)}}},queryCommandState:function(){return a.call(this)}};function a(){try{var g=this.selection.getRange(),i,f;g.adjustmentBoundary();i=domUtils.findParent(g.startContainer,function(e){return e.nodeType==1&&e.tagName=="TABLE"&&domUtils.hasClass(e,"syntaxhighlighter")},true);f=domUtils.findParent(g.endContainer,function(e){return e.nodeType==1&&e.tagName=="TABLE"&&domUtils.hasClass(e,"syntaxhighlighter")},true);return i&&f&&i==f?1:0}catch(h){return 0}}d.notNeedHighlightQuery={help:1,undo:1,redo:1,source:1,print:1,searchreplace:1,fullscreen:1,preview:1,insertparagraph:1,elementpath:1,highlightcode:1};var c=d.queryCommandState;d.queryCommandState=function(e){if(!d.notNeedHighlightQuery[e.toLowerCase()]&&a.call(this)==1){return -1}return c.apply(this,arguments)};d.addListener("beforeselectionchange afterselectionchange",function(e){d.highlight=/^b/.test(e)?d.queryCommandState("highlightcode"):0});d.addListener("ready",function(){if(typeof d.XRegExp=="undefined"){utils.loadFile(d.document,{id:"syntaxhighlighter_js",src:d.options.highlightJsUrl||d.options.UEDITOR_HOME_URL+"third-party/SyntaxHighlighter/shCore.js",tag:"script",type:"text/javascript",defer:"defer"},function(){b.call(d)})}if(!d.document.getElementById("syntaxhighlighter_css")){utils.loadFile(d.document,{id:"syntaxhighlighter_css",tag:"link",rel:"stylesheet",type:"text/css",href:d.options.highlightCssUrl||d.options.UEDITOR_HOME_URL+"third-party/SyntaxHighlighter/shCoreDefault.css"})}});d.addListener("beforegetcontent beforegetscene",function(){utils.each(domUtils.getElementsByTagName(d.body,"table","syntaxhighlighter"),function(f){var h=[],e="";utils.each(f.getElementsByTagName("code"),function(i){if(e!==i.parentNode){e=i.parentNode;h.push(utils.trim(e[browser.ie?"innerText":"textContent"]))}});var g=domUtils.createElement(d.document,"pre",{"class":"brush: "+f.className.replace(/\s+/g," ").split(" ")[1]+";toolbar:false;"});g.appendChild(d.document.createTextNode(h.join("\n")));f.parentNode.replaceChild(g,f)})});d.addListener("aftergetcontent aftersetcontent aftergetscene",b);d.addListener("excludetable excludeNodeinautotype",function(e,f){if(f&&domUtils.findParent(f,function(g){return domUtils.hasClass(g,"syntaxhighlighter")},true)){return true}});function b(){var e=this;if(!e.window||!e.window.SyntaxHighlighter){return}utils.each(domUtils.getElementsByTagName(e.document,"pre"),function(f){if(domUtils.hasClass(f,"brush")){e.window.SyntaxHighlighter.highlight(f)}})}d.addListener("getAllHtml",function(l,h){var e="";for(var g=0,f,k=domUtils.getElementsByTagName(d.document,"table");f=k[g++];){if(domUtils.hasClass(f,"syntaxhighlighter")){e="<script type=\"text/javascript\">window.onload = function(){SyntaxHighlighter.highlight();setTimeout(function(){    var tables = document.getElementsByTagName('table');   for(var t= 0,ti;ti=tables[t++];){       if(/SyntaxHighlighter/i.test(ti.className)){           var tds = ti.getElementsByTagName('td');           for(var i=0,li,ri;li=tds[0].childNodes[i];i++){               ri = tds[1].firstChild.childNodes[i];               if(ri){                  ri.style.height = li.style.height = ri.offsetHeight + 'px';               }           }       }   }},100)}<\/script>";break}}if(!e){var j;if(j=d.document.getElementById("syntaxhighlighter_css")){domUtils.remove(j)}if(j=d.document.getElementById("syntaxhighlighter_js")){domUtils.remove(j)}}e&&h.push(e)})};UE.plugins.autofloat=function(){var r=this,s=r.getLang();r.setOpt({topOffset:0});var m=r.options.autoFloatEnabled!==false,k=r.options.topOffset;if(!m){return}var f=UE.ui.uiUtils,g=browser.ie&&browser.version<=6,l=browser.quirks;function a(t){if(!t.ui){alert(s.autofloatMsg);return 0}return 1}function h(){var t=document.body.style;t.backgroundImage='url("about:blank")';t.backgroundAttachment="fixed"}var i,n=document.createElement("div"),d,c,q,o=true;function j(){var u=domUtils.getXY(d),t=domUtils.getComputedStyle(d,"position"),v=domUtils.getComputedStyle(d,"left");d.style.width=d.offsetWidth+"px";d.style.zIndex=r.options.zIndex*1+1;d.parentNode.insertBefore(n,d);if(g||(l&&browser.ie)){if(d.style.position!="absolute"){d.style.position="absolute"}d.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-c+k+"px"}else{if(browser.ie7Compat&&o){o=false;d.style.left=domUtils.getXY(d).x-document.documentElement.getBoundingClientRect().left+2+"px"}if(d.style.position!="fixed"){d.style.position="fixed";d.style.top=k+"px";((t=="absolute"||t=="relative")&&parseFloat(v))&&(d.style.left=u.x+"px")}}}function e(){o=true;if(n.parentNode){n.parentNode.removeChild(n)}d.style.cssText=i}function b(){var t=q(r.container);if(t.top<0&&t.bottom-d.offsetHeight>0){j()}else{e()}}var p=utils.defer(function(){b()},browser.ie?200:100,true);r.addListener("destroy",function(){domUtils.un(window,["scroll","resize"],b);r.removeListener("keydown",p)});r.addListener("ready",function(){if(a(r)){q=f.getClientRect;d=r.ui.getDom("toolbarbox");c=q(d).top;i=d.style.cssText;n.style.height=d.offsetHeight+"px";if(g){h()}domUtils.on(window,["scroll","resize"],b);r.addListener("keydown",p);r.addListener("beforefullscreenchange",function(v,u){if(u){e()}});r.addListener("fullscreenchanged",function(v,u){if(!u){b()}});r.addListener("sourcemodechanged",function(v,u){setTimeout(function(){b()},0)});r.addListener("clearDoc",function(){setTimeout(function(){b()},0)})}})};UE.plugins.autoheight=function(){var h=this;h.autoHeightEnabled=h.options.autoHeightEnabled!==false;if(!h.autoHeightEnabled){return}var f,i,d,g=0,j=h.options,b,a;function c(){var k=this;clearTimeout(a);if(e){return}a=setTimeout(function(){if(k.queryCommandState&&k.queryCommandState("source")!=1){if(!i){i=k.document.createElement("span");i.style.cssText="display:block;width:0;margin:0;padding:0;border:0;clear:both;";i.innerHTML="."}d=i.cloneNode(true);k.body.appendChild(d);b=Math.max(domUtils.getXY(d).y+d.offsetHeight,Math.max(j.minFrameHeight,j.initialFrameHeight));if(b!=g){k.setHeight(b);g=b}domUtils.remove(d)}},50)}var e;h.addListener("fullscreenchanged",function(l,k){e=k});h.addListener("destroy",function(){h.removeListener("contentchange",c);h.removeListener("afterinserthtml",c);h.removeListener("keyup",c);h.removeListener("mouseup",c)});h.enableAutoHeight=function(){if(!h.autoHeightEnabled){return}var k=h.document;h.autoHeightEnabled=true;f=k.body.style.overflowY;k.body.style.overflowY="hidden";h.addListener("contentchange",c);h.addListener("afterinserthtml",c);h.addListener("keyup",c);h.addListener("mouseup",c);setTimeout(function(){c.call(this)},browser.gecko?100:0);h.fireEvent("autoheightchanged",h.autoHeightEnabled)};h.disableAutoHeight=function(){h.body.style.overflowY=f||"";h.removeListener("contentchange",c);h.removeListener("keyup",c);h.removeListener("mouseup",c);h.autoHeightEnabled=false;h.fireEvent("autoheightchanged",h.autoHeightEnabled)};h.addListener("ready",function(){h.enableAutoHeight();var k;domUtils.on(browser.ie?h.body:h.document,browser.webkit?"dragover":"drop",function(){clearTimeout(k);k=setTimeout(function(){c.call(this)},100)})})};UE.plugins.autolink=function(){var a=0;if(browser.ie){return}var b=this;b.addListener("reset",function(){a=0});b.addListener("keydown",function(j,l){var o=l.keyCode||l.which;if(o==32||o==13){var f=b.selection.getNative(),h=f.getRangeAt(0).cloneRange(),g,n;var d=h.startContainer;while(d.nodeType==1&&h.startOffset>0){d=h.startContainer.childNodes[h.startOffset-1];if(!d){break}h.setStart(d,d.nodeType==1?d.childNodes.length:d.nodeValue.length);h.collapse(true);d=h.startContainer}do{if(h.startOffset==0){d=h.startContainer.previousSibling;while(d&&d.nodeType==1){d=d.lastChild}if(!d||domUtils.isFillChar(d)){break}g=d.nodeValue.length}else{d=h.startContainer;g=h.startOffset}h.setStart(d,g-1);n=h.toString().charCodeAt(0)}while(n!=160&&n!=32);if(h.toString().replace(new RegExp(domUtils.fillChar,"g"),"").match(/(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i)){while(h.toString().length){if(/^(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i.test(h.toString())){break}try{h.setStart(h.startContainer,h.startOffset+1)}catch(i){var d=h.startContainer;while(!(next=d.nextSibling)){if(domUtils.isBody(d)){return}d=d.parentNode}h.setStart(next,0)}}if(domUtils.findParentByTagName(h.startContainer,"a",true)){return}var k=b.document.createElement("a"),m=b.document.createTextNode(" "),c;b.undoManger&&b.undoManger.save();k.appendChild(h.extractContents());k.href=k.innerHTML=k.innerHTML.replace(/<[^>]+>/g,"");c=k.getAttribute("href").replace(new RegExp(domUtils.fillChar,"g"),"");c=/^(?:https?:\/\/)/ig.test(c)?c:"http://"+c;k.setAttribute("data_ue_src",utils.html(c));k.href=utils.html(c);h.insertNode(k);k.parentNode.insertBefore(m,k.nextSibling);h.setStart(m,0);h.collapse(true);f.removeAllRanges();f.addRange(h);b.undoManger&&b.undoManger.save()}}})};UE.plugins.autosubmit=function(){var a=this;a.commands.autosubmit={execCommand:function(){var c=this,b=domUtils.findParentByTagName(c.iframe,"form",false);if(b){if(c.fireEvent("beforesubmit")===false){return}c.sync();b.submit()}}};a.addshortcutkey({autosubmit:"ctrl+13"})};UE.plugins.wordcount=function(){var a=this;a.addListener("contentchange",function(){a.fireEvent("wordcount")});var b;a.addListener("keyup",function(){clearTimeout(b);var c=this;b=setTimeout(function(){c.fireEvent("wordcount")},200)})};UE.plugins.elementpath=function(){var c,a,b=this;b.setOpt("elementPathEnabled",true);if(!b.options.elementPathEnabled){return}b.commands.elementpath={execCommand:function(e,g){var f=a[g],d=b.selection.getRange();c=g*1;d.selectNode(f).select()},queryCommandValue:function(){var e=[].concat(this.selection.getStartElementPath()).reverse(),h=[];a=e;for(var g=0,f;f=e[g];g++){if(f.nodeType==3){continue}var d=f.tagName.toLowerCase();if(d=="img"&&f.getAttribute("anchorname")){d="anchor"}h[g]=d;if(c==g){c=-1;break}}return h}}};UE.commands.insertparagraph={execCommand:function(b,e){var d=this,a=d.selection.getRange(),g=a.startContainer,c;while(g){if(domUtils.isBody(g)){break}c=g;g=g.parentNode}if(c){var f=d.document.createElement("p");if(e){c.parentNode.insertBefore(f,c)}else{c.parentNode.insertBefore(f,c.nextSibling)}domUtils.fillNode(d.document,f);a.setStart(f,0).setCursor(false,true)}}};